<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>zabbixç¬”è®° | å£¹æ‹¾é™†</title><meta name="keywords" content="Linux"><meta name="author" content="å£¹æ‹¾é™†"><meta name="copyright" content="å£¹æ‹¾é™†"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="Zabbixä¸€ã€Linuxçš„é‚£äº›ç‹¬å­¤ä¹å‰‘çº§åˆ«çš„å‘½ä»¤   é¡¹ç›® å¯¹åº”æ£€æŸ¥å‘½ä»¤    ç½‘ç«™&#x2F;ä¸šåŠ¡&#x2F;api curl&#x2F;wget   æœåŠ¡ systemctl&#x2F;service&#x2F;chkconfig(c6)   è¿›ç¨‹ ps&#x2F;pstree&#x2F;pgrep&#x2F;pidstat&#x2F;top&#x2F;htop   CPU top&amp;#x2F">
<meta property="og:type" content="article">
<meta property="og:title" content="zabbixç¬”è®°">
<meta property="og:url" content="https://mo-li001.github.io/posts/43f6321c.html">
<meta property="og:site_name" content="å£¹æ‹¾é™†">
<meta property="og:description" content="Zabbixä¸€ã€Linuxçš„é‚£äº›ç‹¬å­¤ä¹å‰‘çº§åˆ«çš„å‘½ä»¤   é¡¹ç›® å¯¹åº”æ£€æŸ¥å‘½ä»¤    ç½‘ç«™&#x2F;ä¸šåŠ¡&#x2F;api curl&#x2F;wget   æœåŠ¡ systemctl&#x2F;service&#x2F;chkconfig(c6)   è¿›ç¨‹ ps&#x2F;pstree&#x2F;pgrep&#x2F;pidstat&#x2F;top&#x2F;htop   CPU top&amp;#x2F">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2022-10-23T11:48:44.000Z">
<meta property="article:modified_time" content="2022-10-28T02:58:38.000Z">
<meta property="article:author" content="å£¹æ‹¾é™†">
<meta property="article:tag" content="Linux">
<meta name="twitter:card" content="summary"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://mo-li001.github.io/posts/43f6321c"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"languages":{"hits_empty":"æ‰¾ä¸åˆ°æ‚¨æŸ¥è¯¢çš„å†…å®¹ï¼š${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: 'å¤åˆ¶æˆåŠŸ',
    error: 'å¤åˆ¶é”™è¯¯',
    noSupport: 'æµè§ˆå™¨ä¸æ”¯æŒ'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: 'åˆšåˆš',
    min: 'åˆ†é’Ÿå‰',
    hour: 'å°æ—¶å‰',
    day: 'å¤©å‰',
    month: 'ä¸ªæœˆå‰'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'zabbixç¬”è®°',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2022-10-28 10:58:38'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="/css/custom.css" media="defer" onload="this.media='all'"><meta name="generator" content="Hexo 6.3.0"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://images-1258700836.cos.ap-guangzhou.myqcloud.com/images/202209182232723.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">69</div></a><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">4</div></a><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">5</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> ä¸»é¡µ</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> æ ‡ç­¾</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> åˆ†ç±»</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> å½’æ¡£</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">å£¹æ‹¾é™†</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> æœç´¢</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> ä¸»é¡µ</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> æ ‡ç­¾</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> åˆ†ç±»</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> å½’æ¡£</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">zabbixç¬”è®°</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">å‘è¡¨äº</span><time class="post-meta-date-created" datetime="2022-10-23T11:48:44.000Z" title="å‘è¡¨äº 2022-10-23 19:48:44">2022-10-23</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">æ›´æ–°äº</span><time class="post-meta-date-updated" datetime="2022-10-28T02:58:38.000Z" title="æ›´æ–°äº 2022-10-28 10:58:38">2022-10-28</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E7%AC%94%E8%AE%B0/">ç¬”è®°</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="zabbixç¬”è®°"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">é˜…è¯»é‡:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="Zabbix"><a href="#Zabbix" class="headerlink" title="Zabbix"></a><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1R24y1o7Nv/?p=8&spm_id_from=pageDriver&vd_source=629395ac7befa1625191c3f496068941">Zabbix</a></h1><h1 id="ä¸€ã€Linuxçš„é‚£äº›ç‹¬å­¤ä¹å‰‘çº§åˆ«çš„å‘½ä»¤"><a href="#ä¸€ã€Linuxçš„é‚£äº›ç‹¬å­¤ä¹å‰‘çº§åˆ«çš„å‘½ä»¤" class="headerlink" title="ä¸€ã€Linuxçš„é‚£äº›ç‹¬å­¤ä¹å‰‘çº§åˆ«çš„å‘½ä»¤"></a>ä¸€ã€Linuxçš„é‚£äº›ç‹¬å­¤ä¹å‰‘çº§åˆ«çš„å‘½ä»¤</h1><table>
<thead>
<tr>
<th>é¡¹ç›®</th>
<th>å¯¹åº”æ£€æŸ¥å‘½ä»¤</th>
</tr>
</thead>
<tbody><tr>
<td>ç½‘ç«™&#x2F;ä¸šåŠ¡&#x2F;api</td>
<td><strong>curl&#x2F;wget</strong></td>
</tr>
<tr>
<td>æœåŠ¡</td>
<td><strong>systemctl</strong>&#x2F;service&#x2F;chkconfig(c6)</td>
</tr>
<tr>
<td>è¿›ç¨‹</td>
<td><strong>ps&#x2F;pstree</strong>&#x2F;pgrep&#x2F;pidstat&#x2F;top&#x2F;htop</td>
</tr>
<tr>
<td>CPU</td>
<td><strong>top&#x2F;htop</strong>&#x2F;vmstat&#x2F;mpstat&#x2F;lscpu&#x2F;cpuinfo&#x2F;w&#x2F;uptime&#x2F;sar</td>
</tr>
<tr>
<td>å†…å­˜</td>
<td><strong>top&#x2F;free&#x2F;ps&#x2F;iotop(swap)</strong>&#x2F;vmstat&#x2F;mpstat&#x2F;sar&#x2F;hcache(buffer+cache)</td>
</tr>
<tr>
<td>ç£ç›˜</td>
<td><strong>iotop</strong>&#x2F;iostat&#x2F;sar  #ç£ç›˜æµ‹è¯•å‘½ä»¤ <strong>dd,fio</strong></td>
</tr>
<tr>
<td>ç½‘ç»œ</td>
<td><strong>iftop(æ•´ä½“å¸¦å®½ä½¿ç”¨æƒ…å†µ)&#x2F;nethogs(ç²¾ç¡®åˆ°è¿›ç¨‹)</strong>&#x2F;nstat&#x2F;ifstat&#x2F;mtr&#x2F;sar</td>
</tr>
<tr>
<td>ç¡¬ä»¶</td>
<td>Megacli(ç›‘æ§raid)&#x2F;ipmitool(æ¸©åº¦,cpué£æ‰‡è½¬é€Ÿ)&#x2F;lm_sensors(æ¸©åº¦)</td>
</tr>
</tbody></table>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è¿›ç¨‹</span></span><br><span class="line">pgrep  è¿‡æ»¤å‡ºæŒ‡å®šæœåŠ¡çš„è¿›ç¨‹pid    <span class="comment"># ps -ef |grep</span></span><br><span class="line"></span><br><span class="line"><span class="comment">###pidstat</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#CPU</span></span><br><span class="line"></span><br><span class="line"><span class="comment">##vmstat</span></span><br><span class="line">[root@VM-20-4-centos ~]<span class="comment"># vmstat</span></span><br><span class="line">procs -----------memory---------- ---swap-- -----io---- -system-- ------cpu-----</span><br><span class="line"> r  b   swpd   free   buff  cache   si   so    bi    bo   <span class="keyword">in</span>   cs us sy <span class="built_in">id</span> wa st</span><br><span class="line"> 2  0      0 227824 191572 2893468    0    0    25    14    1    1  4  6 90  0  0</span><br><span class="line"></span><br><span class="line">Procs</span><br><span class="line">    r: The number of runnable processes (running or waiting <span class="keyword">for</span> run time).  <span class="comment">#cpu æ­£åœ¨è¿è¡Œæˆ–ç­‰å¾…è¿è¡Œçš„è¿›ç¨‹æ•°</span></span><br><span class="line">    b: The number of processes blocked waiting <span class="keyword">for</span> I/O to complete.  <span class="comment">#å¤„äºioçŠ¶æ€è¿›ç¨‹æ•°é‡</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#è‡ªè¡Œå›é¡¾ï¼šps,top  è¯¦ç»†ä¿¡æ¯  è¿›ç¨‹çŠ¶æ€</span></span><br><span class="line"></span><br><span class="line"><span class="comment">##mpstat</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#å†…å­˜</span></span><br><span class="line">https://github.com/silenceshell/hcache</span><br><span class="line"></span><br><span class="line"><span class="comment">#ç½‘ç»œ</span></span><br><span class="line">nstat/ifstat/mtr/sar</span><br><span class="line"></span><br><span class="line"><span class="comment">##ifstat</span></span><br><span class="line">[root@VM-20-4-centos ~]<span class="comment"># ifstat</span></span><br><span class="line"><span class="comment">#kernel</span></span><br><span class="line">Interface        RX Pkts/Rate    TX Pkts/Rate    RX Data/Rate    TX Data/Rate  </span><br><span class="line">                 RX Errs/Drop    TX Errs/Drop    RX Over/Rate    TX Coll/Rate  </span><br><span class="line">lo                86528K 0        86528K 0         1651M 0         1651M 0      </span><br><span class="line">                       0 0             0 0             0 0             0 0      </span><br><span class="line">eth0              99204K 0        94462K 0         4035M 0         1693M 0      </span><br><span class="line">                       0 0             0 0             0 0             0 0      </span><br><span class="line">docker0            2579K 0         2495K 0         2297M 0         3886M 0      </span><br><span class="line">                       0 0             0 0             0 0             0 0      </span><br><span class="line">veth406d24a        1732K 0         1597K 0         2189M 0         2169M 0      </span><br><span class="line">                       0 0             0 0             0 0             0 0      </span><br><span class="line">veth1ba4e8f         2224 0          2855 0        300315 0        583370 0      </span><br><span class="line">                       0 0             0 0             0 0             0 0      </span><br><span class="line">veth334f09c        72199 0         74256 0        76233K 0        31214K 0      </span><br><span class="line">                       0 0             0 0             0 0             0 0      </span><br><span class="line">[root@VM-20-4-centos ~]<span class="comment"># </span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">##mtr</span></span><br><span class="line">[root@aliyun-ansible ~]<span class="comment"># #åŠ¨æ€ tracert æˆ–traceroute è·¯ç”±è¿½è¸ª</span></span><br><span class="line">[root@aliyun-ansible ~]<span class="comment"># mtr WWw.baidu.com</span></span><br></pre></td></tr></table></figure>



<h1 id="äºŒã€å…¬å¸ç›‘æ§å¦‚ä½•åšçš„"><a href="#äºŒã€å…¬å¸ç›‘æ§å¦‚ä½•åšçš„" class="headerlink" title="äºŒã€å…¬å¸ç›‘æ§å¦‚ä½•åšçš„"></a>äºŒã€å…¬å¸ç›‘æ§å¦‚ä½•åšçš„</h1><ul>
<li><p>è§’åº¦01ï¼š<strong>å•å°æœºå™¨</strong></p>
<ul>
<li>ä¸šåŠ¡(åº”ç”¨&#x2F;api)ä¿¡æ¯ï¼šåº”ç”¨ï¼Œç¨‹åºä»£ç æ˜¯å¦æœ‰é—®é¢˜ï¼Œï¼ˆéœ€è¦æˆ‘ä»¬ä¸å¼€å‘æ²Ÿé€šï¼Œä¹¦å†™ä¸€ä¸ªé¡µé¢ï¼‰ egï¼šlnmpçš„æ—¶å€™çš„phpä¸mysqlæµ‹è¯•é¡µé¢.</li>
<li>æœåŠ¡ä¿¡æ¯ï¼šå„ç§æœåŠ¡çŠ¶æ€ï¼Œè¿›ç¨‹ï¼Œç«¯å£ï¼ŒçŠ¶æ€ï¼Œç‰¹å®šçš„ä¿¡æ¯ï¼ˆä¸åŒæœåŠ¡ï¼‰</li>
<li>ç³»ç»Ÿä¿¡æ¯ï¼šcpu,å†…å­˜(å†…å­˜,swap,buffer&#x2F;cache),ç£ç›˜(io,ä½¿ç”¨ç‡,inode),è´Ÿè½½,ç½‘ç»œ(in&#x2F;out)â€¦â€¦</li>
<li>ç¡¬ä»¶ä¿¡æ¯ï¼šç£ç›˜ï¼ŒraidçŠ¶æ€ï¼Œæ¸©åº¦ï¼Œé£æ‰‡è½¬é€Ÿï¼Œæœºæˆ¿æ¸©åº¦ï¼Œæ¹¿åº¦</li>
</ul>
</li>
<li><p>è§’åº¦02ï¼š<strong>ç½‘ç«™é›†ç¾¤ç›‘æ§ï¼ˆç”¨æˆ·è®¿é—®æµç¨‹ï¼‰</strong></p>
<ul>
<li>DNSè§£æï¼š<strong>ping&#x2F;dig</strong>&#x2F;nslookup&#x2F;host</li>
<li>DNSè§£æåŸŸCDNæ˜¯å¦ok  æœ¬è´¨ï¼š<strong>é€šè¿‡å…¨å±€è®¿é—®æµ‹è¯•å·¥å…·ï¼ˆæ¨¡ä»¿ç”¨æˆ·åœ¨å…¨å›½ï¼ˆå…¨çƒï¼‰å„åœ°è®¿é—®æˆ‘ä»¬çš„ç½‘ç«™ï¼‰</strong><ul>
<li>ä»»æ€§ä¸å·®é’±ï¼šå…¨å›½å„åœ°ï¼ˆæ ¸å¿ƒåŸå¸‚ï¼‰ï¼Œ1å°æœåŠ¡å™¨ï¼Œåœ¨æœåŠ¡å™¨è®¿é—®ä½ ä»¬çš„æºç«™&#x2F;cdn&#x2F;dns,ï¼ˆå¯¹åº”çš„æœåŠ¡ï¼šsmokeping)</li>
<li>å…è´¹:<a target="_blank" rel="noopener" href="http://17ce.com/">http://17ce.com</a> <a target="_blank" rel="noopener" href="http://ping.chinaz.com/">http://ping.chinaz.com/</a>        è°ƒè¯•å·¥å…·ï¼š<a target="_blank" rel="noopener" href="http://cesule.tingyun.com/cesule/home">http://cesule.tingyun.com/cesule/home</a></li>
<li>å•†ä¸šç‰ˆï¼š<a target="_blank" rel="noopener" href="https://www.tingyun.com/">å¬äº‘</a>ï¼Œ<a target="_blank" rel="noopener" href="https://www.jiankongbao.com/">ç›‘æ§å®</a>ï¼ˆå‘Šè­¦ï¼‰</li>
</ul>
</li>
<li>TCPä¸‰æ¬¡æ¡æ‰‹-ç½‘ç«™è´Ÿè½½å‡è¡¡ç›‘æ§ ss-ant</li>
<li>HITPè¯·æ±‚è±¹çº¹-ç›‘æ§webæ—¥å¿—æŸ¥çœ‹ï¼ˆçŠ¶æ€ç ï¼‰è¡¥å……ï¼šåŠ ä¸ŠHTTPSç›‘æ§è¿‡æœŸ</li>
<li>è¯·æ±‚ç»è¿‡ç½‘ç«™æ¶æ„<ul>
<li>è´Ÿè½½å‡è¡¡ï¼ˆNginxï¼‰</li>
<li>webæœåŠ¡å™¨(php,tomcat)</li>
<li>ç¼“å­˜</li>
<li>æ•°æ®åº“</li>
<li>å­˜å‚¨</li>
</ul>
</li>
<li>HTTPå“åº”è±¹çº¹-ç›‘æ§webæ—¥å¿—æŸ¥çœ‹ï¼ˆçŠ¶æ€ç ï¼‰</li>
<li>TCPå››æ¬¡æŒ¥æ‰‹-ç½‘ç«™è´Ÿè½½å‡è¡¡ç›‘æ§ ss-ant</li>
<li>æ–­å¼€è¿æ¥</li>
</ul>
</li>
<li><p>è§’åº¦03ï¼šå…¶ä»–</p>
<ul>
<li><strong>é”™è¯¯æ—¥å¿—ç›‘æ§ï¼Œerror.logï¼Œcatalina.out</strong></li>
<li>ç½‘ç«™æ€§èƒ½ç›‘æ§ï¼šapmç›‘æ§ï¼Œskywalkingâ€¦</li>
<li>èˆ†æƒ…ç›‘æ§</li>
</ul>
</li>
<li><p>smokeping demon</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://oss.oetiker.ch/smokeping-demo/</span><br></pre></td></tr></table></figure></li>
</ul>
<h1 id="ä¸‰ã€ç›‘æ§çš„è„šæœ¬æ—¶ä»£-è¿‡å»æ—¶"><a href="#ä¸‰ã€ç›‘æ§çš„è„šæœ¬æ—¶ä»£-è¿‡å»æ—¶" class="headerlink" title="ä¸‰ã€ç›‘æ§çš„è„šæœ¬æ—¶ä»£-è¿‡å»æ—¶"></a>ä¸‰ã€ç›‘æ§çš„è„šæœ¬æ—¶ä»£-è¿‡å»æ—¶</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">è„šæœ¬å–å‡ºå†…å­˜ä½¿ç”¨ç‡</span></span><br><span class="line">cat /server/scripts/check_mem.sh</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/bash</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">author: lidao996</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">desc:  check system memory us age</span></span><br><span class="line"></span><br><span class="line">MEM=`free -m|awk &#x27;NR==2&#123;print $NF&#125;&#x27;`</span><br><span class="line">if [ $MEM -le 100 ];then</span><br><span class="line">    echo &quot;å½“å‰çš„å†…å­˜è¿˜å‰©ä½™ $MEM&quot;|mail -s &#x27;å†…å­˜ä¸è¶³äº†ï¼oom&#x27; youjiu_linux@qq.com</span><br><span class="line">fi</span><br></pre></td></tr></table></figure>



<h1 id="å››ã€ç›‘æ§çš„ç°ä»£æ—¶"><a href="#å››ã€ç›‘æ§çš„ç°ä»£æ—¶" class="headerlink" title="å››ã€ç›‘æ§çš„ç°ä»£æ—¶"></a>å››ã€ç›‘æ§çš„ç°ä»£æ—¶</h1><table>
<thead>
<tr>
<th>é˜¶æ®µ</th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td>è¿‡å»</td>
<td>Nagios(éš¾å¤Ÿæ­»)+Cacti</td>
</tr>
<tr>
<td>ç›®å‰</td>
<td>Zabbix+Grafana,OpenFalcon,Prometheus(æ™®ç½—ç±³ä¿®æ–¯)</td>
</tr>
<tr>
<td>æœªæ¥</td>
<td>Zabbix 6.0&#x2F;7.0 Its ? , something new ??</td>
</tr>
</tbody></table>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">é˜¶æ®µ</span><br><span class="line">è¿‡å»</span><br><span class="line">Nagios(éš¾å¤Ÿæ­»)+Cacti</span><br><span class="line">Zabbix+Grafana,OpenFalcon,Prometheus(æ™®ç½—ç±³ä¿®æ–¯)</span><br><span class="line">ç›®å‰</span><br><span class="line">æœªæ¥</span><br><span class="line">Zabbix 6.0/7.0 Its ? , something new ??</span><br></pre></td></tr></table></figure>



<h1 id="äº”ã€Zabbixç›‘æ§æ¶æ„"><a href="#äº”ã€Zabbixç›‘æ§æ¶æ„" class="headerlink" title="äº”ã€Zabbixç›‘æ§æ¶æ„"></a>äº”ã€Zabbixç›‘æ§æ¶æ„</h1><h2 id="5-1-ç”Ÿå‘½å‘¨æœŸ"><a href="#5-1-ç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="5.1 ç”Ÿå‘½å‘¨æœŸ"></a>5.1 ç”Ÿå‘½å‘¨æœŸ</h2><ul>
<li>LTS  Long Time Support  é•¿æœŸç»´æŠ¤ç‰ˆæœ¬</li>
<li>zabbixç”Ÿå‘½å‘¨æœŸåŠç‰ˆæœ¬é€‰æ‹©</li>
<li>zabbix-in-the-furture</li>
</ul>
<h2 id="5-2-Zabbixç›‘æ§æ¶æ„"><a href="#5-2-Zabbixç›‘æ§æ¶æ„" class="headerlink" title="5.2 Zabbixç›‘æ§æ¶æ„"></a>5.2 Zabbixç›‘æ§æ¶æ„</h2><ul>
<li>Zabbixæ˜¯ä¸€ä¸ªCSï¼ˆæœåŠ¡ç«¯&#x2F;å®¢æˆ·ç«¯ï¼‰æ¶æ„çš„æœåŠ¡</li>
<li>zabbixç›‘æ§æ¶æ„</li>
<li>Zabbix-Agentè·å–æ•°æ®â€“å‘é€ç»™â€“&gt;Zabbix-ServeræœåŠ¡ç«¯â€”æ•°æ®ä¼šè¢«å­˜æ”¾-&gt;æ•°æ®åº“&lt;â€”Zabbix Webé¡µé¢å±•ç¤ºæ•°æ®</li>
<li>é‡‡é›†æ•°æ®â€”-&gt;æ•°æ®æ”¶é›†ï¼Œæ•°æ®åˆ†æï¼ŒæŠ¥è­¦â€”&gt;å­˜å‚¨â€”&gt;å‹å¥½çš„å±•ç¤º</li>
</ul>
<h1 id="å…­ã€Zabbixç”Ÿäº§å¿«é€Ÿå®è·µæŒ‡å—"><a href="#å…­ã€Zabbixç”Ÿäº§å¿«é€Ÿå®è·µæŒ‡å—" class="headerlink" title="å…­ã€Zabbixç”Ÿäº§å¿«é€Ÿå®è·µæŒ‡å—"></a>å…­ã€Zabbixç”Ÿäº§å¿«é€Ÿå®è·µæŒ‡å—</h1><h2 id="6-1-ä¸»æœºè§„åˆ’"><a href="#6-1-ä¸»æœºè§„åˆ’" class="headerlink" title="6.1 ä¸»æœºè§„åˆ’"></a>6.1 ä¸»æœºè§„åˆ’</h2><ul>
<li>é…ç½®è¦æ±‚</li>
</ul>
<table>
<thead>
<tr>
<th>è§„æ¨¡</th>
<th>å¹³å°</th>
<th>CPU&#x2F;å†…å­˜</th>
<th>æ•°æ®åº“</th>
<th>å—ç›‘æ§çš„ä¸»æœºæ•°é‡</th>
</tr>
</thead>
<tbody><tr>
<td>å°å‹</td>
<td>CentOS</td>
<td>Virtual Appliance</td>
<td>MySQL InnoDB</td>
<td>100</td>
</tr>
<tr>
<td>ä¸­å‹</td>
<td>CentOS</td>
<td>2 CPU cores&#x2F;2GB</td>
<td>MySQL InnoDB</td>
<td>500</td>
</tr>
<tr>
<td>å¤§å‹</td>
<td>RedHat Enterprise Linux</td>
<td>4 CPU cores&#x2F;8GB</td>
<td>RAID10 MySQL InnoDB æˆ– PostgreSQL</td>
<td>&gt;1000</td>
</tr>
<tr>
<td>æå¤§å‹</td>
<td>RedHat Enterprise Linux</td>
<td>8 CPU cores&#x2F;16GB</td>
<td>Fast RAID10 MySQL InnoDB æˆ– PostgreSQL</td>
<td>&gt;10000</td>
</tr>
</tbody></table>
<table>
<thead>
<tr>
<th>è§’è‰²</th>
<th>ä¸»æœºå</th>
<th>eth0&#x2F;eth1</th>
<th>é…ç½®</th>
</tr>
</thead>
<tbody><tr>
<td>ZabbixæœåŠ¡ç«¯</td>
<td>m03-zabbix-server</td>
<td>10.0.0.71&#x2F;172.16.1.71</td>
<td>1C1G(å®é™…æ¨è1C2G)</td>
</tr>
<tr>
<td>ZabbixæœåŠ¡ç«¯</td>
<td>web01</td>
<td>10.0.0.7&#x2F;172.16.1.7</td>
<td>1C1G</td>
</tr>
<tr>
<td>ZabbixæœåŠ¡ç«¯</td>
<td>db01</td>
<td>10.0.0.51&#x2F;172.16.1.51</td>
<td>1C1G</td>
</tr>
</tbody></table>
<table>
<thead>
<tr>
<th>å‚æ•°</th>
<th>æ‰€éœ€ç£ç›˜ç©ºé—´çš„è®¡ç®—å…¬å¼ï¼ˆå•ä½ï¼šå­—èŠ‚ï¼‰</th>
</tr>
</thead>
<tbody><tr>
<td>Zabbix é…ç½®æ–‡ä»¶</td>
<td>å›ºå®šå¤§å°ã€‚é€šå¸¸ä¸º10MBæˆ–æ›´å°‘ã€‚</td>
</tr>
<tr>
<td>History(å†å²æ•°æ®)</td>
<td>days(items&#x2F;refresh rate)243600bytes itemsï¼šç›‘æ§é¡¹æ•°é‡ã€‚daysï¼šä¿ç•™å†å²æ•°æ®çš„å¤©æ•°ã€‚refresh rateï¼šç›‘æ§é¡¹çš„æ›´æ–°é—´éš”ã€‚bytesï¼šä¿ç•™å•ä¸ªå€¼æ‰€éœ€è¦å ç”¨çš„å­—èŠ‚æ•°ï¼Œä¾èµ–äºæ•°æ®åº“å¼•æ“ï¼Œé€šå¸¸ä¸º~90å­—èŠ‚ã€‚</td>
</tr>
<tr>
<td>Trends(è¶‹åŠ¿æ•°æ®)</td>
<td>days(items&#x2F;3600)243600bytes itemsï¼šç›‘æ§é¡¹æ•°é‡ã€‚days:ä¿ç•™å†å²æ•°æ®çš„å¤©æ•°ã€‚bytes:ä¿ç•™å•ä¸ªè¶‹åŠ¿æ•°æ®æ‰€éœ€è¦å ç”¨çš„å­—èŠ‚æ•°ï¼Œä¾èµ–äºæ•°æ®åº“å¼•æ“ï¼Œé€šå¸¸ä¸º~90å­—èŠ‚ã€‚</td>
</tr>
<tr>
<td>Events(äº‹ä»¶æ•°æ®)</td>
<td>daysevents243600bytes eventsï¼šæ¯ç§’äº§ç”Ÿçš„äº‹ä»¶æ•°é‡ã€‚å‡è®¾æœ€ç³Ÿç³•çš„æƒ…å†µä¸‹ï¼Œæ¯ç§’äº§ç”Ÿ1ä¸ªäº‹ä»¶ã€‚daysï¼šä¿ç•™å†å²æ•°æ®çš„å¤©æ•°ã€‚bytes:ä¿ç•™å•ä¸ªè¶‹åŠ¿æ•°æ®æ‰€éœ€çš„å­—èŠ‚æ•°ï¼Œå–å†³äºæ•°æ®åº“å¼• é€šå¸¸ä¸º~170å­—èŠ‚ã€‚</td>
</tr>
</tbody></table>
<table>
<thead>
<tr>
<th>è§’è‰²</th>
<th>ä¸»æœºå</th>
<th>eth0&#x2F;eth1</th>
<th>é…ç½®</th>
</tr>
</thead>
<tbody><tr>
<td>ZabbixæœåŠ¡ç«¯</td>
<td>m03-zabbix-server</td>
<td>10.0.0.72&#x2F;172.16.1.72</td>
<td>1C1G(å®é™…æ¨è1C2G)</td>
</tr>
<tr>
<td>ZabbixæœåŠ¡ç«¯</td>
<td>web01</td>
<td>10.0.0.7&#x2F;172.16.1.7</td>
<td>1C1G</td>
</tr>
<tr>
<td>ZabbixæœåŠ¡ç«¯</td>
<td>db01</td>
<td>10.0.0.51&#x2F;172.16.1.51</td>
<td>1C1G</td>
</tr>
</tbody></table>
<h2 id="6-2-ä¼ä¸šZabbixå®‰è£…æœ€ä½³å®æˆ˜-CentOS7"><a href="#6-2-ä¼ä¸šZabbixå®‰è£…æœ€ä½³å®æˆ˜-CentOS7" class="headerlink" title="6.2 ä¼ä¸šZabbixå®‰è£…æœ€ä½³å®æˆ˜-CentOS7"></a>6.2 ä¼ä¸šZabbixå®‰è£…æœ€ä½³å®æˆ˜-CentOS7</h2><table>
<thead>
<tr>
<th>å®‰è£…æ–¹å¼</th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td>æé€Ÿå…¨è‡ªåŠ¨å®‰è£…yum</td>
<td></td>
</tr>
<tr>
<td>æ··åˆå®‰è£…yum+è‡ªå®šä¹‰é…ç½®<strong>ï¼ˆæœ€ä½³å®è·µï¼‰</strong></td>
<td>lnmp(yum)  zabbix-server(yum)  zabbix-webç¯å¢ƒ(æºç åŒ…)</td>
</tr>
<tr>
<td>docker</td>
<td></td>
</tr>
<tr>
<td>æºç ç¼–è¯‘å®‰è£…</td>
<td></td>
</tr>
</tbody></table>
<p>zabbix-server+é¡µé¢ï¼ˆå‰ç«¯ï¼‰</p>
<p>:one:nginx</p>
<p>:two:php</p>
<p>:three:æ•°æ®åº“</p>
<p>:four:zabbix-server</p>
<p>:five:webéƒ¨ç½²</p>
<p>:one:nginxç¯å¢ƒ</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#m03  zabbix-server  10.0.0.72/172.16.1.72</span></span><br><span class="line"><span class="comment">###é…ç½®nginxæº</span></span><br><span class="line"></span><br><span class="line">[root@m03 ~]<span class="comment"># cat /etc/yum.repos.d/nginx.repo</span></span><br><span class="line">[nginx-stable]</span><br><span class="line">name=nginx stable repo</span><br><span class="line">baseurl=http://nginx.org/packages/centos/<span class="variable">$releasever</span>/<span class="variable">$basearch</span>/</span><br><span class="line">gpgcheck=1</span><br><span class="line">enabled=0</span><br><span class="line">gpgkey=https://nginx.org/keys/nginx_signing.key</span><br><span class="line">module_hotfixes=<span class="literal">true</span></span><br><span class="line">[root@m03 ~]<span class="comment"># yum install nginx --enablerepo=nginx-stable</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>:two:php</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#nginx  1.20.1  php7.2</span></span><br><span class="line">curl -o /etc/yum.repos.d/CentOS-Base.repo http://mirrors.aliyun.com/repo/Centos-7.repo</span><br><span class="line">yum install epel-release.noarch -y  <span class="comment">#webtaticè¦æ±‚</span></span><br><span class="line">curl -o /etc/yum.repos.d/epel.repo http://mirrors.aliyun.com/repo/epel-7.repo</span><br><span class="line">rpm -Uvh https://mirror.webtatic.com/yum/el7/webtatic-release.rpm  <span class="comment">#webtaticæº</span></span><br><span class="line">yum install php72w-cli php72w-fpm php72w-gd php72w-mbstring php72w-bcmath php72w-xml php72w-ldap php72w-mysqlnd -y</span><br><span class="line"></span><br><span class="line">[root@m03 ~]<span class="comment"># rpm -qa |egrep &#x27;nginx|php72w&#x27;</span></span><br></pre></td></tr></table></figure>



<p>:three:nginx+php</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">01</span></span><br><span class="line">[root@m03 ~]# systemctl enable nginx php-fpm.service</span><br><span class="line">[root@m03 ~]# systemctl start nginx php-fpm.service</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">02 nginxé…ç½®</span></span><br><span class="line">[root@m03 ~]# cat /etc/nginx/conf.d/zabbix.conf</span><br><span class="line">    server &#123;</span><br><span class="line">        listen       80;</span><br><span class="line">        server_name  zbx.oldboylinux.cn;</span><br><span class="line">        root         /code/zabbix;</span><br><span class="line">        location / &#123;</span><br><span class="line">            index index.php;</span><br><span class="line">        &#125;</span><br><span class="line">        location ~ \.php$ &#123;</span><br><span class="line">            fastcgi_pass  127.0.0.1:9000;</span><br><span class="line">            fastcgi_index  index.php;</span><br><span class="line">            fastcgi_param  SCRIPT_FILENAME  $document_root$fastcgi_script_name;</span><br><span class="line">            include    fastcgi_params;</span><br><span class="line">        &#125;        </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[root@m03 ~]# nginx -t</span><br><span class="line">[root@m03 ~]# systemctl reload nginx</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">03 php é…ç½®</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">ä¿®æ”¹phpç”¨æˆ·</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">å‡†å¤‡ phpä¼šè¯ä¿æŒç›®å½•</span></span><br><span class="line"></span><br><span class="line">[root@m03 ~]# sed -ri &#x27;/^(user|group)/s#apache#nginx#g&#x27; /etc/php-fpm.d/www.conf</span><br><span class="line">[root@m03 ~]# egrep &#x27;^(user|group)&#x27; /etc/php-fpm.d/www.conf</span><br><span class="line">user = nginx</span><br><span class="line">group = nginx</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[root@m03 ~]# grep &#x27;var/lib/php/session&#x27; /etc/php-fpm.d/www.conf</span><br><span class="line">php_value[session.save_path] = /var/lib/php/session</span><br><span class="line">[root@m03 ~]# mkdir -p /var/lib/php/session</span><br><span class="line">[root@m03 ~]# chown nginx.nginx /var/lib/php/session</span><br><span class="line"></span><br><span class="line">[root@m03 ~]# php-fpm -t</span><br><span class="line">[15-Jul-2021 15:33:44] NOTICE: configuration file /etc/php-fpm.conf test is successful</span><br><span class="line"></span><br><span class="line">[root@m03 ~]# systemctl reload php-fpm.service</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">04 php+nginxæµ‹è¯•</span></span><br><span class="line">[root@m03 ~]# mkdir -p /code/zabbix</span><br><span class="line">[root@m03 ~]# chown nginx.nginx /code/zabbix</span><br><span class="line">[root@m03 ~]# vim /code/zabbix/info.php</span><br><span class="line">[root@m03 ~]# cat /code/zabbix/info.php</span><br><span class="line">&lt;?php</span><br><span class="line">phpinfo();</span><br><span class="line">?&gt;</span><br><span class="line">[root@m03 ~]#</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>ç•¥è¿‡ğŸ‘‡</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆ›å»ºç›®å½•æµ‹è¯•æ–‡ä»¶</span></span><br><span class="line"><span class="built_in">cat</span> /app/code/zbx/info.php</span><br><span class="line">&lt;?php</span><br><span class="line">  phpinfo();</span><br><span class="line">?&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¯åŠ¨æœåŠ¡ä¸ces</span></span><br><span class="line">systemcatl <span class="built_in">enable</span> nginx php-fpm</span><br><span class="line">systemctl start nginx php-fpm</span><br><span class="line"></span><br><span class="line"><span class="comment"># æµ‹è¯•web(hostsè§£æ)</span></span><br><span class="line">10.0.0.63  zbx.oldboylinux.cn</span><br></pre></td></tr></table></figure>

<p>ç•¥è¿‡ğŸ‘†</p>
<p>:four:æ•°æ®åº“</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[root@m03 ~]<span class="comment"># yum install -y mariadb-server</span></span><br><span class="line">[root@m03 ~]<span class="comment"># mysql_secure_installation</span></span><br><span class="line">Y Y Y Y Y</span><br><span class="line">MariaDB [(none)]&gt; select user,host from mysql.user;</span><br><span class="line">MariaDB [(none)]&gt; show databases;</span><br><span class="line">create database zabbix charset utf8 collate utf8_bin;</span><br><span class="line">grant all on zabbix.* to <span class="string">&#x27;zabbix&#x27;</span>@<span class="string">&#x27;localhost&#x27;</span> identified by <span class="string">&#x27;1&#x27;</span>;</span><br><span class="line">grant all on zabbix.* to <span class="string">&#x27;zabbix&#x27;</span>@<span class="string">&#x27;172.16.1.%&#x27;</span> identified by <span class="string">&#x27;1&#x27;</span>;</span><br><span class="line">MariaDB [(none)]&gt; show databases;</span><br><span class="line">MariaDB [(none)]&gt; select user,host from mysql.user;</span><br></pre></td></tr></table></figure>





<p>ç•¥è¿‡ğŸ‘‡</p>
<p>zabbix 6.0 ä¸æ”¯æŒ mariadb 5.5(é»˜è®¤æºä¸­çš„mariadb)å®‰è£…mariadb 10.5</p>
<p><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1gN4y1g74Q?p=16&vd_source=629395ac7befa1625191c3f496068941">é…ç½®mariadb yumæº</a></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">[root@m03 ~]<span class="comment"># cat /etc/yum.repos.d/mariadb.repo</span></span><br><span class="line">[mariadb]</span><br><span class="line">name = MariaDB</span><br><span class="line">baseurl = http://mirrors.aliyun.com/mariadb/yum/10.5/centos7-amd64/</span><br><span class="line">gpgkey = http://mirrors.aliyun.com/mariadb/yum/RPM-GPG-KEY-MariaDB</span><br><span class="line">gpgcheck = 1</span><br><span class="line">enabled=1</span><br><span class="line"></span><br><span class="line">[root@m03 ~]<span class="comment"># yum install -y mariadb-server</span></span><br><span class="line">[root@m03 ~]<span class="comment"># rpm -qa |grep -i mariadb</span></span><br><span class="line">[root@m03 ~]<span class="comment"># systemctl enable mariadb</span></span><br><span class="line">[root@m03 ~]<span class="comment"># systemctl start mariadb</span></span><br><span class="line">[root@m03 ~]<span class="comment"># mysql_secure_installation  # æ•°æ®åº“åˆå§‹åŒ–ï¼ˆä»…1æ¬¡ï¼‰</span></span><br><span class="line">Enter current password <span class="keyword">for</span> root (enter <span class="keyword">for</span> none): å›è½¦</span><br><span class="line">Switch to unix_socket authentication [Y/n] è¾“å…¥n</span><br><span class="line">Change the root password? [Y/n] è¾“å…¥Y è®¾ç½®rootå¯†ç </span><br><span class="line">Remove anonymous <span class="built_in">users</span>? [Y/n] è¾“å…¥Y</span><br><span class="line">Disallow root login remotely? [Y/n] è¾“å…¥Y</span><br><span class="line">Remove <span class="built_in">test</span> database and access to it? [Y/n] è¾“å…¥Y</span><br><span class="line">Reload privilege tables now? [Y/n] è¾“å…¥Y</span><br><span class="line">Thanks <span class="keyword">for</span> using MariaDB!  è¡¨ç¤ºå®Œæˆ</span><br></pre></td></tr></table></figure>

<p>åˆ›å»ºzabbixç”¨æˆ·</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [(<span class="keyword">none</span>)]<span class="operator">&gt;</span> <span class="keyword">select</span> <span class="keyword">user</span>,host <span class="keyword">from</span> mysql.user;</span><br><span class="line">MariaDB [(<span class="keyword">none</span>)]<span class="operator">&gt;</span> <span class="keyword">show</span> databases;</span><br><span class="line"><span class="keyword">create</span> database zabbix charset utf8 <span class="keyword">collate</span> utf8_general_ci;  #æœ‰é—®é¢˜</span><br><span class="line"><span class="keyword">create</span> database zabbix <span class="type">character</span> <span class="keyword">set</span> utf8 <span class="keyword">collate</span> utf8_bin;</span><br><span class="line"><span class="keyword">grant</span> <span class="keyword">all</span> <span class="keyword">on</span> zabbix.<span class="operator">*</span> <span class="keyword">to</span> <span class="string">&#x27;zabbix&#x27;</span>@<span class="string">&#x27;localhost&#x27;</span> identified <span class="keyword">by</span> <span class="string">&#x27;1&#x27;</span>;</span><br><span class="line"><span class="keyword">grant</span> <span class="keyword">all</span> <span class="keyword">on</span> zabbix.<span class="operator">*</span> <span class="keyword">to</span> <span class="string">&#x27;zabbix&#x27;</span>@<span class="string">&#x27;172.16.1.%&#x27;</span> identified <span class="keyword">by</span> <span class="string">&#x27;1&#x27;</span>; #å¦‚æœæ•°æ®ä¸zabbix,phpä¸åœ¨ä¸€èµ·</span><br><span class="line">MariaDB [(<span class="keyword">none</span>)]<span class="operator">&gt;</span> <span class="keyword">show</span> databases;</span><br><span class="line">MariaDB [(<span class="keyword">none</span>)]<span class="operator">&gt;</span> <span class="keyword">select</span> <span class="keyword">user</span>,host <span class="keyword">from</span> mysql.user;</span><br></pre></td></tr></table></figure>

<p>å¯¼å…¥æ•°æ®åº“(æ³¨æ„å¯¼å…¥é¡ºåº)  (è·³è¿‡)</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[root@m03 ~]<span class="comment"># wget https://cdn.zabbix.com/zabbix/sources/stable/6.0/zabbix-6.0.9.tar.gz</span></span><br><span class="line">[root@m03 ~]<span class="comment"># tar xf zabbix-6.0.9.tar.gz</span></span><br><span class="line">[root@m03 ~]<span class="comment"># cd zabbix-6.0.9/database/mysql</span></span><br><span class="line">[root@m03 ~]<span class="comment"># ls -l</span></span><br><span class="line">[root@m03 ~]<span class="comment"># mysql -uroot -p1 zabbix &lt;schema.sql</span></span><br><span class="line">[root@m03 ~]<span class="comment"># mysql -uroot -p1 zabbix &lt;images.sql</span></span><br><span class="line">[root@m03 ~]<span class="comment"># mysql -uroot -p1 zabbix &lt;data.sql</span></span><br><span class="line">[root@m03 ~]<span class="comment"># mysql -uroot -p1 zabbix &lt;double.sql</span></span><br><span class="line">[root@m03 ~]<span class="comment"># mysql -uroot -p1 zabbix &lt;history_pk_prepare.sql</span></span><br></pre></td></tr></table></figure>

<p>æµ‹è¯•æ•°æ®åº“</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">cat mysqli.php</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//$link_id=mysqli_connect(&#x27;ä¸»æœºå&#x27;,&#x27;ç”¨æˆ·&#x27;,&#x27;å¯†ç &#x27;);</span></span><br><span class="line"><span class="variable">$link_id</span>=<span class="title function_ invoke__">mysqli_connect</span>(<span class="string">&#x27;localhost&#x27;</span>,<span class="string">&#x27;zabbix&#x27;</span>,<span class="string">&#x27;1&#x27;</span>) <span class="keyword">or</span></span><br><span class="line"><span class="title function_ invoke__">mysqli_error</span>();</span><br><span class="line">  <span class="keyword">if</span>(<span class="variable">$link_id</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;mysql successful by oldboy !&quot;</span>;</span><br><span class="line">  &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">mysqli_error</span>();</span><br><span class="line">  &#125;</span><br><span class="line"><span class="comment">//è¿™æ˜¯phpå•è¡Œæ³¨é‡Š</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>ç•¥è¿‡ğŸ‘†</p>
<p>:five:zabbix-æœåŠ¡ç«¯</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å®‰è£…zabbix yumæº</span></span><br><span class="line">yum -Uvh https://mirrors.tuna.tsinghua.edu.cn/zabbix/zabbix/5.0/rhel/7/x86_64/zabbix-release-5.0-1.el7.noarch.rpm</span><br><span class="line"></span><br><span class="line">sed <span class="string">&#x27;s#http://repo.zabbix.com#https://mirrors.tuna.tsinghua.edu.cn/zabbix#g&#x27;</span> /etc/yum.repos.d/zabbix.repo</span><br><span class="line"></span><br><span class="line"><span class="comment">#zabbix-release.....rpm zabbix yumæºçš„é…ç½®æ–‡ä»¶</span></span><br><span class="line"></span><br><span class="line">[root@m03 ~]<span class="comment"># cat /etc/yum.repos.d/zabbix.repo</span></span><br><span class="line">[zabbix]</span><br><span class="line">name=Zabbix Official Repository - <span class="variable">$basearch</span></span><br><span class="line">baseurl=https://mirror.tuna.tsinghua.edu.cn/zabbix/zabbix/5.0/rhel/7/<span class="variable">$basearch</span>/</span><br><span class="line">enabled=1</span><br><span class="line">gpgcheck=1</span><br><span class="line">gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-ZABBIX-A14FE591</span><br><span class="line"></span><br><span class="line">[zabbix-frontend]</span><br><span class="line">name=Zabbix Official Repository frontend - <span class="variable">$basearch</span></span><br><span class="line">baseurl=https://mirror.tuna.tsinghua.edu.cn/zabbix/zabbix/5.0/rhel/7/<span class="variable">$basearch</span>/frontend</span><br><span class="line">enabled=0</span><br><span class="line">gpgcheck=1</span><br><span class="line">gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-ZABBIX-A14FE591</span><br><span class="line"></span><br><span class="line">[zabbix-debuginfo]</span><br><span class="line">name=Zabbix Official Repository debuginfo - <span class="variable">$basearch</span></span><br><span class="line">baseurl=https://mirror.tuna.tsinghua.edu.cn/zabbix/zabbix/5.0/rhel/7/<span class="variable">$basearch</span>/debuginfo/</span><br><span class="line">enabled=0</span><br><span class="line">gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-ZABBIX-A14FE591</span><br><span class="line">gpgcheck=1</span><br><span class="line"></span><br><span class="line"><span class="comment"># å®‰è£… zabbix-server</span></span><br><span class="line">[root@m03 ~]<span class="comment"># yum install -y zabbix-server-mysql zabbix-agent2</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># zabbix æ•°æ®åº“å¯¼å…¥æ•°æ®</span></span><br><span class="line">[root@m03 ~]<span class="comment"># zcat /usr/share/doc/zabbix-server-mysql-5.0.13/create.sql.gz |mysql -uzabbix -p1 zabbix</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># zabbix æœåŠ¡ç«¯ é…ç½®è¿æ¥æ•°æ®åº“</span></span><br><span class="line">[root@m03 ~]<span class="comment"># vim /etc/zabbix/zabbix_server.conf</span></span><br><span class="line">[root@m03 ~]<span class="comment"># grep ^DB /etc/zabbix/zabbix_server.conf</span></span><br><span class="line">DBHost=localhost</span><br><span class="line">DBName=zabbix</span><br><span class="line">DBUser=zabbix</span><br><span class="line">DBPassword=1</span><br><span class="line"></span><br><span class="line">[root@m03 ~]<span class="comment"># grep -n &#x27;^DB&#x27; /etc/zabbix/zabbix_server.conf</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#ä¿®æ”¹å zabbix æœåŠ¡ç«¯å¼€å¯çš„åŠŸèƒ½ï¼ˆä¸ç”¨ä¿®æ”¹ï¼‰</span></span><br><span class="line">[root@m03 ~]<span class="comment"># grep &#x27;^[a-Z]&#x27; /etc/zabbix/zabbix_server.conf</span></span><br><span class="line">LogFile=/var/log/zabbix/zabbix_server.log</span><br><span class="line">LogFileSize=0</span><br><span class="line">PidFile=/var/run/zabbix/zabbix_server.pid</span><br><span class="line">SocketDir=/var/run/zabbix</span><br><span class="line">DBHost=localhost</span><br><span class="line">DBName=zabbix</span><br><span class="line">DBUser=zabbix</span><br><span class="line">DBPassword=1</span><br><span class="line">SNMPTrapperFile=/var/log/snmptrap/snmptrap.log</span><br><span class="line">Timeout=4</span><br><span class="line">AlertScriptsPath=/usr/lib/zabbix/alertscripts</span><br><span class="line">ExternalScripts=/usr/lib/zabbix/externalscripts</span><br><span class="line">LogSlowQueries=3000</span><br><span class="line">StatsAllowedIP=127.0.0.1</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¯åŠ¨ zabbix-server</span></span><br><span class="line">[root@m03 ~]<span class="comment"># systemctl enable zabbix-server</span></span><br><span class="line">[root@m03 ~]<span class="comment"># systemctl start zabbix-server</span></span><br><span class="line">[root@m03 ~]<span class="comment"># ss -lntup |grep zabbix</span></span><br><span class="line">[root@m03 ~]<span class="comment"># ps -ef |grep zabbix</span></span><br></pre></td></tr></table></figure>



<p>:six:zabbixå‰ç«¯é¡µé¢å‡†å¤‡</p>
<p><code>https://www.zabbix.com/cn/download_sources</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#ä½¿ç”¨æºç åŒ…</span></span><br><span class="line">wget https://cdn.zabbix.com/zabbix/sources/stable/5.0/zabbix-5.0.18.tar.gz</span><br><span class="line">tar xf zabbix-5.0.18</span><br><span class="line"><span class="built_in">cd</span> zabbix-5.0.18</span><br><span class="line"><span class="built_in">cp</span> -a ui/* /app/code/zbx/</span><br><span class="line"><span class="built_in">chown</span> -R nginx.nginx /app/code/zbx/</span><br></pre></td></tr></table></figure>



<p>:seven:å®‰è£…zabbix(zabbixå‰ç«¯é¡µé¢è¿æ¥æ•°æ®åº“ä¸zabbix-server)</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#phpæœ€åçš„é…ç½®</span></span><br><span class="line">Minimum required size of PHP post is 16M (configuration option <span class="string">&quot;post_max_size&quot;</span>).</span><br><span class="line">Minimum required <span class="built_in">limit</span> on execution time of PHP scripts is 300 (configuration option <span class="string">&quot;max_execution_time&quot;</span>).</span><br><span class="line">Minimum required <span class="built_in">limit</span> on input parse time <span class="keyword">for</span> PHP scripts is 300 (configuration option <span class="string">&quot;max_input_time&quot;</span>).</span><br><span class="line">Time zone <span class="keyword">for</span> PHP is not <span class="built_in">set</span> (configuration parameter <span class="string">&quot;date.timezone&quot;</span>).</span><br><span class="line"></span><br><span class="line">[root@m03 ~]<span class="comment"># vim /etc/php.ini</span></span><br><span class="line">post_max_size = 16M</span><br><span class="line">max_execution_time = 300</span><br><span class="line">max_input_time = 300</span><br><span class="line">date.timezone = Asia/Shanghai</span><br><span class="line"></span><br><span class="line">[root@m03 ~]<span class="comment"># egrep -n &#x27;^(max_|date.timezone|post_max)&#x27; /etc/php.ini</span></span><br><span class="line">368:max_execution_time = 300</span><br><span class="line">378:max_input_time = 600</span><br><span class="line">656:post_max_size = 80M</span><br><span class="line">802:max_file_uploads = 20</span><br><span class="line">877:date.timezone = Asia/Shanghai</span><br><span class="line"></span><br><span class="line">[root@m03 ~]<span class="comment"># rpm -ivh php72w-bcmath-7.2.34-1.w7.x86_64.rpm</span></span><br><span class="line">[root@m03 ~]<span class="comment"># yum install -y php72w-ldap</span></span><br><span class="line">[root@m03 ~]<span class="comment"># rpm -ivh php72w-ldap</span></span><br><span class="line">[root@m03 ~]<span class="comment"># systemctl reload php-fpm.service</span></span><br><span class="line">[root@m03 ~]<span class="comment"># systemctl restart php-fpm</span></span><br></pre></td></tr></table></figure>

<p>æµè§ˆå™¨è®¿é—®zbx.oldboylinux.cn  ç”¨æˆ·ï¼šadminï¼Œå¯†ç ï¼šzabbix</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@m03 ~]<span class="comment"># systemctl enable zabbix-agent2.service</span></span><br><span class="line">[root@m03 ~]<span class="comment"># systemctl start zabbix-agent2.service</span></span><br></pre></td></tr></table></figure>





<h1 id="ä¸ƒã€ç›‘æ§ä¸€å°æœåŠ¡å™¨ä¸»æœº"><a href="#ä¸ƒã€ç›‘æ§ä¸€å°æœåŠ¡å™¨ä¸»æœº" class="headerlink" title="ä¸ƒã€ç›‘æ§ä¸€å°æœåŠ¡å™¨ä¸»æœº"></a>ä¸ƒã€ç›‘æ§ä¸€å°æœåŠ¡å™¨ä¸»æœº</h1><h2 id="7-1-Zabbix-agent-vs-agent2"><a href="#7-1-Zabbix-agent-vs-agent2" class="headerlink" title="7.1 Zabbix agent vs agent2"></a>7.1 Zabbix agent vs agent2</h2><p>åœ¨ä»»ä½•ä¸€å°æœåŠ¡å™¨ä¸Šé¢å®‰è£…zabbix-agent  zabbix-agent2</p>
<table>
<thead>
<tr>
<th></th>
<th>zabbix agent</th>
<th>zabbix agent2</th>
</tr>
</thead>
<tbody><tr>
<td>å¼€å‘è¯­è¨€</td>
<td>Cè¯­è¨€</td>
<td>Goè¯­è¨€ï¼Œå’ŒCè¯­è¨€</td>
</tr>
<tr>
<td>æ€§èƒ½</td>
<td>ç‹¬ç«‹è¿›ç¨‹æ–¹å¼è¿è¡Œ</td>
<td>1ä¸ªè¿›ç¨‹å¤šçº¿ç¨‹æŠ€æœ¯è¿è¡Œï¼Œå‡å°‘èµ„æºæ¶ˆè€—å ç”¨è¾ƒå°‘tcpèµ„æºï¼Œèƒ½å¤Ÿæ‰¿å—æ›´é«˜å¹¶å‘</td>
</tr>
</tbody></table>
<h2 id="7-2-Zabbix-Agent-2-ç›‘æ§æµç¨‹"><a href="#7-2-Zabbix-Agent-2-ç›‘æ§æµç¨‹" class="headerlink" title="7.2 Zabbix Agent[2]ç›‘æ§æµç¨‹"></a>7.2 Zabbix Agent[2]ç›‘æ§æµç¨‹</h2><p>Linuxå®‰è£…ä¸é…ç½®å®¢æˆ·ç«¯</p>
<p>webæ·»åŠ ä¸é…ç½®ä¸»æœº</p>
<p>:one:Liunx:åœ¨å®¢æˆ·ç«¯å®‰è£…zabbix-agent2(rpm)</p>
<p>:two:Liunx:ä¿®æ”¹é…ç½®æ–‡ä»¶æŒ‡å®šServerä¸ºzabbixæœåŠ¡ç«¯</p>
<p>:three:webé¡µé¢:é…ç½®â€“&gt;ä¸»æœºä¸­æ·»åŠ ä¸»æœºä¸å…³è”æ¨¡æ¿</p>
<p>:four:webé¡µé¢:æ·»åŠ åæ£€æµ‹ä¸æ£€æŸ¥æ•°æ®</p>
<h3 id="1ï¼‰è¡¥å……-zabbixæœåŠ¡ç«¯ä¸å®¢æˆ·ç«¯é…ç½®è¯¦è§£"><a href="#1ï¼‰è¡¥å……-zabbixæœåŠ¡ç«¯ä¸å®¢æˆ·ç«¯é…ç½®è¯¦è§£" class="headerlink" title="1ï¼‰è¡¥å……:zabbixæœåŠ¡ç«¯ä¸å®¢æˆ·ç«¯é…ç½®è¯¦è§£"></a>1ï¼‰è¡¥å……:zabbixæœåŠ¡ç«¯ä¸å®¢æˆ·ç«¯é…ç½®è¯¦è§£</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#zabbix æœåŠ¡ç«¯ è¯´æ˜</span></span><br><span class="line"></span><br><span class="line">[root@m03 ~]<span class="comment"># rpm -qa |grep zabbix</span></span><br><span class="line">zabbix-release-5.0-1.el7.noarch    <span class="comment">#zabbix yumæºé…ç½®æ–‡ä»¶</span></span><br><span class="line">zabbix-server-mysql-5.0.13-1.el7.x86_64    <span class="comment">#server</span></span><br><span class="line">zabbix-agent2-5.0.13-1.el7.x86_64    <span class="comment">#agent2</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#zabbixæœåŠ¡ç«¯</span></span><br><span class="line">[root@m03 ~]<span class="comment"># rpm -ql zabbix-server-mysql</span></span><br><span class="line">/etc/logrotate.d/zabbix-server    <span class="comment">#æ—¥å¿—åˆ‡å‰²</span></span><br><span class="line">/etc/zabbix/zabbix_server.conf    <span class="comment">#zabbixæœåŠ¡ç«¯é…ç½®æ–‡ä»¶</span></span><br><span class="line">/usr/lib/systemd/system/zabbix-server.service    <span class="comment">#systemctl start/stop/restart è°ƒç”¨é…ç½®æ–‡ä»¶</span></span><br><span class="line">/usr/lib/zabbix/alertscripts    <span class="comment">#æŠ¥è­¦ä½¿ç”¨çš„è„šæœ¬  å­˜æ”¾å¤„</span></span><br><span class="line">/usr/lib/zabbix/externalscripts</span><br></pre></td></tr></table></figure>



<h3 id="2ï¼‰ç›‘æ§å®¢æˆ·ç«¯"><a href="#2ï¼‰ç›‘æ§å®¢æˆ·ç«¯" class="headerlink" title="2ï¼‰ç›‘æ§å®¢æˆ·ç«¯"></a>2ï¼‰ç›‘æ§å®¢æˆ·ç«¯</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@web01 ~]<span class="comment"># rpm -ivh https://mirrors.tuna.tsinghua.edu.cn/zabbix/zabbix/5.0/rhel/7/x86_64/zabbix-sender-5.0.18-1.el7.x86_64.rpm</span></span><br><span class="line">[root@web01 ~]<span class="comment"># systemctl enable zabbix-agent2.service</span></span><br><span class="line">[root@web01 ~]<span class="comment"># systemctl start zabbix-agent2.service</span></span><br><span class="line">[root@web01 ~]<span class="comment"># grep &#x27;^[a-Z]&#x27; /etc/zabbix/zabbix_agent2.conf</span></span><br><span class="line">[root@web01 ~]<span class="comment"># vim /etc/zabbix/zabbix_agent2.conf</span></span><br><span class="line">Server=172.16.1.71    <span class="comment">#æ”¹</span></span><br></pre></td></tr></table></figure>



<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@m03 ~]<span class="comment"># yum install -y zabbix-get</span></span><br><span class="line">[root@m03 ~]<span class="comment"># zabbix_get -s 172.16.1.7 -p 10050 -k system.hostname</span></span><br><span class="line">web01</span><br></pre></td></tr></table></figure>



<p><img src="https://images-1258700836.cos.ap-guangzhou.myqcloud.com/images/202210281032582.png" alt="image-20220925203729370"></p>
<p><img src="https://images-1258700836.cos.ap-guangzhou.myqcloud.com/images/202210281032584.png" alt="image-20220925203857824"></p>
<h2 id="7-3-æ—¥å¸¸æŸ¥çœ‹æ•°æ®"><a href="#7-3-æ—¥å¸¸æŸ¥çœ‹æ•°æ®" class="headerlink" title="7.3 æ—¥å¸¸æŸ¥çœ‹æ•°æ®"></a>7.3 æ—¥å¸¸æŸ¥çœ‹æ•°æ®</h2><h2 id="7-4-Zabbixä¸­æ–‡ä¹±ç é—®é¢˜"><a href="#7-4-Zabbixä¸­æ–‡ä¹±ç é—®é¢˜" class="headerlink" title="7.4 Zabbixä¸­æ–‡ä¹±ç é—®é¢˜"></a>7.4 Zabbixä¸­æ–‡ä¹±ç é—®é¢˜</h2><p>è§£å†³zabbixé»˜è®¤å›¾å½¢ä¹±ç é—®é¢˜</p>
<p>ä¿®æ”¹zabbixå­—ä½“</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /code/zabbix/assets/fonts/</span><br><span class="line"><span class="comment">#ä¸Šä¼ ä¸€ä¸ªä¸­æ–‡çš„ttfå­—ä½“  æ›¿æ¢  zabbixè‡ªç”¨çš„å­—ä½“å³å¯.</span></span><br><span class="line"><span class="built_in">cp</span> /code/zabbix/assets/fonts/DejavuSans.ttf&#123;,.bak&#125;</span><br><span class="line"><span class="built_in">cp</span> msyh.ttc /code/zabbix/assets/fonts/DejaVuSans.ttf</span><br></pre></td></tr></table></figure>





<h1 id="å…«ã€è‡ªå®šä¹‰ç›‘æ§é‚£ç‚¹äº‹"><a href="#å…«ã€è‡ªå®šä¹‰ç›‘æ§é‚£ç‚¹äº‹" class="headerlink" title="å…«ã€è‡ªå®šä¹‰ç›‘æ§é‚£ç‚¹äº‹"></a>å…«ã€è‡ªå®šä¹‰ç›‘æ§é‚£ç‚¹äº‹</h1><h2 id="8-1-è‡ªå®šä¹‰ç›‘æ§æ¦‚è¿°"><a href="#8-1-è‡ªå®šä¹‰ç›‘æ§æ¦‚è¿°" class="headerlink" title="8.1 è‡ªå®šä¹‰ç›‘æ§æ¦‚è¿°"></a>8.1 è‡ªå®šä¹‰ç›‘æ§æ¦‚è¿°</h2><ul>
<li>åº”ç”¨åœºæ™¯ï¼š<ul>
<li><strong>å®šåˆ¶ï¼š</strong>é»˜è®¤çš„æ¨¡æ¿ä¸­æ²¡æœ‰æˆ‘ä»¬è¦çš„ç›‘æ§é¡¹</li>
<li><strong>æå‡zabbixæ€§èƒ½&#x2F;ä¼˜åŒ–ï¼š</strong>å»æ‰&#x2F;å®šåˆ¶ç›‘æ§é¡¹ï¼Œæå‡zabbixæœåŠ¡ç«¯çš„æ€§èƒ½</li>
</ul>
</li>
<li>zabbixè‡ªå®šä¹‰ç›‘æ§ï¼Œè®°ä½ä¸€å¥è¯ï¼Œé—¯å¤©ä¸‹ï¼š<strong>åªè¦èƒ½å¤Ÿé€šè¿‡å‘½ä»¤&#x2F;è„šæœ¬å–å‡ºæ¥çš„å†…å®¹ï¼Œå°±å¯ä»¥åšè‡ªå®šä¹‰ç›‘æ§</strong></li>
</ul>
<h2 id="8-2-è‡ªå®šä¹‰ç›‘æ§é¡¹æµç¨‹"><a href="#8-2-è‡ªå®šä¹‰ç›‘æ§é¡¹æµç¨‹" class="headerlink" title="8.2 è‡ªå®šä¹‰ç›‘æ§é¡¹æµç¨‹"></a>8.2 è‡ªå®šä¹‰ç›‘æ§é¡¹æµç¨‹</h2><p>:one:Zabbixå®¢æˆ·ç«¯ï¼Œåˆ›å»ºkeyï¼ˆé”®å€¼ï¼‰ä¸è°ƒè¯•ï¼ˆè‡ªå®šä¹‰ç›‘æ§çš„æ ¸å¿ƒï¼‰</p>
<p>â€‹	ä¹¦å†™ç›‘æ§å‘½ä»¤&#x2F;è„šæœ¬</p>
<p>â€‹	è°ƒè¯•Debugå‘½ä»¤ä¸è„šæœ¬</p>
<p>â€‹	å†™å…¥åˆ°zabbixå®¢æˆ·ç«¯é…ç½®æ–‡ä»¶ä¸­ UserParameter&#x3D;key,commandæˆ–è„šæœ¬  ä¸è°ƒè¯•  zabbix_get</p>
<p>:two:ZabbixæœåŠ¡ç«¯webé¡µé¢-ç‚¹ç‚¹ç‚¹</p>
<p>â€‹	Webé¡µé¢æ·»åŠ &#x2F;ä¿®æ”¹æ¨¡æ¿</p>
<p>â€‹	Webé¡µé¢åˆ†ç»„</p>
<p>â€‹	:three:Webé¡µé¢ç›‘æ§é¡¹-zabbixæœåŠ¡ç«¯æ˜¯å¦å¯ä»¥è·å–æ•°æ®</p>
<p>â€‹	:four:Webé¡µé¢è§¦å‘å™¨ trigger-ä»€ä¹ˆæ—¶å€™æŠ¥è­¦</p>
<p>â€‹	:five:Webé¡µé¢å›¾å½¢</p>
<ul>
<li>è¦æ±‚ï¼Œç»Ÿè®¡web01  80ç«¯å£æ˜¯å¦å­˜åœ¨</li>
<li>å‡è®¾ï¼Œzabbixæ— æ³•è·å–ç«¯å£çŠ¶æ€</li>
<li>zabbixè‡ªå®šä¹‰ç›‘æ§é¡¹</li>
</ul>
<h2 id="zbx-è‡ªå®šä¹‰ç›‘æ§"><a href="#zbx-è‡ªå®šä¹‰ç›‘æ§" class="headerlink" title="zbx-è‡ªå®šä¹‰ç›‘æ§"></a>zbx-è‡ªå®šä¹‰ç›‘æ§</h2><h3 id="1-éœ€æ±‚ï¼šæ£€æŸ¥å½“å‰æœºå™¨æ˜¯å¦rootè¿œç¨‹ç™»å½•"><a href="#1-éœ€æ±‚ï¼šæ£€æŸ¥å½“å‰æœºå™¨æ˜¯å¦rootè¿œç¨‹ç™»å½•" class="headerlink" title="1.éœ€æ±‚ï¼šæ£€æŸ¥å½“å‰æœºå™¨æ˜¯å¦rootè¿œç¨‹ç™»å½•"></a>1.éœ€æ±‚ï¼šæ£€æŸ¥å½“å‰æœºå™¨æ˜¯å¦rootè¿œç¨‹ç™»å½•</h3><ul>
<li>:a:zbx-agent: web01 å‘½ä»¤è¡Œ<ul>
<li>ä¹¦å†™æ»¡è¶³è¦æ±‚çš„å‘½ä»¤</li>
</ul>
</li>
<li>:b:zbx-server webé¡µé¢<ul>
<li>å‘½ä»¤è¡Œåˆ›å»ºçš„é”®å€¼ä¸<strong>ç›‘æ§é¡¹</strong>å…³è”èµ·æ¥</li>
</ul>
</li>
</ul>
<h4 id="1-1-Linuxï¼šå‘½ä»¤"><a href="#1-1-Linuxï¼šå‘½ä»¤" class="headerlink" title="1.1 Linuxï¼šå‘½ä»¤"></a>1.1 Linuxï¼šå‘½ä»¤</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">who</span> |awk <span class="string">&#x27;$1==&quot;root&quot;&#x27;</span> |<span class="built_in">wc</span> -l  <span class="comment">#æ•°å­—å¤§äº1 è¡¨ç¤ºæœ‰rootè¿œç¨‹ç™»å½•.</span></span><br></pre></td></tr></table></figure>



<h4 id="1-2-Linuxï¼šåˆ›å»ºé”®å€¼-zbx-serverè¯†åˆ«ï¼‰"><a href="#1-2-Linuxï¼šåˆ›å»ºé”®å€¼-zbx-serverè¯†åˆ«ï¼‰" class="headerlink" title="1.2 Linuxï¼šåˆ›å»ºé”®å€¼(zbx-serverè¯†åˆ«ï¼‰"></a>1.2 Linuxï¼šåˆ›å»ºé”®å€¼(zbx-serverè¯†åˆ«ï¼‰</h4><ul>
<li>keyé”®å€¼ï¼šzbxæœåŠ¡ç«¯å†…ç½®ï¼Œç”¨æˆ·åˆ›å»ºçš„å‘½ä»¤ï¼Œå¯ä»¥è¢«zabbixæœåŠ¡ç«¯è¯†åˆ«ã€‚æœåŠ¡ç«¯æ‰§è¡Œå¯¹åº”çš„é”®å€¼å°±ä¼šè·å–å¯¹åº”çš„æ•°æ®ã€‚</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#åœ¨å®¢æˆ·ç«¯é…ç½®æ–‡ä»¶ä¸­æŒ‰ç…§è¦æ±‚çš„æ ¼å¼ä¹¦å†™å³å¯.</span></span><br><span class="line"></span><br><span class="line">[root@web01 ~]<span class="comment"># vim /etc/zabbix/zabbix_agent2.d/web.conf</span></span><br><span class="line"><span class="comment">#UserParameter=é”®å€¼åå­—,å¯¹åº”çš„å‘½ä»¤æˆ–è„šæœ¬</span></span><br><span class="line">UserParameter=root.login, <span class="built_in">who</span> |awk <span class="string">&#x27;$1==&quot;root&quot;&#x27;</span> |<span class="built_in">wc</span> -l</span><br><span class="line">[root@web01 ~]<span class="comment"># systemctl restart zabbix-agent2</span></span><br></pre></td></tr></table></figure>



<h4 id="1-3-Linuxï¼šæµ‹è¯•-zbx-æœåŠ¡ç«¯"><a href="#1-3-Linuxï¼šæµ‹è¯•-zbx-æœåŠ¡ç«¯" class="headerlink" title="1.3 Linuxï¼šæµ‹è¯•-zbx-æœåŠ¡ç«¯"></a>1.3 Linuxï¼šæµ‹è¯•-zbx-æœåŠ¡ç«¯</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@m03 ~]<span class="comment"># zabbix_get -s 172.16.1.7 -k root.login</span></span><br><span class="line">1</span><br></pre></td></tr></table></figure>



<h4 id="1-4-webï¼šåˆ›å»ºç›‘æ§é¡¹"><a href="#1-4-webï¼šåˆ›å»ºç›‘æ§é¡¹" class="headerlink" title="1.4 webï¼šåˆ›å»ºç›‘æ§é¡¹"></a>1.4 webï¼šåˆ›å»ºç›‘æ§é¡¹</h4><p>æ›´æ–°é—´éš”ï¼šçº¿ä¸Šç¯å¢ƒæ¨è1mï¼Œä¸å¤ªé‡è¦10m æˆ–1h</p>
<p>ç›‘æ§é¡¹ï¼šzbxæœåŠ¡ç«¯å‘å®¢æˆ·ç«¯è·å–æ•°æ®çš„ä¸€ä¸ªæ–¹å¼    ç›‘æ§é¡¹ä¸é”®å€¼å…³è”</p>
<p><img src="https://images-1258700836.cos.ap-guangzhou.myqcloud.com/images/202210281032585.png"></p>
<p>å†å²æ•°æ®ï¼šæ¯ä¸ªé—´éš”è·å–çš„æ•°æ®ï¼Œä¸å¤ªæ¨èä¿ç•™è¿‡é•¿</p>
<p>è¶‹åŠ¿æ•°æ®ï¼šæ¯ä¸ªå°æ—¶ï¼Œæˆ–è€…æ›´é•¿æ—¶é—´è·å–ä¸€æ¬¡å†å²æ•°æ®çš„å¹³å‡å€¼    å¯ä»¥é•¿æœŸä¿å­˜</p>
<p>åº”ç”¨é›†ï¼šå¯¹ ç›‘æ§é¡¹è¿›è¡Œåˆ†ç±»</p>
<p><img src="https://images-1258700836.cos.ap-guangzhou.myqcloud.com/images/202210281032586.png" alt="image-20220925214501414"></p>
<p><img src="https://images-1258700836.cos.ap-guangzhou.myqcloud.com/images/202210281032587.png" alt="image-20220925214552078"></p>
<p><img src="https://images-1258700836.cos.ap-guangzhou.myqcloud.com/images/202210281032588.png" alt="image-20220925214622832"></p>
<h4 id="1-5-webï¼šåˆ›å»ºè§¦å‘å™¨"><a href="#1-5-webï¼šåˆ›å»ºè§¦å‘å™¨" class="headerlink" title="1.5 webï¼šåˆ›å»ºè§¦å‘å™¨"></a>1.5 webï¼šåˆ›å»ºè§¦å‘å™¨</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">æŠ¥è­¦çš„æ¡ä»¶ï¼šrootç™»å½•çš„æ•°é‡å¤§äº2</span><br><span class="line"></span><br><span class="line">&#123;web01:root.login.last()&#125;    &gt;        2</span><br><span class="line">è·å–æ•°æ®                      æ¡ä»¶    æ¡ä»¶å¯¹åº”çš„å€¼(é˜ˆå€¼)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#123;ä¸»æœºå:é”®å€¼.å‡½æ•°åŠŸèƒ½&#125;</span><br><span class="line">å‡½æ•°åŠŸèƒ½ï¼šå¯¹åº”çš„ä¸åŒçš„æ•°æ®çš„å¤„ç†æ–¹æ³•</span><br><span class="line">æ¯”å¦‚ last() æœ€æ–°çš„å€¼</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">æ¯”å¦‚ sum() æ±‚å’Œ</span><br><span class="line">min()  æœ€å°å€¼</span><br><span class="line">max()  æœ€å¤§å€¼</span><br><span class="line">avg()  å¹³å‡å€¼</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">åˆ†æï¼š</span><br><span class="line">&#123;web01:system.uptime.last()&#125;&lt;10m #é‡å¯</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="https://images-1258700836.cos.ap-guangzhou.myqcloud.com/images/202210281032589.png" alt="image-20220925220908600"></p>
<p><img src="https://images-1258700836.cos.ap-guangzhou.myqcloud.com/images/202210281032590.png" alt="image-20220925221354232"></p>
<h4 id="1-6-webï¼šåˆ›å»ºå›¾å½¢"><a href="#1-6-webï¼šåˆ›å»ºå›¾å½¢" class="headerlink" title="1.6 webï¼šåˆ›å»ºå›¾å½¢"></a>1.6 webï¼šåˆ›å»ºå›¾å½¢</h4><p><img src="https://images-1258700836.cos.ap-guangzhou.myqcloud.com/images/202210281032591.png" alt="image-20220925230011298"></p>
<p><img src="https://images-1258700836.cos.ap-guangzhou.myqcloud.com/images/202210281032594.png" alt="image-20220925230026168"></p>
<h3 id="2-åˆ›å»ºæ¨¡æ¿ï¼šæ·»åŠ ç›‘æ§é¡¹ï¼Œè§¦å‘å™¨ï¼Œå›¾å½¢"><a href="#2-åˆ›å»ºæ¨¡æ¿ï¼šæ·»åŠ ç›‘æ§é¡¹ï¼Œè§¦å‘å™¨ï¼Œå›¾å½¢" class="headerlink" title="2.åˆ›å»ºæ¨¡æ¿ï¼šæ·»åŠ ç›‘æ§é¡¹ï¼Œè§¦å‘å™¨ï¼Œå›¾å½¢"></a>2.åˆ›å»ºæ¨¡æ¿ï¼šæ·»åŠ ç›‘æ§é¡¹ï¼Œè§¦å‘å™¨ï¼Œå›¾å½¢</h3><h4 id="2-1-åˆ›å»ºæ¨¡æ¿"><a href="#2-1-åˆ›å»ºæ¨¡æ¿" class="headerlink" title="2.1 åˆ›å»ºæ¨¡æ¿"></a>2.1 åˆ›å»ºæ¨¡æ¿</h4><p><img src="https://images-1258700836.cos.ap-guangzhou.myqcloud.com/images/202210281032595.png" alt="image-20220925230809175"></p>
<p><img src="https://images-1258700836.cos.ap-guangzhou.myqcloud.com/images/202210281032596.png" alt="image-20220925230838460"></p>
<p><img src="https://images-1258700836.cos.ap-guangzhou.myqcloud.com/images/202210281032597.png" alt="image-20220925230942274"></p>
<h4 id="2-2-æ¨¡æ¿å…³è”ä¸»æœº"><a href="#2-2-æ¨¡æ¿å…³è”ä¸»æœº" class="headerlink" title="2.2 æ¨¡æ¿å…³è”ä¸»æœº"></a>2.2 æ¨¡æ¿å…³è”ä¸»æœº</h4><p><img src="https://images-1258700836.cos.ap-guangzhou.myqcloud.com/images/202210281032598.png" alt="image-20220925231219140"></p>
<h3 id="3-ç›‘æ§å‘Šè­¦"><a href="#3-ç›‘æ§å‘Šè­¦" class="headerlink" title="3 ç›‘æ§å‘Šè­¦"></a>3 ç›‘æ§å‘Šè­¦</h3><h1 id="zbx-å…¨ç½‘å…¨é“¾è·¯-x2F-å…¨æµç¨‹ç›‘æ§-æ¶æ„"><a href="#zbx-å…¨ç½‘å…¨é“¾è·¯-x2F-å…¨æµç¨‹ç›‘æ§-æ¶æ„" class="headerlink" title="zbx-å…¨ç½‘å…¨é“¾è·¯&#x2F;å…¨æµç¨‹ç›‘æ§-æ¶æ„"></a>zbx-å…¨ç½‘å…¨é“¾è·¯&#x2F;å…¨æµç¨‹ç›‘æ§-æ¶æ„</h1><p>é¢è¯•é¢˜ï¼šä½ å…¬å¸ç›‘æ§äº†ä»€ä¹ˆï¼Ÿ&#x2F;ä½ ä»¬å…¬å¸ç›‘æ§æ˜¯å¦‚ä½•åšï¼Ÿ</p>
<ul>
<li>ç»´åº¦01ï¼šæ¯ä¸ªæœºå™¨<ul>
<li>ä¸šåŠ¡&#x2F;apiæ¥å£</li>
<li>æœåŠ¡å±‚</li>
<li>ç³»ç»Ÿå±‚</li>
<li>ç‰©ç†å±‚</li>
</ul>
</li>
<li>ç»´åº¦02ï¼šç”¨æˆ·è®¿é—®ç½‘ç«™ï¼ˆé›†ç¾¤ï¼‰<ul>
<li>DNS</li>
<li>CDN</li>
<li>ç½‘ç«™æ¶æ„<ul>
<li>å¸¦å®½</li>
<li>å¹¶å‘ï¼ˆç”¨æˆ·æ•°é‡ï¼‰ï¼Œæ—¥æ´»ï¼Œpv,uv,ip</li>
<li>å…·ä½“æœåŠ¡ç›‘æ§</li>
</ul>
</li>
</ul>
</li>
<li>ç»´åº¦03ï¼šå…¶ä»–<ul>
<li>æ—¥å¿—çš„é”™è¯¯ä¿¡æ¯</li>
<li>è¯ä¹¦è¿‡æœŸ</li>
<li>apmç›‘æ§  é“¾è·¯ç›‘æ§</li>
</ul>
</li>
</ul>
<p>zbxç›‘æ§æ¶æ„</p>
<p>zbxç›‘æ§èŠ‚ç‚¹</p>
<ul>
<li>linux</li>
<li>web<ul>
<li>åˆ›å»ºä¸»æœº</li>
<li>å…³è”æ¨¡æ¿</li>
</ul>
</li>
</ul>
<p>zbxè‡ªå®šä¹‰ç›‘æ§</p>
<ul>
<li>Linuxå®¢æˆ·ç«¯ï¼ˆè‡ªå®šä¹‰é”®å€¼keyï¼‰<ul>
<li>æ ¹æ®éœ€æ±‚ä¹¦å†™å‘½ä»¤&#x2F;è„šæœ¬å¹¶æµ‹è¯•</li>
<li>å‘½ä»¤æˆ–è„šæœ¬æŒ‰ç…§è¦æ±‚çš„æ ¼å¼ï¼Œå†™å…¥åˆ°å®¢æˆ·ç«¯é…ç½®æ–‡ä»¶</li>
<li>è¿›è¡Œè°ƒè¯•</li>
</ul>
</li>
<li>SRVæœåŠ¡ç«¯webé¡µé¢ï¼š<ul>
<li>ä¿®æ”¹ä¸»æœºä¿¡æ¯</li>
<li>æ·»åŠ ç›‘æ§é¡¹<ul>
<li>linuxé”®å€¼ ä¸ webé¡µé¢ å…³è”èµ·æ¥,serverå¯ä»¥é€šè¿‡é”®å€¼è·å–æ•°æ®.</li>
</ul>
</li>
<li>æ·»åŠ è§¦å‘å™¨<ul>
<li>æ˜¯å¦å‘Šè­¦</li>
</ul>
</li>
<li>æ·»åŠ å›¾å½¢</li>
</ul>
</li>
<li>åˆ¶ä½œæ¨¡æ¿<ul>
<li>å…ˆæ‰¾ä¸ªä¸»æœº<ul>
<li>åº”ç”¨é›†</li>
<li>åˆ›å»ºç›‘æ§é¡¹</li>
<li>åˆ›å»ºè§¦å‘å™¨</li>
<li>åˆ›å»ºå›¾å½¢</li>
</ul>
</li>
<li>å¤åˆ¶åˆ°æ¨¡æ¿ä¸­</li>
</ul>
</li>
</ul>
<p>zbxå‘Šè­¦æ–¹å¼</p>
<ul>
<li>é‚®ä»¶</li>
<li>å¾®ä¿¡</li>
<li>onealert</li>
</ul>
<p>zbxå®¢æˆ·ç«¯ç±»å‹</p>
<ul>
<li>zabbix agent2å®¢æˆ·æ»¡</li>
<li>snmp ç½‘ç»œè®¾å¤‡</li>
<li>jmx java</li>
<li>ipmi</li>
</ul>
<p>è‡ªåŠ¨åŒ–</p>
<ul>
<li>è‡ªåŠ¨å‘ç°</li>
<li>è‡ªåŠ¨æ³¨å†Œ</li>
<li>åˆ†å¸ƒå¼ç›‘æ§<ul>
<li>å¤šä¸ªæœºæˆ¿ï¼Œå¤šä¸ªå±€åŸŸç½‘ç›‘æ§</li>
</ul>
</li>
</ul>
<p>zbxç›‘æ§é¡¹ç›®</p>
<p>ç»¼åˆæ¶æ„å¼€å§‹</p>
<ul>
<li>æ­å»ºè¦æ±‚</li>
<li>æ­å»ºæµç¨‹</li>
<li>æ­å»ºç»“æœå¦‚ä½•éªŒæ”¶</li>
</ul>
<h1 id="ä¹ã€ç›‘æ§æŠ¥è­¦"><a href="#ä¹ã€ç›‘æ§æŠ¥è­¦" class="headerlink" title="ä¹ã€ç›‘æ§æŠ¥è­¦"></a>ä¹ã€ç›‘æ§æŠ¥è­¦</h1><h2 id="9-1-å‘Šè­¦åˆ†ç±»"><a href="#9-1-å‘Šè­¦åˆ†ç±»" class="headerlink" title="9.1 å‘Šè­¦åˆ†ç±»"></a>9.1 å‘Šè­¦åˆ†ç±»</h2><table>
<thead>
<tr>
<th>æŠ¥è­¦æ–¹å¼</th>
<th>ä¼ä¸šåº”ç”¨åœºæ™¯</th>
</tr>
</thead>
<tbody><tr>
<td>å‘é‚®ä»¶        ä¸ªäººé‚®ç®±</td>
<td>ä¼ä¸šé‚®ç®±ï¼Œå…è´¹ä½¿ç”¨</td>
</tr>
<tr>
<td>ä¼ä¸šå¾®ä¿¡-å‘Šè­¦åº”ç”¨ï¼ˆæœºå™¨äººï¼‰</td>
<td>éœ€è¦ä½¿ç”¨ä¼ä¸šå¾®ä¿¡ï¼Œå…è´¹</td>
</tr>
<tr>
<td>OAç³»ç»Ÿï¼ˆé’‰é’‰ï¼‰</td>
<td>ä¸é˜¿é‡Œäº‘ï¼Œå…è´¹</td>
</tr>
<tr>
<td>çŸ­ä¿¡</td>
<td>0.045å…ƒ&#x2F;æ¡å·¦å³ï¼ˆé˜¿é‡Œäº‘çŸ­ä¿¡æœåŠ¡ï¼‰æ”¶è´¹</td>
</tr>
<tr>
<td>ç”µè¯</td>
<td>æ”¶è´¹</td>
</tr>
<tr>
<td>ç¬¬ä¸‰æ–¹æŠ¥è­¦å·¥å…·&#x2F;å¹³å°ï¼šonealertï¼ˆçœäº‹ï¼‰</td>
<td>åªéœ€è¦é…ç½®onealertçš„å¹³å°ä¿¡æ¯ï¼Œå…è´¹ä½¿ç”¨ï¼ˆé™åˆ¶ï¼‰ï¼Œæ”¶è´¹</td>
</tr>
</tbody></table>
<h2 id="9-2-é‚®ä»¶æŠ¥è­¦"><a href="#9-2-é‚®ä»¶æŠ¥è­¦" class="headerlink" title="9.2 é‚®ä»¶æŠ¥è­¦"></a>9.2 é‚®ä»¶æŠ¥è­¦</h2><h3 id="1ï¼‰å…¨æµç¨‹"><a href="#1ï¼‰å…¨æµç¨‹" class="headerlink" title="1ï¼‰å…¨æµç¨‹"></a>1ï¼‰å…¨æµç¨‹</h3><p>:one:ä¸ªäººé‚®ç®±&#x2F;ä¼ä¸šé‚®ç®±</p>
<p>:two:å¼€å¯ä¸ªäººé‚®ç®±  smtpåŠŸèƒ½  è·å–æˆæƒç </p>
<p>:three:<strong>å‘ä»¶äººï¼š</strong>é…ç½®zabbix <strong>æŠ¥è­¦åª’ä»‹ç±»å‹</strong></p>
<p>:four:<strong>æ”¶ä»¶äººï¼š</strong>é…ç½®ç”¨æˆ·æ¥æ”¶æŠ¥è­¦</p>
<p>:five:<strong>ä»€ä¹ˆæ—¶å€™å‘é‚®ä»¶ï¼š</strong>é…ç½®åŠ¨ä½œ</p>
<h3 id="2ï¼‰ä¸ªäººé‚®ç®±å‡†å¤‡ï¼ˆç•¥ï¼‰"><a href="#2ï¼‰ä¸ªäººé‚®ç®±å‡†å¤‡ï¼ˆç•¥ï¼‰" class="headerlink" title="2ï¼‰ä¸ªäººé‚®ç®±å‡†å¤‡ï¼ˆç•¥ï¼‰"></a>2ï¼‰ä¸ªäººé‚®ç®±å‡†å¤‡ï¼ˆç•¥ï¼‰</h3><p>é…ç½®ä¸ªäººé‚®ç®±</p>
<h3 id="3ï¼‰é…ç½®å‘ä»¶äºº"><a href="#3ï¼‰é…ç½®å‘ä»¶äºº" class="headerlink" title="3ï¼‰é…ç½®å‘ä»¶äºº"></a>3ï¼‰é…ç½®å‘ä»¶äºº</h3><p>é…ç½®å‘ä»¶äºº-æŠ¥è­¦åª’ä»‹</p>
<p><img src="https://images-1258700836.cos.ap-guangzhou.myqcloud.com/images/202210281032599.png" alt="image-20220925233709769"></p>
<p>å‘Šè­¦é‚®ä»¶å†…å®¹ï¼šMessages template</p>
<p><img src="https://images-1258700836.cos.ap-guangzhou.myqcloud.com/images/202210281032601.png" alt="image-20220925234035750"></p>
<p><img src="https://images-1258700836.cos.ap-guangzhou.myqcloud.com/images/202210281032602.png" alt="image-20220925234011891"></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#ä¿¡æ¯ç±»å‹æ˜¯ï¼šé—®é¢˜ï¼ˆå‘ç”Ÿæ•…éšœï¼‰</span></span><br><span class="line"></span><br><span class="line">ä¸»é¢˜ï¼š æ•…éšœåç§°ï¼š&#123;EVENT.NAME&#125;</span><br><span class="line"></span><br><span class="line">æ¶ˆæ¯ï¼š</span><br><span class="line">æ•…éšœå§‹äºæ—¶é—´ï¼š&#123;EVENT.TIME&#125;  æ—¥æœŸï¼š&#123;EVENT.DATE&#125;</span><br><span class="line">æ•…éšœåç§°ï¼š&#123;EVENT.NAME&#125;</span><br><span class="line">æ•…éšœä¸»æœºï¼š&#123;HOST.NAME&#125;</span><br><span class="line">ä¸¥é‡ç¨‹åº¦ï¼š&#123;EVENT.SEVERITY&#125;</span><br><span class="line">é¢å¤–ä¿¡æ¯ï¼š&#123;EVENT.OPDATA&#125;</span><br><span class="line">æ•…éšœIDï¼š&#123;EVENT.ID&#125;</span><br><span class="line">è§¦å‘å™¨åœ°å€ï¼š&#123;TRIGGER.URL&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">#ä¿¡æ¯ç±»å‹æ˜¯ï¼šProblem recov  æ•…éšœè§£å†³çš„æ—¶å€™</span></span><br><span class="line"></span><br><span class="line">ä¸»é¢˜ï¼š æ•…éšœè§£å†³ <span class="keyword">in</span> &#123;EVENT.DURATION&#125;: &#123;EVENT.NAME&#125;</span><br><span class="line"></span><br><span class="line">æ¶ˆæ¯ï¼š</span><br><span class="line">æ•…éšœå·²ç»è§£å†³ æ—¶é—´ï¼š&#123;EVENT.RECOVERY.TIME&#125;  æ—¥æœŸï¼š&#123;EVENT.RECOVERY.DATE&#125;</span><br><span class="line">æ•…éšœåç§°ï¼š&#123;EVENT.NAME&#125;</span><br><span class="line">æ•…éšœæŒç»­æ—¶é—´ï¼š&#123;EVENT.DURATION&#125;</span><br><span class="line">æ•…éšœä¸»æœºï¼š&#123;HOST.NAME&#125;</span><br><span class="line">æ•…éšœçº§åˆ«ï¼š&#123;EVENT.SEVERITY&#125;</span><br><span class="line">æ•…éšœIDï¼š&#123;EVENT.ID&#125;</span><br><span class="line">&#123;TRIGGER.URL&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p><img src="https://images-1258700836.cos.ap-guangzhou.myqcloud.com/images/202210281032603.png" alt="image-20220925234233140"></p>
<p>å¤šç§è§¦å‘æ¡ä»¶</p>
<p><img src="https://images-1258700836.cos.ap-guangzhou.myqcloud.com/images/202210281032604.png" alt="image-20220925234616949"></p>
<p><img src="https://images-1258700836.cos.ap-guangzhou.myqcloud.com/images/202210281032605.png" alt="image-20220925234643754"></p>
<p><img src="https://images-1258700836.cos.ap-guangzhou.myqcloud.com/images/202210281032606.png" alt="image-20220925234905343"></p>
<p><img src="https://images-1258700836.cos.ap-guangzhou.myqcloud.com/images/202210281032607.png" alt="image-20220925234724709"></p>
<p>å¤šç§ æ“ä½œï¼ˆå‘æ¶ˆæ¯ï¼Œè¿œç¨‹å‘½ä»¤ï¼‰</p>
<h2 id="9-3-å¾®ä¿¡æŠ¥è­¦"><a href="#9-3-å¾®ä¿¡æŠ¥è­¦" class="headerlink" title="9.3 å¾®ä¿¡æŠ¥è­¦"></a>9.3 å¾®ä¿¡æŠ¥è­¦</h2><h3 id="1ï¼‰å…¨æµç¨‹-1"><a href="#1ï¼‰å…¨æµç¨‹-1" class="headerlink" title="1ï¼‰å…¨æµç¨‹"></a>1ï¼‰å…¨æµç¨‹</h3><p>å¾®ä¿¡æŠ¥è­¦ï¼ŒçŸ­ä¿¡ï¼Œç”µè¯ï¼Œé’‰é’‰è‡ªå®šä¹‰è„šæœ¬æŠ¥è­¦</p>
<p>é€šè¿‡è„šæœ¬(py,shell)ï¼Œè°ƒç”¨å¯¹æ–¹apiæ¥å£ï¼ˆè¾“å…¥æ¥å£éœ€è¦çš„ä¿¡æ¯ï¼Œè®¿é—®ä¸ä½¿ç”¨apiæ¥å£ï¼‰</p>
<p>:one:ä¼ä¸šå¾®ä¿¡</p>
<p>:two:ä¼ä¸šå¾®ä¿¡idå’Œå‘Šè­¦æœºå™¨äººid</p>
<p>:three:ä½¿ç”¨è„šæœ¬(shell&#x2F;python)è°ƒç”¨ä¼ä¸šå¾®ä¿¡apiæ¥å£ï¼špython  è¾“å…¥  æ”¶ä»¶äºº  ä¿¡æ¯</p>
<p>:four:å‘ä»¶äººï¼šæŠ¥è­¦åª’ä»‹</p>
<p>:five:æ”¶ä»¶äººï¼šä¸ªäºº  åª’ä½“ç±»å‹</p>
<p>:six:åŠ¨ä½œï¼šå·²ç»å®Œæˆ</p>
<h3 id="2ï¼‰å‡†å¤‡ç¯å¢ƒ-1-3"><a href="#2ï¼‰å‡†å¤‡ç¯å¢ƒ-1-3" class="headerlink" title="2ï¼‰å‡†å¤‡ç¯å¢ƒ 1-3"></a>2ï¼‰å‡†å¤‡ç¯å¢ƒ 1-3</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#1.ä¼ä¸šå¾®ä¿¡ idå·</span></span><br><span class="line">Wwed9036e79f2da881</span><br><span class="line"></span><br><span class="line"><span class="comment">#2.åˆ›å»º1ä¸ªæŠ¥è­¦æœºå™¨äººï¼ˆåº”ç”¨)</span></span><br><span class="line"><span class="comment">##æœºå™¨äººçš„id(åº”ç”¨id)</span></span><br><span class="line">agentid 1000084</span><br><span class="line"></span><br><span class="line"><span class="comment">##åº”ç”¨å¯†ç </span></span><br><span class="line">Secret rfWL-rd6gF_eONI20QMHo-FvuuFHOwsXCfXmI9c0B4</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line">[root@m03-zabbix-server ~]<span class="comment"># vim /usr/lib/zabbix/alertscripts/wechat.py</span></span><br><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment">#-*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment">#author: oldboy-linux</span></span><br><span class="line"><span class="comment">#date: 2021</span></span><br><span class="line"><span class="comment">#comment: Zabbix Wechat Alerts Scripts</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> logging</span><br><span class="line"></span><br><span class="line">logging.basicConfig(level = logging.DEBUG, <span class="built_in">format</span> = <span class="string">&#x27;%(asctime)s, %(filename)s, %(levelname)s, %(message)s&#x27;</span>,</span><br><span class="line">                datefmt = <span class="string">&#x27;%a, %d %b %Y %H:%M:%S&#x27;</span>,</span><br><span class="line">                filename = os.path.join(<span class="string">&#x27;/tmp&#x27;</span>,<span class="string">&#x27;weixin.log&#x27;</span>),</span><br><span class="line">                filemode = <span class="string">&#x27;a&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#idå’Œsecretéœ€è¦ä¿®æ”¹</span></span><br><span class="line"><span class="comment">#ä¼ä¸šid</span></span><br><span class="line">corpid=<span class="string">&#x27;wxd074861951c6ba6&#x27;</span></span><br><span class="line"><span class="comment">#æœºå™¨äººå¯†ç </span></span><br><span class="line">appsecret=<span class="string">&#x27;QtraZrI936DZ0Z3aSWTZ-lFVheAMgLmq3toM4B9U1A&#x27;</span></span><br><span class="line"><span class="comment">#æœºå™¨äººid</span></span><br><span class="line">agentid=<span class="number">1000004</span></span><br><span class="line"><span class="comment">#è·å–accesstoken</span></span><br><span class="line">token_url=<span class="string">&#x27;https://qyapi.weixin.qq.com/cgi-bin/gettoken?corpid=&#x27;</span> + corpid + <span class="string">&#x27;&amp;corpsecret=&#x27;</span> + appsecret req=requests.get(token_url)</span><br><span class="line">accesstoken=req.json()[<span class="string">&#x27;access_token&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">#å‘é€æ¶ˆæ¯</span></span><br><span class="line">msgsend_url=<span class="string">&#x27;https://qyapi.weixin.qq.com/cgi-bin/message/send?access_token=&#x27;</span> + accesstoken</span><br><span class="line"></span><br><span class="line"><span class="comment">#è„šæœ¬å‚æ•°</span></span><br><span class="line">touser=sys.argv[<span class="number">1</span>]</span><br><span class="line">subject=sys.argv[<span class="number">2</span>]</span><br><span class="line">message=sys.argv[<span class="number">2</span>] + <span class="string">&quot;\n\n&quot;</span> +sys.argv[<span class="number">3</span>]</span><br><span class="line"></span><br><span class="line">params=&#123;</span><br><span class="line">        <span class="string">&quot;touser&quot;</span>: touser,</span><br><span class="line"><span class="comment">#       &quot;toparty&quot;: toparty,</span></span><br><span class="line">        <span class="string">&quot;msgtype&quot;</span>: <span class="string">&quot;text&quot;</span>,</span><br><span class="line">        <span class="string">&quot;agentid&quot;</span>: agentid,</span><br><span class="line">        <span class="string">&quot;text&quot;</span>: &#123;</span><br><span class="line">                <span class="string">&quot;content&quot;</span>: message</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="string">&quot;safe&quot;</span>: <span class="number">0</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">req=requests.post(msgsend_url, data=json.dumps(params))</span><br><span class="line"></span><br><span class="line">logging.info(<span class="string">&#x27;sendto:&#x27;</span> + touser + <span class="string">&#x27;;;subject:&#x27;</span> + subject + <span class="string">&#x27;;;message:&#x27;</span> + message)</span><br><span class="line"></span><br><span class="line">[root@m03-zabbix-server ~]<span class="comment"># chmod +x /usr/lib/zabbix/alertscripts/wechat.py</span></span><br><span class="line">[root@m03-zabbix-server ~]<span class="comment"># python /usr/lib/zabbix/alertscripts/wechat.py ç”¨æˆ·(id) ä¸»é¢˜ å†…å®¹</span></span><br><span class="line">[root@m03-zabbix-server ~]<span class="comment"># python /usr/lib/zabbix/alertscripts/wechat.py lidao996 ä¸»é¢˜ å†…å®¹</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#æµ‹è¯•</span></span><br><span class="line">[root@m03-zabbix-server ~]<span class="comment"># python /usr/lib/zabbix/alertscripts/wechat.py all &#x27;ä¸‹é›¨&#x27; &#x27;æ‰“é›·æ”¶è¡£æœ&#x27;</span></span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">  File <span class="string">&quot;/usr/lib/zabbix/alertscripts/wechat.py&quot;</span>, line <span class="number">7</span>, <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">    <span class="keyword">import</span> requests</span><br><span class="line">ImportError: No module named requests</span><br><span class="line"></span><br><span class="line">yum install -y python-pip</span><br><span class="line">pip install requests -i https://mirrors.aliyun.com/pypi/simple/</span><br><span class="line"></span><br><span class="line"><span class="comment">#webé¡µé¢  å‘ä»¶äººï¼šæŠ¥è­¦åª’ä»‹ç±»å‹</span></span><br><span class="line">&#123;ALERT.SENDTO&#125;  <span class="comment">#å‘ç»™è°</span></span><br><span class="line">&#123;ALERT.SUBJECT&#125;  <span class="comment">#æŠ¥è­¦æ ‡é¢˜</span></span><br><span class="line">&#123;ALERT.MESSAGE&#125;  <span class="comment">#æŠ¥è­¦å†…å®¹</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">æ•…éšœç›®å‰å·²ç»è§£å†³æ—¶é—´ï¼š&#123;EVENT.RE COVERY.TIME&#125;  æ—¥æœŸ&#123;EVENT.RECOVERY.DATE&#125;</span><br><span class="line">æ•…éšœåç§°ï¼š&#123;EVENT.NAME&#125;</span><br><span class="line">æ•…éšœç»å†å¤šä¹…ï¼š&#123;EVENT.DURATION&#125;</span><br><span class="line">æ•…éšœä¸»æœºï¼š&#123;HOST.NAME&#125;</span><br><span class="line">æ•…éšœçº§åˆ«ï¼š&#123;EVENT.SEVERITY&#125;</span><br><span class="line">æ•…éšœIDï¼š&#123;EVENT.ID&#125;</span><br><span class="line">&#123;TRIGGER.URL&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">#webé¡µé¢ æ”¶ä»¶äººï¼šæ¥æ”¶ç”¨æˆ·</span></span><br><span class="line"><span class="comment">#webé¡µé¢ é…ç½®--&gt;åŠ¨ä½œ</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">https://qyapi.weixin.qq.com:<span class="number">443</span> <span class="string">&quot;POST /cgi-bin/message/send?access_token=kCT_jUrfrzc-_QIQX3pno12a7cR8TnNERQxAD7-cA3wnTQ85BBSZV8PJH5oxraYDarMy4i04BY2BPOdiAgoSe8jMEWwjXQv4DLHSMhkLbu3SNw1Va0T6nLhlg6CU0jJ9GTUTtfJEb-WAprHMLFV8hIUjI80j09mRxmEbhwOFgul_AlhsaCc8H_PQfwwXfV-rD4mOuTCBnSZhNJLeHBcQ</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">https://qyapi.weixin.qq.com</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">/cgi-bin/message/send?</span></span><br><span class="line"><span class="string">access_token=kCT_jUrfrzc-_QIQX3pno12a7cR8TnNERQxAD7-cA3wnTQY-</span></span><br><span class="line"><span class="string">85BBSZV8PJH5oxraYDarMy4i04BY2BPOdiAgoSe8jMEWwjXQv4DLHSMhkLbu3SNw1Va0T6nLhlg6CU0jJ9GTUTtfJEb-</span></span><br><span class="line"><span class="string">WAprHMlFV8hIUjI80j09mRxmEbhwOFgul_AlhsaCc8H_PQfwwXfV-rD4mOuTCBnSZhNJLeHBcQ</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">#shellç‰ˆæœ¬çš„ è„šæœ¬</span></span><br><span class="line"><span class="string"></span></span><br></pre></td></tr></table></figure>



<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@m03/usr/lib/zabbix/alertscripts]<span class="comment"># python wechat.py @all &#x27;ç½‘ç«™æŒ‚äº†&#x27; &#x27;www.oldboylinux.cn&#x27;</span></span><br><span class="line"></span><br><span class="line">æµ‹è¯•OK</span><br></pre></td></tr></table></figure>



<h3 id="3ï¼‰é…ç½®å‘ä»¶äºº-1"><a href="#3ï¼‰é…ç½®å‘ä»¶äºº-1" class="headerlink" title="3ï¼‰é…ç½®å‘ä»¶äºº"></a>3ï¼‰é…ç½®å‘ä»¶äºº</h3><p><img src="https://images-1258700836.cos.ap-guangzhou.myqcloud.com/images/202210281032608.png" alt="image-20220926002703777"></p>
<p><img src="https://images-1258700836.cos.ap-guangzhou.myqcloud.com/images/202210281032609.png" alt="image-20220926003456347"></p>
<p><img src="https://images-1258700836.cos.ap-guangzhou.myqcloud.com/images/202210281032610.png" alt="image-20220926003626085"></p>
<h1 id="åã€æ¢ä¸ªè§’åº¦çœ‹ç›‘æ§-zabbiz-agent"><a href="#åã€æ¢ä¸ªè§’åº¦çœ‹ç›‘æ§-zabbiz-agent" class="headerlink" title="åã€æ¢ä¸ªè§’åº¦çœ‹ç›‘æ§-zabbiz-agent"></a>åã€æ¢ä¸ªè§’åº¦çœ‹ç›‘æ§-zabbiz-agent</h1><h2 id="10-1-Zabbixå®¢æˆ·ç«¯æ¦‚è¿°"><a href="#10-1-Zabbixå®¢æˆ·ç«¯æ¦‚è¿°" class="headerlink" title="10.1 Zabbixå®¢æˆ·ç«¯æ¦‚è¿°"></a>10.1 Zabbixå®¢æˆ·ç«¯æ¦‚è¿°</h2><table>
<thead>
<tr>
<th>zabbixå®¢æˆ·ç«¯</th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td>Zabbix-agent2(æœ€å¸¸ç”¨)</td>
<td>é€‚ç”¨äºå‡ ä¹æ‰€æœ‰æƒ…å†µï¼Œæ”¯æŒè‡ªå®šä¹‰ç›‘æ§ï¼Œlinux,windows,android&#x2F;ios</td>
</tr>
<tr>
<td>SNMPå®¢æˆ·ç«¯</td>
<td>Simple Network Management Protocal  <strong>ç®€å•ç½‘ç»œç®¡ç†åè®®</strong>  ç›‘æ§ç½‘ç»œè®¾å¤‡</td>
</tr>
<tr>
<td>JMX</td>
<td>Java-gateway ç›‘æ§java app(tomcat),<strong>æœªæ¥æ¨èè‡ªå®šä¹‰ç›‘æ§(zabbix_agents2 + jmap&#x2F;jstats)</strong></td>
</tr>
<tr>
<td>IPMI</td>
<td>ç›‘æ§ç¡¬ä»¶(ç‰©ç†æœåŠ¡å™¨,è”æƒ³(IBM X86æ¶æ„ThinkServer),åä¸º,æµªæ½®,Dell,IBM,HP)<strong>ç›´æ¥ä½¿ç”¨è‡ªå®šä¹‰ç›‘æ§(ipmitool + megacli)</strong></td>
</tr>
</tbody></table>
<h2 id="10-2-Zabbix-agent2-ç›‘æ§-windows"><a href="#10-2-Zabbix-agent2-ç›‘æ§-windows" class="headerlink" title="10.2 Zabbix_agent2 ç›‘æ§ windows"></a>10.2 Zabbix_agent2 ç›‘æ§ windows</h2><h2 id="10-3-snmpç›‘æ§ç½‘ç»œè®¾å¤‡"><a href="#10-3-snmpç›‘æ§ç½‘ç»œè®¾å¤‡" class="headerlink" title="10.3 snmpç›‘æ§ç½‘ç»œè®¾å¤‡"></a>10.3 snmpç›‘æ§ç½‘ç»œè®¾å¤‡</h2><ul>
<li>åº”ç”¨ï¼š<ul>
<li><strong>ç›‘æ§ç½‘ç»œè®¾å¤‡ï¼ˆå¸¸ç”¨ï¼‰</strong></li>
<li>ä¹Ÿæ”¯æŒç›‘æ§å¯ä»¥å¯åŠ¨SNMPåŠŸèƒ½çš„è®¾å¤‡ï¼ˆwindows,linux,æ‰“å°æœºâ€¦â€¦ï¼‰</li>
</ul>
</li>
</ul>
<h3 id="1ï¼‰ç›‘æ§ç½‘ç»œè®¾å¤‡"><a href="#1ï¼‰ç›‘æ§ç½‘ç»œè®¾å¤‡" class="headerlink" title="1ï¼‰ç›‘æ§ç½‘ç»œè®¾å¤‡"></a>1ï¼‰ç›‘æ§ç½‘ç»œè®¾å¤‡</h3><p>:one:å¯åŠ¨ è®¾å¤‡çš„SNMPåŠŸèƒ½ï¼ˆç½‘ç»œè®¾å¤‡ï¼‰</p>
<p>:two:zabbixæœåŠ¡ç«¯è¿›è¡Œæµ‹è¯• èƒ½å¦è·å–åˆ° ç½‘ç»œè®¾å¤‡çš„ä¿¡æ¯</p>
<p>:three:webæ·»åŠ ä¸»æœºï¼Œç›‘æ§é¡¹â€¦â€¦</p>
<h4 id="a-å¯åŠ¨snmp"><a href="#a-å¯åŠ¨snmp" class="headerlink" title="a.å¯åŠ¨snmp"></a>a.å¯åŠ¨snmp</h4><table>
<thead>
<tr>
<th>snmpç‰ˆæœ¬</th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td>v3</td>
<td>é€šè¿‡ç”¨æˆ·åå’Œå¯†ç  è®¿é—® snmpä¿¡æ¯</td>
</tr>
<tr>
<td>v2c</td>
<td>é€šè¿‡ å›¢ä½“åid è®¿é—®è®¾å¤‡ è®¿é—® snmpä¿¡æ¯</td>
</tr>
<tr>
<td>V1</td>
<td></td>
</tr>
</tbody></table>
<p>zabbix-serveræ£€æŸ¥ ç½‘ç»œè®¾å¤‡çŠ¶æ€</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">yum install -y net-snmp-utils</span><br><span class="line"></span><br><span class="line">COMIMUNITY</span><br><span class="line"></span><br><span class="line">[rootgm03 ~]<span class="comment"># snmpwalk -c oldboykx -v 2c 192.168.13.1 SysDesc</span></span><br><span class="line">SNMPv2-MIB::sysDescr.0 = STRING: H3C Product Version ERHMG2-MNW100-R1117</span><br><span class="line">H3C ERHMG2</span><br><span class="line">Copyright(c) 2014-2018 New H3C Technologies Co., Ltd. All rights reserved.</span><br><span class="line">[root@m03 ~]<span class="comment"># snmpwalk -c oldboykx -v 2c 192.168.13.1 sysdesc</span></span><br><span class="line">SNMPv2-MIB::sysDescr.0 = STRING: H3C Product Version ERHMG2-MNW100-R1117</span><br><span class="line">H3C ERHMG2</span><br><span class="line">Copyright(c) 2014-2018 New H3C Technologies Co., Ltd. All rights reserved.</span><br><span class="line"></span><br><span class="line">snmpwalk å‘½ä»¤ ä½¿ç”¨getæ–¹å¼è®¿é—®ç½‘ç»œè®¾å¤‡</span><br><span class="line">-c å›¢ä½“åç§°  <span class="comment">#v2cç‰ˆæœ¬ä½¿ç”¨ å›¢ä½“åç§°</span></span><br><span class="line">-v æŒ‡å®šsnmpç‰ˆæœ¬  <span class="comment">#v2c v3</span></span><br><span class="line">ipåœ°å€</span><br><span class="line">æŒ‡ä»¤ï¼ˆè·å–ç½‘ç»œè®¾å¤‡çš„ä¿¡æ¯ï¼‰  åç§°æ–¹å¼/oid</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#oid Object ID äº‹åŠ¡id ç»™ä¸–é—´ä¸‡ç‰©è®¾ç½®ç‹¬ä¸€æ— äºŒçš„idå·</span></span><br><span class="line">[root@m03 /tmp]<span class="comment"># snmpwalk -c oldboykx -v 2c 192.168.13.1 sysdesc</span></span><br><span class="line">[root@m03 /tmp]<span class="comment"># snmpwalk -c oldboykx -v 2c 192.168.13.1 sysUptime</span></span><br><span class="line">DISMAN-EVENT-MIB::sysUpTimeInstance = Timeticks: (48733900) 4 days, 17:08:59.00</span><br><span class="line">[root@m03/tmp]<span class="comment">#</span></span><br><span class="line">[root@m03/tmp]<span class="comment">#</span></span><br><span class="line">[root@m03 /tmp]<span class="comment"># snmpwalk -c oldboykx -v 2c 192.168.13.1 IfNumber</span></span><br><span class="line">IF-MIB::ifNumber.0 = INTEGER:19</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>





<h4 id="4-6-zabbixå®¢æˆ·ç«¯å¸¸è§ç±»å‹"><a href="#4-6-zabbixå®¢æˆ·ç«¯å¸¸è§ç±»å‹" class="headerlink" title="4.6 zabbixå®¢æˆ·ç«¯å¸¸è§ç±»å‹"></a>4.6 zabbixå®¢æˆ·ç«¯å¸¸è§ç±»å‹</h4><table>
<thead>
<tr>
<th>zabbixå®¢æˆ·ç«¯</th>
<th>ç‰¹ç‚¹æ¦‚è¿°</th>
<th>ä¸»è¦åº”ç”¨åœºæ™¯</th>
</tr>
</thead>
<tbody><tr>
<td>Zabbix-agent2(æœ€å¸¸ç”¨)</td>
<td>é€šç”¨çš„å®¢æˆ·ç«¯ï¼Œæ”¯æŒè‡ªå®šä¹‰ç›‘æ§é…åˆå‘½ä»¤ä¸è„šæœ¬</td>
<td>ç”¨äºå‡ ä¹æ‰€æœ‰æƒ…å†µï¼Œlinux,windows,android&#x2F;ios,</td>
</tr>
<tr>
<td>SNMPå®¢æˆ·ç«¯</td>
<td>Simple Network Management Protocal  <strong>ç®€å•ç½‘ç»œç®¡ç†åè®®</strong></td>
<td><strong>ç›‘æ§ç½‘ç»œè®¾å¤‡</strong>ï¼ˆå¯ä»¥ç›‘æ§linux&#x2F;windowsâ€¦..)</td>
</tr>
<tr>
<td>JMX</td>
<td>Java-gateway ç›‘æ§java app(tomcat),<strong>æœªæ¥æ¨èè‡ªå®šä¹‰ç›‘æ§(zabbix_agents2 + jmap&#x2F;jstats)</strong></td>
<td>ç›‘æ§java app(tomcat)<br/>æ¨è<strong>è‡ªå®šä¹‰ç›‘æ§</strong></td>
</tr>
<tr>
<td>IPMI</td>
<td>ç›‘æ§ç¡¬ä»¶(ç‰©ç†æœåŠ¡å™¨,è”æƒ³(IBM X86æ¶æ„ThinkServer),åä¸º,æµªæ½®,Dell,IBM,HP)<strong>ç›´æ¥ä½¿ç”¨è‡ªå®šä¹‰ç›‘æ§(ipmitool + megacli)</strong></td>
<td>ç›‘æ§ç¡¬ä»¶<br/>åº”ç”¨æ¨èï¼šç›´æ¥ä½¿ç”¨è‡ªå®šä¹‰ç›‘æ§(ipmitool + megacli )</td>
</tr>
</tbody></table>
<h3 id="5-è‡ªåŠ¨åŒ–"><a href="#5-è‡ªåŠ¨åŒ–" class="headerlink" title="5.è‡ªåŠ¨åŒ–"></a>5.è‡ªåŠ¨åŒ–</h3><p>è‡ªåŠ¨æ·»åŠ ä¸»æœº</p>
<p>å…¬å¸æ‹¥æœ‰å¤šä¸ªæœºæˆ¿ï¼ˆåŒ—äº¬ï¼Œä¸Šæµ·ï¼Œå—æï¼‰</p>
<h4 id="5-1-è‡ªåŠ¨æ·»åŠ ä¸»æœº"><a href="#5-1-è‡ªåŠ¨æ·»åŠ ä¸»æœº" class="headerlink" title="5.1 è‡ªåŠ¨æ·»åŠ ä¸»æœº"></a>5.1 è‡ªåŠ¨æ·»åŠ ä¸»æœº</h4><p>è‡ªåŠ¨å‘ç°</p>
<p>è‡ªåŠ¨æ³¨å†Œ</p>
<table>
<thead>
<tr>
<th>è‡ªåŠ¨æ·»åŠ ç­–ç•¥</th>
<th></th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td>è‡ªåŠ¨å‘ç°</td>
<td><strong>æœåŠ¡ç«¯ä¸»åŠ¨æ‰«æ</strong>å±€åŸŸç½‘æ‰€æœ‰çš„æœºå™¨ï¼Œæœ‰æ–°çš„åˆ™æ·»åŠ </td>
<td>é…ç½®ç®€å•æ–¹ä¾¿æ•ˆç‡ä¸é«˜</td>
</tr>
<tr>
<td>è‡ªåŠ¨æ³¨å†Œ</td>
<td><strong>å®¢æˆ·ç«¯ä¸»åŠ¨</strong>å‘æœåŠ¡ç«¯æ³¨å†Œï¼ŒæœåŠ¡ç«¯åªéœ€è¦ç­‰å¾…ä¸éªŒè¯å³å¯</td>
<td>é…ç½®æœ‰ç‚¹ç‚¹å¤æ‚ï¼Œæ•ˆç‡é«˜</td>
</tr>
</tbody></table>
<h3 id="12-2-è‡ªåŠ¨å‘ç°"><a href="#12-2-è‡ªåŠ¨å‘ç°" class="headerlink" title="12.2 è‡ªåŠ¨å‘ç°"></a>12.2 è‡ªåŠ¨å‘ç°</h3><p>1ï¼‰ç¯å¢ƒå‡†å¤‡</p>
<table>
<thead>
<tr>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td>db01</td>
<td>10.0.0.51&#x2F;172.16.1.51</td>
<td>zabbixå®¢æˆ·ç«¯,serveræŒ‡å‘.72</td>
</tr>
<tr>
<td>nfs01</td>
<td>10.0.0.31&#x2F;172.16.1.31</td>
<td>zabbixå®¢æˆ·ç«¯,serveræŒ‡å‘.72</td>
</tr>
<tr>
<td>backup</td>
<td>10.0.0.41&#x2F;172.16.1.41</td>
<td>zabbixå®¢æˆ·ç«¯,serveræŒ‡å‘.72</td>
</tr>
</tbody></table>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#01.3å°æœºå™¨éƒ¨ç½²å¥½zabbixxå®¢æˆ·ç«¯</span></span><br><span class="line"><span class="comment">#02.ä¿®æ”¹Serverä¸º172.16.1.72</span></span><br><span class="line"><span class="comment">#03.å¯åŠ¨å¹¶å¼€æœºè‡ªå¯åŠ¨</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h4 id="2ï¼‰éƒ¨ç½²æµç¨‹"><a href="#2ï¼‰éƒ¨ç½²æµç¨‹" class="headerlink" title="2ï¼‰éƒ¨ç½²æµç¨‹"></a>2ï¼‰éƒ¨ç½²æµç¨‹</h4><p>:one:é…ç½®è‡ªåŠ¨å‘ç°<strong>è§„åˆ™-å‘ç°ä¸»æœº</strong></p>
<p>:two:å¯åŠ¨è‡ªåŠ¨å‘ç°<strong>åŠ¨ä½œ</strong>-å‘ç°ä¸»æœºåå…³è”æ¨¡æ¿ï¼Œæ·»åŠ ä¸»æœºï¼ŒåŠ å…¥ä¸»æœºç»„ï¼Œå¯ç”¨</p>
<p>é…ç½®<strong>è‡ªåŠ¨å‘ç°è§„åˆ™</strong></p>
<p><img src="https://images-1258700836.cos.ap-guangzhou.myqcloud.com/images/202210281032611.png" alt="image-20220926105236965"></p>
<h3 id="12-3-è‡ªåŠ¨æ³¨å†Œ"><a href="#12-3-è‡ªåŠ¨æ³¨å†Œ" class="headerlink" title="12.3 è‡ªåŠ¨æ³¨å†Œ"></a>12.3 è‡ªåŠ¨æ³¨å†Œ</h3><h4 id="1ï¼‰ç¯å¢ƒå‡†å¤‡"><a href="#1ï¼‰ç¯å¢ƒå‡†å¤‡" class="headerlink" title="1ï¼‰ç¯å¢ƒå‡†å¤‡"></a>1ï¼‰ç¯å¢ƒå‡†å¤‡</h4><p>å…³é—­è‡ªåŠ¨å‘ç° <strong>è§„åˆ™</strong></p>
<p>å…³é—­ è‡ªåŠ¨å‘ç° åŠ¨ä½œ</p>
<p>è‡ªåŠ¨å‘ç°çš„ä¸»æœº åˆ é™¤</p>
<table>
<thead>
<tr>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td>db01</td>
<td>10.0.0.51&#x2F;172.16.1.51</td>
<td>zabbixå®¢æˆ·ç«¯,serveræŒ‡å‘.72</td>
</tr>
<tr>
<td>nfs01</td>
<td>10.0.0.31&#x2F;172.16.1.31</td>
<td>zabbixå®¢æˆ·ç«¯,serveræŒ‡å‘.72</td>
</tr>
<tr>
<td>backup</td>
<td>10.0.0.41&#x2F;172.16.1.41</td>
<td>zabbixå®¢æˆ·ç«¯,serveræŒ‡å‘.72</td>
</tr>
</tbody></table>
<h4 id="2ï¼‰éƒ¨ç½²æµç¨‹-1"><a href="#2ï¼‰éƒ¨ç½²æµç¨‹-1" class="headerlink" title="2ï¼‰éƒ¨ç½²æµç¨‹"></a>2ï¼‰éƒ¨ç½²æµç¨‹</h4><p>:one:ä¿®æ”¹zabbix<strong>å®¢æˆ·ç«¯é…ç½®æ–‡ä»¶</strong>: ServerActive&#x3D;æœåŠ¡ç«¯ip å’ŒHostname&#x3D;â€¦â€¦</p>
<p>:two:webé¡µé¢ï¼Œ<strong>åŠ¨ä½œ</strong>â€“&gt;è‡ªåŠ¨æ³¨å†Œ autoregâ€¦â€¦</p>
<h5 id="a-ä¿®æ”¹å®¢æˆ·ç«¯é…ç½®æ–‡ä»¶"><a href="#a-ä¿®æ”¹å®¢æˆ·ç«¯é…ç½®æ–‡ä»¶" class="headerlink" title="a.ä¿®æ”¹å®¢æˆ·ç«¯é…ç½®æ–‡ä»¶"></a>a.ä¿®æ”¹å®¢æˆ·ç«¯é…ç½®æ–‡ä»¶</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">è‡ªåŠ¨æ³¨å†Œï¼š</span></span><br><span class="line">é…ç½®zabbix-agent</span><br><span class="line">Server=172.16.1.72</span><br><span class="line">ServerActive=172.16.1.72    #ä¸»åŠ¨æ¨¡å¼ æœåŠ¡ç«¯ipåœ°å€</span><br><span class="line">Hostname=web01    #ä¸»æœºåï¼Œç‹¬ä¸€æ— äºŒ</span><br><span class="line">HostMetadata=web01    #ä¸»æœºåçš„å…ƒæ•°æ®ï¼ˆå±æ€§ï¼‰  ä¸»æœºå  ä½¿ç”¨HostMetadataItem=system.hostname</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">Hostnameè‡ªåŠ¨è·å–</span></span><br><span class="line"></span><br><span class="line">HostnameItem=system.hostname    #è‡ªåŠ¨è·å–ä¸»æœºå è¿™ä¸ª ä¸Hostname äºŒé€‰ä¸€</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">HostMetadataè‡ªåŠ¨è·å–</span></span><br><span class="line">HostMetadataItem=system.hostname    #è‡ªåŠ¨è·å–ä¸»æœºçš„å…ƒæ•°æ®(ä¸»æœºå)  è¿™ä¸ªä¸HostMeatadata äºŒé€‰ä¸€</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">å®Œæ•´çš„ å®¢æˆ·ç«¯é…ç½®æ–‡ä»¶</span></span><br><span class="line">[root@db01 ~]# grep &#x27;^[a-Z]&#x27; /etc/zabbix/zabbix_agent2.conf</span><br><span class="line">PidFile=/var/run/zabbix/zabbix_agent2.pid</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[root@db01 ~]# grep &#x27;^Server|^Host&#x27; /etc/zabbix/zabbix_agent2.conf</span><br><span class="line">Server=172.16.1.71</span><br><span class="line">ServerActive=172.16.1.71 </span><br><span class="line">HostnameItem=system.hostname</span><br><span class="line">HostMetadataItem=system.uname</span><br><span class="line">[root@db01 ~]# systemctl restart zabbix-agent</span><br></pre></td></tr></table></figure>

<p><img src="https://images-1258700836.cos.ap-guangzhou.myqcloud.com/images/202210281032612.png" alt="image-20220926112343507"></p>
<p><img src="https://images-1258700836.cos.ap-guangzhou.myqcloud.com/images/202210281032613.png" alt="image-20220926112451330"></p>
<p><img src="https://images-1258700836.cos.ap-guangzhou.myqcloud.com/images/202210281032614.png" alt="image-20220926112520661"></p>
<h3 id="15-1-ç›®æ ‡ï¼šç›‘æ§æ•´ä¸ªç½‘ç«™æ¶æ„-å…¨æµç¨‹ï¼‰"><a href="#15-1-ç›®æ ‡ï¼šç›‘æ§æ•´ä¸ªç½‘ç«™æ¶æ„-å…¨æµç¨‹ï¼‰" class="headerlink" title="15.1 ç›®æ ‡ï¼šç›‘æ§æ•´ä¸ªç½‘ç«™æ¶æ„(å…¨æµç¨‹ï¼‰"></a>15.1 ç›®æ ‡ï¼šç›‘æ§æ•´ä¸ªç½‘ç«™æ¶æ„(å…¨æµç¨‹ï¼‰</h3><ul>
<li><p><strong>å•å°æœºå™¨</strong></p>
<ul>
<li>ä¸šåŠ¡(åº”ç”¨&#x2F;api)ä¿¡æ¯ï¼šåº”ç”¨ï¼Œç¨‹åºä»£ç æ˜¯å¦æœ‰é—®é¢˜ï¼Œï¼ˆéœ€è¦æˆ‘ä»¬ä¸å¼€å‘æ²Ÿé€šï¼Œä¹¦å†™ä¸€ä¸ªé¡µé¢ï¼‰ egï¼šlnmpçš„æ—¶å€™çš„phpä¸mysqlæµ‹è¯•é¡µé¢.</li>
<li>æœåŠ¡ä¿¡æ¯ï¼šå„ç§æœåŠ¡çŠ¶æ€ï¼Œè¿›ç¨‹ï¼Œç«¯å£ï¼ŒçŠ¶æ€ï¼Œç‰¹å®šçš„ä¿¡æ¯ï¼ˆä¸åŒæœåŠ¡ï¼‰</li>
<li>ç³»ç»Ÿä¿¡æ¯ï¼šcpu,å†…å­˜(å†…å­˜,swap,buffer&#x2F;cache),ç£ç›˜(io,ä½¿ç”¨ç‡,inode),è´Ÿè½½,ç½‘ç»œ(in&#x2F;out)â€¦â€¦</li>
<li>ç¡¬ä»¶ä¿¡æ¯ï¼šç£ç›˜ï¼ŒraidçŠ¶æ€ï¼Œæ¸©åº¦ï¼Œé£æ‰‡è½¬é€Ÿï¼Œæœºæˆ¿æ¸©åº¦ï¼Œæ¹¿åº¦</li>
</ul>
</li>
<li><p><strong>ç½‘ç«™é›†ç¾¤ç›‘æ§ï¼ˆç”¨æˆ·è®¿é—®æµç¨‹ï¼‰</strong></p>
<ul>
<li>DNSè§£æåŸŸCDNæ˜¯å¦ok  æœ¬è´¨ï¼š<strong>é€šè¿‡å…¨å±€è®¿é—®æµ‹è¯•å·¥å…·ï¼ˆæ¨¡ä»¿ç”¨æˆ·åœ¨å…¨å›½ï¼ˆå…¨çƒï¼‰å„åœ°è®¿é—®æˆ‘ä»¬çš„ç½‘ç«™ï¼‰</strong><ul>
<li>å…è´¹:<a target="_blank" rel="noopener" href="http://17ce.com/">http://17ce.com</a> <a target="_blank" rel="noopener" href="http://ping.chinaz.com/">http://ping.chinaz.com/</a>        è°ƒè¯•å·¥å…·ï¼š<a target="_blank" rel="noopener" href="http://cesule.tingyun.com/cesule/home">http://cesule.tingyun.com/cesule/home</a></li>
<li>å•†ä¸šç‰ˆï¼š<a target="_blank" rel="noopener" href="https://www.tingyun.com/">å¬äº‘</a>ï¼Œ<a target="_blank" rel="noopener" href="https://www.jiankongbao.com/">ç›‘æ§å®</a>ï¼ˆå‘Šè­¦ï¼‰</li>
</ul>
</li>
<li>TCPä¸‰æ¬¡æ¡æ‰‹-ç½‘ç«™è´Ÿè½½å‡è¡¡ç›‘æ§ ss-antï¼ˆtcpçŠ¶æ€ï¼‰</li>
<li>HITPè¯·æ±‚è±¹çº¹-ç›‘æ§webæ—¥å¿—æŸ¥çœ‹ï¼ˆçŠ¶æ€ç ï¼‰è¡¥å……ï¼šåŠ ä¸ŠHTTPSç›‘æ§è¿‡æœŸ</li>
<li>è¯·æ±‚ç»è¿‡ç½‘ç«™æ¶æ„<ul>
<li>è´Ÿè½½å‡è¡¡ï¼ˆNginxï¼‰</li>
<li>webæœåŠ¡å™¨(php,tomcat)</li>
<li>ç¼“å­˜</li>
<li>æ•°æ®åº“</li>
<li>å­˜å‚¨</li>
</ul>
</li>
<li>HTTPå“åº”æŠ¥æ–‡-ç›‘æ§webæ—¥å¿—æŸ¥çœ‹ï¼ˆçŠ¶æ€ç ï¼‰</li>
<li>TCPå››æ¬¡æŒ¥æ‰‹-ç½‘ç«™è´Ÿè½½å‡è¡¡ç›‘æ§ ss-ant</li>
<li>æ–­å¼€è¿æ¥</li>
</ul>
</li>
</ul>
<h2 id="6-æ¶æ„ç›‘æ§"><a href="#6-æ¶æ„ç›‘æ§" class="headerlink" title="6 æ¶æ„ç›‘æ§"></a>6 æ¶æ„ç›‘æ§</h2><h3 id="6-1-åŸºç¡€é¡¹ç›®"><a href="#6-1-åŸºç¡€é¡¹ç›®" class="headerlink" title="6.1 åŸºç¡€é¡¹ç›®"></a>6.1 åŸºç¡€é¡¹ç›®</h3><h3 id="6-2-è´Ÿè½½"><a href="#6-2-è´Ÿè½½" class="headerlink" title="6.2 è´Ÿè½½"></a>6.2 è´Ÿè½½</h3><p>nginx</p>
<p>tcp: <code>ss  -ant |grep -i &#39;estab&#39; |awk &#39;$3~/:80$/&#39;</code></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">[root@lb01~]# </span><span class="language-bash"><span class="built_in">cat</span> /etc/nginx/conf.d/default.conf</span></span><br><span class="line">server &#123;</span><br><span class="line">    listen     80 default_server;</span><br><span class="line">    server_name localhost;</span><br><span class="line">    location / &#123;</span><br><span class="line">      index index.html;</span><br><span class="line">    &#125;</span><br><span class="line">    location /nginx_status &#123;</span><br><span class="line">      stub_status;</span><br><span class="line">      #allow</span><br><span class="line">      #deny</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">[root@lb01 ~]# curl 10.9.0.5/nginx_status</span><br><span class="line">Active connections: 1</span><br><span class="line">server accepts handled requests</span><br><span class="line"> 2 2 2</span><br><span class="line">Reading: 0 Writing: 1 Waiting: 0</span><br><span class="line">[root@lb01 ~]#</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">è‡ªå®šä¹‰ç›‘æ§</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">zbx æ¨¡æ¿</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h3 id="4ï¼‰è¯ä¹¦æ˜¯å¦è¿‡æœŸ"><a href="#4ï¼‰è¯ä¹¦æ˜¯å¦è¿‡æœŸ" class="headerlink" title="4ï¼‰è¯ä¹¦æ˜¯å¦è¿‡æœŸ"></a>4ï¼‰è¯ä¹¦æ˜¯å¦è¿‡æœŸ</h3><p>é€šè¿‡opensslå‘½ä»¤è·å–æŸä¸€ä¸ªè¯ä¹¦çš„è¿‡æœŸæ—¶é—´</p>
<p>ä¸å½“å‰æ—¶é—´è®¡ç®—å¾—å‡ºå‰©ä½™æ—¶é—´</p>
<p>æ·»åŠ ç›‘æ§é¡¹</p>
<p>æ·»åŠ è§¦å‘å™¨</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">[root@lb01/etc/nginx/ssl_key]<span class="comment"># cat /server/scripts/check_ssl_crt.sh</span></span><br><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line"><span class="comment">#author: lidao996</span></span><br><span class="line"><span class="comment">#desc: check one ssl crt expire time</span></span><br><span class="line"><span class="comment">#descï¼šæ£€æŸ¥ httpsè¯ä¹¦è¿˜æœ‰å¤šå°‘å¤©è¿‡æœŸ</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#è·å–è¿‡æœŸæ—¶é—´</span></span><br><span class="line">last_day=`openssl x509 -<span class="keyword">in</span> /etc/nginx/ssl_key/server.crt -noout -text |awk <span class="string">&#x27;/After/&#123;gsub(/Jun/,&quot;06&quot;);print $7&quot;-&quot;$4&quot;-&quot;$5&#125;&#x27;</span>`</span><br><span class="line"></span><br><span class="line"><span class="comment">#è·å–ç§’</span></span><br><span class="line">last_day_sec=`<span class="built_in">date</span> +%s -d <span class="string">&quot;<span class="variable">$last_day</span> &quot;</span>`</span><br><span class="line">today_sec=`<span class="built_in">date</span> +%s`</span><br><span class="line"></span><br><span class="line"><span class="comment">#è¿›è¡Œè®¡ç®—</span></span><br><span class="line">awk -vlast=<span class="variable">$last_day_sec</span> -vnow=<span class="variable">$today_sec</span> <span class="string">&#x27;BEGIN&#123;print ( last - now )/60/60/24)&#x27;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h3 id="5ï¼‰ç«¯å£è¿›ç¨‹"><a href="#5ï¼‰ç«¯å£è¿›ç¨‹" class="headerlink" title="5ï¼‰ç«¯å£è¿›ç¨‹"></a>5ï¼‰ç«¯å£è¿›ç¨‹</h3><p>æ‰¾å‡ºç³»ç»Ÿå†…ç½®çš„é”®å€¼ä½¿ç”¨</p>
<p>æ·»åŠ ç›‘æ§é¡¹</p>
<p>æ·»åŠ è§¦å‘å™¨</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[root@m02 /server/files]<span class="comment"># zabbix_get -s 172.16.1.5 -k net.tcp.port[,80]</span></span><br><span class="line">1</span><br><span class="line">[root@m02 /server/files]<span class="comment"># zabbix_get -s 172.16.1.5 -k proc.num[nginx]</span></span><br><span class="line">2</span><br><span class="line"></span><br><span class="line">[root@m03 ~]<span class="comment"># zabbix_get -s lb01 -k net.tcp.port[,80]</span></span><br><span class="line">1</span><br><span class="line">[root@m03 ~]<span class="comment"># zabbix_get -s lb01 -k proc.num[]</span></span><br><span class="line">115</span><br><span class="line">[root@m03 ~]<span class="comment"># zabbix_get -s lb01 -k proc.num[nginx]</span></span><br><span class="line">2</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h3 id="6ï¼‰æŠŠåˆ›å»ºå¥½çš„ç›‘æ§é¡¹å¤åˆ¶åˆ°æ¨¡æ¿ä¸­"><a href="#6ï¼‰æŠŠåˆ›å»ºå¥½çš„ç›‘æ§é¡¹å¤åˆ¶åˆ°æ¨¡æ¿ä¸­" class="headerlink" title="6ï¼‰æŠŠåˆ›å»ºå¥½çš„ç›‘æ§é¡¹å¤åˆ¶åˆ°æ¨¡æ¿ä¸­"></a>6ï¼‰æŠŠåˆ›å»ºå¥½çš„ç›‘æ§é¡¹å¤åˆ¶åˆ°æ¨¡æ¿ä¸­</h3><p>nginxæ¨¡æ¿-æ—¥å¿—çŠ¶æ€ï¼Œè¯ä¹¦æ˜¯å¦è¿‡æœŸï¼Œç«¯å£ä¸è¿›ç¨‹</p>
<p>tcpæ¨¡æ¿-è¿æ¥çŠ¶æ€</p>
<h2 id="14-6-webæœåŠ¡å™¨"><a href="#14-6-webæœåŠ¡å™¨" class="headerlink" title="14.6 webæœåŠ¡å™¨"></a>14.6 webæœåŠ¡å™¨</h2><p>nginx  nginx_status  ç«¯å£è¿›ç¨‹</p>
<p>php  php status</p>
<p>å¯ç”¨æ€§ç›‘æ§ï¼ˆwebç›‘æ§ï¼ˆåœºæ™¯ï¼‰ï¼‰</p>
<h3 id="1ï¼‰ç›‘æ§phpçŠ¶æ€"><a href="#1ï¼‰ç›‘æ§phpçŠ¶æ€" class="headerlink" title="1ï¼‰ç›‘æ§phpçŠ¶æ€"></a>1ï¼‰ç›‘æ§phpçŠ¶æ€</h3><p>å¼€å¯ phpçŠ¶æ€æ£€æŸ¥</p>
<p>åˆ›å»ºè‡ªå®šä¹‰ç›‘æ§é¡¹-è„šæœ¬æ–¹å¼</p>
<p>åˆ›å»ºè‡ªå®šä¹‰ç›‘æ§é¡¹-ä¸»è¦é¡¹-ç›¸å…³é¡¹</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">[root@web01 /etc/nginx/conf.d]# cat default.conf</span><br><span class="line">server &#123;</span><br><span class="line">  listen 80 default_server;</span><br><span class="line">  server_name localhost;</span><br><span class="line">  root /code/default;</span><br><span class="line">  location /nginx_status &#123;</span><br><span class="line">    allow 127.0.0.1;</span><br><span class="line">    allow localhost;</span><br><span class="line">    deny all;</span><br><span class="line">    stub_status ;</span><br><span class="line">  &#125;</span><br><span class="line">  location /php_status &#123;</span><br><span class="line">    allow 127.0.0.1;</span><br><span class="line">    allow localhost;</span><br><span class="line">    deny all;</span><br><span class="line">    fastcgi_pass  127.0.0.1:9000;</span><br><span class="line">    fastcgi_index  index.php;</span><br><span class="line">    fastcgi_param  SCRIPT_FILENAME  /scripts$fastcgi_script_name;</span><br><span class="line">    include    fastcgi_params;</span><br><span class="line">  &#125;</span><br><span class="line">  location ~ \.php$ &#123;</span><br><span class="line">    fastcgi_pass  127.0.0.1:9000;</span><br><span class="line">    fastcgi_index index.php;</span><br><span class="line">    fastcgi_param  SCRIPT_FILENAME  /scripts$fastcgi_script_name;</span><br><span class="line">    include    fastcgi_params;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">[root@web01 /etc/nginx/conf.d]# vim /etc/php-fpm.d/www.conf</span><br><span class="line">pm.status_path = /php_status</span><br><span class="line">[root@web01 /etc/nginx/conf.d]# grep pm.status_path /etc/php-fpm.d/www.conf</span><br><span class="line">pm.status_path = /php_status</span><br><span class="line"></span><br><span class="line">[root@web01 /etc/nginx/conf.d]# nginx -t</span><br><span class="line">[root@web01 /etc/nginx/conf.d]# php-fpm -t</span><br><span class="line"></span><br><span class="line">[root@web01 /etc/nginx/conf.d]# systemctl reload nginx php-fpm</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[root@web01 /etc/nginx/conf.d]# curl 10.0.0.7/nginx_status</span><br><span class="line">[root@web01 /etc/nginx/conf.d]# curl 10.0.0.7/php_status</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[root@web01 /server/scripts]# sh fpm.sh &quot;total processes&quot; &quot;localhost/php_status&quot;</span><br><span class="line">5</span><br><span class="line">[root@web01 ~]# cat /etc/zabbix/zabbix_agent2.d/web.conf</span><br><span class="line">UserParameter=php.fpm[*],sh /server/scripts/fpm.sh &quot;$1&quot; &quot;$2&quot;</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">[root@m02~]#</span><span class="language-bash">zabbix_get -s 172.16.1.7 -k php.fpm[<span class="string">&quot;total processes&quot;</span>,<span class="string">&quot;localhost/php_status&quot;</span>]</span></span><br><span class="line">5</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p><img src="https://images-1258700836.cos.ap-guangzhou.myqcloud.com/images/202210281032615.png" alt="image-20220926152613349"></p>
<p>åˆ›å»º ä¸»è¦é”®</p>
<h2 id="14-8-mysql"><a href="#14-8-mysql" class="headerlink" title="14.8 mysql"></a>14.8 mysql</h2><p>percona-mysqlâ€¦â€¦</p>
<p>zabbixå†…ç½®æ¨¡æ¿ï¼šTemplate DB MySQL by Zabbix agent 2</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">phpè„šæœ¬è·å–æ•°æ®åº“æŒ‡æ ‡</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">xmlæ¨¡æ¿æ–‡ä»¶</span></span><br><span class="line"></span><br><span class="line">[root@db01 ~]# rpm -ql percona-zabbix-templates</span><br><span class="line">/var/lib/zabbix/percona</span><br><span class="line">/var/lib/zabbix/percona/scripts</span><br><span class="line">/var/lib/zabbix/percona/scripts/get_mysql_stats_wrapper.sh</span><br><span class="line">/var/lib/zabbix/percona/scripts/ss_get_mysql_stats.php</span><br><span class="line">/var/lib/zabbix/percona/templates</span><br><span class="line">/var/lib/zabbix/percona/templates/userparameter_percona_mysql.conf</span><br><span class="line">/var/lib/zabbix/percona/templates/zabbix_agent_template_percona_mysql_server_ht_2.0.9-sver1.1.8.xml</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">zabbix_get -s db01 -k get.mysql.status</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">---æ‰§è¡Œ sh get_mysql...sh</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">---æ‰§è¡Œ php ss_get_mysql...php</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">ç”Ÿäº§ç¯å¢ƒ éœ€è¦ä¸€ä¸ªå¯¹æ•°æ®åº“æœ‰åªè¯»æƒé™çš„ç”¨æˆ·å³å¯ã€‚  select,show</span></span><br><span class="line">grant select,show on *.* to zabbix@&#x27;localhost&#x27; identified by &#x27;123456&#x27;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[root@db01 ~]# vim /var/lib/zabbix/percona/scripts/ss_get_mysql_stats.php</span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash">mysql_user = <span class="string">&#x27;lidao996&#x27;</span>;</span></span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash">mysql_pass = <span class="string">&#x27;1&#x27;</span>;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[root@db01 ~]# egrep &#x27;^\$mysql_(user|pass)&#x27; /var/lib/zabbix/percona/scripts/ss_get_mysql_stats.php</span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash">mysql_user = <span class="string">&#x27;root&#x27;</span>;</span></span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash">mysql_pass = <span class="string">&#x27;123456&#x27;</span>;</span></span><br><span class="line"></span><br><span class="line">[root@db01 ~]# cp /var/lib/zabbix/percona/templates/userparameter_percona_mysql.conf /etc/zabbix/zabbix_agent2.d/</span><br><span class="line"></span><br><span class="line">[root@db01 ~]# yum install -y php php-mysqlnd</span><br><span class="line"></span><br><span class="line">[root@db01 ~]# systemctl restart zabbix-agent2</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[root@m02 ~]# zabbix_get -s 172.16.1.51 -k MySQL.State-login</span><br><span class="line">0</span><br><span class="line"></span><br><span class="line">sh /var/lib/zabbix/percona/scripts/get_mysql_stats_wrapper.sh lw</span><br><span class="line"></span><br></pre></td></tr></table></figure>





<p>1.æ¦‚è¿°</p>
<ul>
<li>ç»¼åˆæ¶æ„çš„ç›®æ ‡ï¼š<ul>
<li>æ­å»ºå¹¶ç†Ÿç»ƒæè¿°ç½‘ç«™æ¶æ„ï¼ˆé¢è¯•é¢˜ï¼šä½ å…¬å¸æ¶æ„æ˜¯ä»€ä¹ˆæ ·ï¼Ÿï¼‰åŸºç¡€æ¶æ„ï¼šåŠ¨é™åˆ†ç¦»ï¼Œå‰åç«¯åˆ†ç¦»</li>
</ul>
</li>
<li>è¿‡ç¨‹<ul>
<li>ç—›è‹¦çš„ï¼Œå¿«ä¹ç€ï¼Œæ­å»ºçš„æ—¶å€™ï¼Œåˆ†å±‚æ¬¡æ­å»ºå‡ºæ¥</li>
</ul>
</li>
<li>ç—›è‹¦çš„ï¼Œå¿«ä¹ç€ï¼Œæ­å»ºçš„æ—¶å€™ï¼Œåˆ†å±‚æ¬¡æ­å»ºå‡ºæ¥<ul>
<li>è®²æ’<ul>
<li>è®²è§£ï¼Œç†Ÿç»ƒè®²è§£ç½‘ç«™æ¶æ„æµç¨‹ï¼šç”¨æˆ·è®¿é—®ä¸ngxå¤„ç†æµç¨‹</li>
<li>æ’é”™ï¼Œè®°å½•æ€»ç»“</li>
<li>æ­å»º</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>2.åˆ†å±‚æ¬¡æ¶æ„</p>
<ul>
<li><p>ç»˜åˆ¶è‡ªå·±çš„æ¶æ„å›¾ï¼ˆçº¸ç¬”,processon)</p>
</li>
<li><p>åˆ†å±‚æ¬¡</p>
<ul>
<li>ç”¨æˆ·ï¼š<ul>
<li>æ•°æ®å±‚ï¼š:one:å¤‡ä»½  :two:å­˜å‚¨  :three:å®æ—¶åŒæ­¥  :four:æ•°æ®åº“  :five:redisç¼“å­˜â€‹</li>
<li>webå±‚ï¼š:one:web01 nginx,php,conf  :two:éƒ¨ç½²ä»£ç   ä»£ç é…ç½®ä¼ è¾“web02  :three:nginx+tomcat  é…ç½®ï¼Œéƒ¨ç½²ä»£ç   ä»£ç ä¸é…ç½®æ–‡ä»¶ä¼ è¾“åˆ°web04â€‹</li>
<li>è´Ÿè½½ï¼š:one:nginx  :two:keepalived</li>
<li>å®‰å…¨ï¼šé˜²ç«å¢™â€¦</li>
</ul>
</li>
<li>è¿ç»´<ul>
<li>:one:openvpn</li>
<li>:two:jms&#x2F;teleport</li>
<li>:three:ansibleæ‰¹é‡ç®¡ç†ï¼ˆæå‰å‡†å¤‡å¥½ï¼‰</li>
<li>:four:zbxç›‘æ§</li>
</ul>
</li>
</ul>
</li>
<li><p>ä¸€é”®éƒ¨ç½²æµç¨‹æ¨è</p>
<ul>
<li>ä¸€æ­¥ä¸€æ­¥éƒ¨ç½²æ¯ä¸ªæœåŠ¡ï¼ˆå®‰è£…è¿‡ç¨‹ï¼Œé…ç½®æ–‡ä»¶ï¼Œç›¸å…³å†…å®¹ç›®å½•ï¼Œç”¨æˆ·ï¼Œæ•°æ®åº“.â€¦ï¼‰</li>
<li>æ€è€ƒæ¯ä¸ªæœåŠ¡å¦‚ä½•ä¸€é”®éƒ¨ç½²ï¼ˆå®‰è£…ï¼ˆyumä»“åº“ï¼‰ï¼Œé…ç½®ï¼ˆåˆ†å‘é…ç½®æ–‡ä»¶ï¼‰ï¼Œå¯åŠ¨ï¼Œä»£ç éƒ¨ç½²ï¼ˆå¦‚æœéœ€è¦ï¼‰ï¼‰ï¼ˆç‹¬ç«‹æ¨¡å—&#x2F;æœåŠ¡ï¼‰</li>
<li>æœ€åè”åˆåœ¨ä¸€èµ·ä¸€é”®éƒ¨ç½²æ‰€æœ‰ï¼ˆè”è°ƒï¼‰</li>
</ul>
</li>
</ul>
<h1 id="12-6-zabbixåˆ†å¸ƒå¼ç›‘æ§proxy"><a href="#12-6-zabbixåˆ†å¸ƒå¼ç›‘æ§proxy" class="headerlink" title="12.6 zabbixåˆ†å¸ƒå¼ç›‘æ§proxy"></a>12.6 zabbixåˆ†å¸ƒå¼ç›‘æ§proxy</h1><p>åº”ç”¨åœºæ™¯ï¼šæœ‰å¤šä¸ªæœºæˆ¿&#x2F;ç½‘æ®µ&#x2F;åœ°åŸŸï¼Œè¿›è¡Œç›‘æ§.åˆ†å¸ƒå¼ç›‘æ§(proxyä»£ç†ç›‘æ§)</p>
<h1 id="15-éƒ¨ç½²å‰ç«¯é¡µé¢æç¤ºè¿æ¥æ•°æ®åº“å¤±è´¥"><a href="#15-éƒ¨ç½²å‰ç«¯é¡µé¢æç¤ºè¿æ¥æ•°æ®åº“å¤±è´¥" class="headerlink" title="15.éƒ¨ç½²å‰ç«¯é¡µé¢æç¤ºè¿æ¥æ•°æ®åº“å¤±è´¥"></a>15.éƒ¨ç½²å‰ç«¯é¡µé¢æç¤ºè¿æ¥æ•°æ®åº“å¤±è´¥</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Unsupported charset or collation <span class="keyword">for</span> tables  <span class="comment">#åˆ›å»ºæ•°æ®åº“çš„æ—¶å€™å­—ç¬¦é›†ä¸å¯¹ã€‚</span></span><br></pre></td></tr></table></figure>





<h1 id="zbx-æ•…éšœè®°å½•"><a href="#zbx-æ•…éšœè®°å½•" class="headerlink" title="zbx-æ•…éšœè®°å½•"></a>zbx-æ•…éšœè®°å½•</h1><h2 id="Unknown-metric-root-login"><a href="#Unknown-metric-root-login" class="headerlink" title="Unknown metric root.login"></a>Unknown metric root.login</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æ— æ³•è¯†åˆ«çš„ç›‘æ§é¡¹/é”®å€¼  root.login</span><br></pre></td></tr></table></figure>



<h2 id="No-module-named-requests"><a href="#No-module-named-requests" class="headerlink" title="No module named requests"></a>No module named requests</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">[root@m03-zabbix-server ~]<span class="comment"># python /usr/lib/zabbix/alertscripts/wechat.py</span></span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">  File <span class="string">&quot;/usr/lib/zabbix/alertscripts/wechat.py&quot;</span>, line 7, <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">    import requests</span><br><span class="line">ImportError: No module named requests</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#pythonæ˜¯é€šè¿‡å„ç§æ¨¡å—å®ç°ç›®æ ‡ä¸éœ€æ±‚.</span></span><br><span class="line"></span><br><span class="line">requests  <span class="comment">#å®ç°å®¢æˆ·---&gt;æœåŠ¡ç«¯å‘å‡º  httpè¯·æ±‚  curl/wget</span></span><br><span class="line"></span><br><span class="line">yum/apt</span><br><span class="line"><span class="comment">#å®‰è£…pythonæ¨¡å—</span></span><br><span class="line">yum install -y python-pip</span><br><span class="line">pip install requests -i https://mirrors.aliyun.com/pypi/simple/</span><br><span class="line"></span><br></pre></td></tr></table></figure>







<h1 id="7-åˆ†å¸ƒå¼ç›‘æ§-proxy"><a href="#7-åˆ†å¸ƒå¼ç›‘æ§-proxy" class="headerlink" title="7.åˆ†å¸ƒå¼ç›‘æ§-proxy"></a>7.åˆ†å¸ƒå¼ç›‘æ§-proxy</h1><ul>
<li>ä½¿ç”¨æµç¨‹<ul>
<li>é…ç½®zabbixæœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯</li>
<li>éƒ¨ç½²zbx_proxyä»£ç†</li>
<li>åˆ›å»ºæ•°æ®åº“ï¼Œzbx proxy</li>
<li>zbxå®¢æˆ·ç«¯é…ç½®</li>
</ul>
</li>
</ul>
<p>web01 zbx-proxyä»£ç†</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#01 å®‰è£…zbx proxy</span></span><br><span class="line">yum install -y https://mirrors.tuna.tsinghua.edu.cn/zabbix/zabbix/5.0/rhel/7/x86_64/zabbix-proxy-mysql-5.0.18-1.el7.x86_64.rpm</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>åˆ›å»ºå¯¹åº”çš„æ•°æ®åº“ï¼Œåˆå§‹åŒ–æ•°æ®åº“</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">##å¯åŠ¨æ•°æ®åº“å¹¶åˆ›å»ºæ•°æ®åº“ zabbix_proxy</span></span><br><span class="line">systemctl start mariadb</span><br><span class="line">systemctl <span class="built_in">enable</span> mariadb</span><br><span class="line">mysql -uroot -py</span><br><span class="line">&gt; create database zabbix_proxy charset utf8;</span><br><span class="line">&gt; select user,host from mysql.user</span><br><span class="line">MariaDB [(none)]&gt; grant all on zabbix_proxy.* to zabbix_proxy@<span class="string">&#x27;localhost&#x27;</span> identified by <span class="string">&#x27;1&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">##åˆå§‹åŒ–æ•°æ®åº“</span></span><br><span class="line">rpm -ql zabbix-proxy-mysql</span><br><span class="line">zcat /usr/share/doc/zabbix-proxy-mysql-5.0.18/schema.sql.gz |mysql -uroot -py zabbix_proxy</span><br><span class="line"></span><br><span class="line"><span class="comment">##æ£€æŸ¥</span></span><br><span class="line">show tables from zabbix_proxy;</span><br></pre></td></tr></table></figure>

<p>é…ç½®zbx proxyä¸zbxæœåŠ¡ç«¯</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">##zbx proxyä»£ç†|</span></span><br><span class="line">- hosts: zabbix_proxy web01</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[root@web01 ~]<span class="comment"># egrep -n &#x27;^Server|^Host|^DB&#x27; /etc/zabbix/zabbix_proxy.conf</span></span><br><span class="line">30:Server=172.16.1.71</span><br><span class="line">49:Hostname=njproxy</span><br><span class="line">162:DBHost=localhost</span><br><span class="line">173:DBName=zabbix_proxy</span><br><span class="line">188:DBUser=zabbix_proxy</span><br><span class="line">196:DBPassword=1</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">systemctl <span class="built_in">enable</span> zabbix-proxy.service</span><br><span class="line">systemctl start zabbix-proxy.service</span><br><span class="line">ss -lntup |grep zabbix</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">##zbx server</span></span><br><span class="line">- hosts:zabbix-serveræœåŠ¡ç«¯</span><br><span class="line"><span class="comment">##å‘½ä»¤è¡Œé…ç½®æ–‡ä»¶  æ£€æŸ¥  æ˜¯å¦æœ‰æ”¶é›†proxyæ•°æ®çš„è¿›ç¨‹</span></span><br><span class="line"></span><br><span class="line">vim /etc/zabbix/zabbix_server.conf</span><br><span class="line">StartProxyPollers=5</span><br><span class="line"></span><br><span class="line">grep ProxyPollers /etc/zabbix/zabbix_server.conf  <span class="comment">#é0å³å¯</span></span><br><span class="line">StartProxyPollers=5</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>zbxæœåŠ¡ç«¯   webé¡µé¢æ·»åŠ ä»£ç†</p>
<p><img src="https://images-1258700836.cos.ap-guangzhou.myqcloud.com/images/202210281032616.png" alt="image-20220926171904219"></p>
<p>å®¢æˆ·ç«¯é…ç½®ä¸webé¡µé¢ä¿®æ”¹</p>
<p>â€‹	é…ç½®æ–‡ä»¶</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@nfs01 ~]<span class="comment"># sed -i &#x27;s#172.16.1.71#172.16.1.7#g&#x27; /etc/zabbix/zabbix_agent2.conf</span></span><br><span class="line">[root@nfs01 ~]<span class="comment"># systemctl restart zabbix-agent2</span></span><br><span class="line">[root@nfs01 ~]<span class="comment"># grep ^Server /etc/zabbix/zabbix_agent2.conf</span></span><br><span class="line">Server=172.16.1.7</span><br><span class="line">ServerActive=172.16.1.7</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>â€‹	webé¡µé¢</p>
<p><img src="https://images-1258700836.cos.ap-guangzhou.myqcloud.com/images/202210281032617.png" alt="image-20220926172628679"></p>
<h2 id="7-3-å°ç»“"><a href="#7-3-å°ç»“" class="headerlink" title="7.3 å°ç»“"></a>7.3 å°ç»“</h2><p>åº”ç”¨åœºæ™¯ï¼šå¤šä¸ªæœºæˆ¿ç›‘æ§</p>
<p>ä½¿ç”¨æµç¨‹ï¼šé…ç½®ä»£ç†ï¼Œæ·»åŠ ï¼Œå¯åŠ¨ä»£ç†</p>
<p>æ•…éšœï¼šä¸ç»¿ï¼Œé‡å¯</p>
<h1 id="8-Grafanaå¢å¼ºå±•ç¤º"><a href="#8-Grafanaå¢å¼ºå±•ç¤º" class="headerlink" title="8.Grafanaå¢å¼ºå±•ç¤º"></a>8.Grafanaå¢å¼ºå±•ç¤º</h1><p>zabbix-serveréƒ¨ç½²grafana</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">wget --no-check-certificate -P /server/tools https://mirrors.tuna.tsinghua.edu.cn/grafana/yum/rpm/grafana-7.3.5-1.x86_64.rpm</span><br><span class="line">yum localinstall -y /server/tools/grafana-7.3.5-1.x86_64.rpm</span><br><span class="line">systemctl start grafana-server</span><br><span class="line">systemctl <span class="built_in">enable</span> grafana-server</span><br><span class="line">ss -lntup|grep grafana</span><br></pre></td></tr></table></figure>

<p>æµè§ˆå™¨è®¿é—®zbx.oldboylinux.cn:3000ï¼Œç”¨æˆ· adminï¼Œå¯†ç  admin</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">grafana-cli plugins list-remote |grep zabbix</span><br><span class="line"></span><br><span class="line">grafana-cli plugins install alexanderzobnin-zabbix-app</span><br><span class="line"></span><br><span class="line"><span class="built_in">du</span> -sh /var/lib/grafana/plugins/alexanderzobnin-zabbix-app/</span><br><span class="line"></span><br><span class="line">tar xf grafana-zabbix-plugin.tar.gz -C /</span><br><span class="line"></span><br><span class="line">systemctl restart grafana-server</span><br></pre></td></tr></table></figure>



<p><img src="https://images-1258700836.cos.ap-guangzhou.myqcloud.com/images/202210281032618.png" alt="image-20220926174151679"></p>
<p><img src="https://images-1258700836.cos.ap-guangzhou.myqcloud.com/images/202210281032619.png" alt="image-20221001152212470"></p>
<p><img src="https://images-1258700836.cos.ap-guangzhou.myqcloud.com/images/202210281032620.png" alt="image-20221001152632476"></p>
<h1 id="12"><a href="#12" class="headerlink" title="12"></a>12</h1><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#01.å®‰è£…zabbix-proxy</span></span><br><span class="line"><span class="comment">#rpm -ivh https://mirrors.tuna.tsinghua.edu.cn/zabbix/zabbix/5.0/rhel/7/x86_64/zabbix-release-5.0-1.el7.noarch.rpm</span></span><br><span class="line"><span class="comment">#yum install zabbix-proxy-mysql -y</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#01.ç›´æ¥å®‰è£…zabbix proxy</span></span><br><span class="line">yum install -y https://mirror.tuna.tsinghua.edu.cn/zabbix/zabbix/5.0/rhel/7/x86_64/zabbix-proxy-mysql-5.0.13-1.el7.x86_64.rpm</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#02.å®‰è£…æ•°æ®åº“</span></span><br><span class="line">yum install mariadb-server -y</span><br><span class="line">systemctl start mariadb</span><br><span class="line">systemctl <span class="built_in">enable</span> mariadb</span><br><span class="line">mysql_secure_installation    <span class="comment">#è‡ªåŠ¨åˆ é™¤ç©ºç”¨æˆ·é€‚ç”¨äºå®‰è£…æ•°æ®åº“åé©¬ä¸Šä½¿ç”¨</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">mysql&gt; create database zabbix_proxy character <span class="built_in">set</span> utf8 collate utf8_bin;</span><br><span class="line">mysql&gt; grant all privileges on zabbix_proxy.* to zabbix_proxy@localhost identified by <span class="string">&#x27;123456&#x27;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#æ‰‹åŠ¨åˆ é™¤ç©ºç”¨æˆ·ï¼Œäº‹åè¡¥æ•‘</span></span><br><span class="line">drop user <span class="string">&#x27;&#x27;</span>@localhost;</span><br><span class="line">drop user <span class="string">&#x27;&#x27;</span>@web01;</span><br><span class="line">flush privileges;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#03.å¯¼å…¥zabbixx proxyè¡¨ç»“æ„ï¼ˆæ•°æ®ï¼‰</span></span><br><span class="line">zcat /usr/share/doc/zabbix-proxy-mysql*/schema.sql.gz | mysql -uzabbix -p123456 zabbix_</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#04.é…ç½®zabbix-proxy</span></span><br><span class="line">[root@web01~]<span class="comment"># grep &#x27;^[a-Z]&#x27; /etc/zabbix/zabbix_proxy.conf</span></span><br><span class="line">Server=172.16.1.72</span><br><span class="line">Hostname=nanji_server</span><br><span class="line">LogFile=/var/log/zabbix/zabbix_proxy.log</span><br><span class="line">LogFileSize=0</span><br><span class="line">PidFile=/var/run/zabbix/zabbix_proxy.pid</span><br><span class="line">SocketDir=/var/run/zabbix</span><br><span class="line">DBHost=localhost</span><br><span class="line">DBName=zabbix_proxy</span><br><span class="line">DBUser=zabbix_proxy</span><br><span class="line">DBPassword=123456</span><br><span class="line">SNMPTrapperFile=/var/log/snmptrap/snmptrap.log</span><br><span class="line">Timeout=4</span><br><span class="line">ExternalScripts=/usr/lib/zabbix/externalscripts</span><br><span class="line">LogSlawQueries=3000</span><br><span class="line">StatsAllowedIP=127.0.0.1</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">systemctl start zabbix-proxy.service</span><br><span class="line">systemctl <span class="built_in">enable</span> zabbix-proxy.service</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#æœåŠ¡ç«¯æ—¥å¿—æŠ¥é”™</span></span><br><span class="line">32598:20218720:123124.836 cannot parse proxy data from active proxy at <span class="string">&quot;172.16.1.7&quot;</span>: proxy <span class="string">&quot;nanj1_proxy&quot;</span> not found</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#zabbix proxyæ—¥å¿—æŠ¥é”™</span></span><br><span class="line">12136:20210625:175428.425 cannot send proxy data to server at <span class="string">&quot;172.16.1.71&quot;</span>: proxy <span class="string">&quot;nanj1_server&quot;</span> not found</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#æœåŠ¡ç«¯ zabbix serveræ—¥å¿—</span></span><br><span class="line">32596:20210720:123641.116 cannot parse proxy data from active proxy at <span class="string">&quot;172.16.1.7&quot;</span>: proxy <span class="string">&quot;nanji_proxy&quot;</span> not found</span><br><span class="line"></span><br><span class="line">32598:20210720:123657.163 sending configuration data to proxy <span class="string">&quot;nanji_proxy&quot;</span> at <span class="string">&quot;172.16.1.7&quot;</span>, datalen 3662</span><br><span class="line"></span><br><span class="line"><span class="comment">#ä»£ç†æœåŠ¡  zabbix proxy æ—¥å¿—</span></span><br><span class="line">12536:20210720:123657.160 received configuration data from server at <span class="string">&quot;172.16.1.72&quot;</span>, datalen 3662</span><br></pre></td></tr></table></figure>

<p>ä¿®æ”¹å®¢æˆ·ç«¯é…ç½®æ–‡ä»¶</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#zabbix å®¢æˆ·ç«¯é…ç½®</span></span><br><span class="line">[root@db01 ~]<span class="comment"># vim /etc/zabbix/zabbix_agent2.conf</span></span><br><span class="line">[root@dbe1 ~]<span class="comment"># systemctl restart zabbix-agent2</span></span><br><span class="line">[root@db01 ~]<span class="comment">#grep Server /etc/zabbix/zabbix_agent2.conf</span></span><br><span class="line">Server=172.16.1.7</span><br><span class="line">ServerActive=172.16.1.7</span><br><span class="line">[root@db01 ~]<span class="comment">#</span></span><br></pre></td></tr></table></figure>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">æ–‡ç« ä½œè€…: </span><span class="post-copyright-info"><a href="https://mo-li001.github.io">å£¹æ‹¾é™†</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">æ–‡ç« é“¾æ¥: </span><span class="post-copyright-info"><a href="https://mo-li001.github.io/posts/43f6321c.html">https://mo-li001.github.io/posts/43f6321c.html</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">ç‰ˆæƒå£°æ˜: </span><span class="post-copyright-info">æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜æ¥è‡ª <a href="https://mo-li001.github.io" target="_blank">å£¹æ‹¾é™†</a>ï¼</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Linux/">Linux</a></div><div class="post_share"><div class="social-share" data-image="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/posts/bea64271.html"><img class="prev-cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">ä¸Šä¸€ç¯‡</div><div class="prev_info">VIM</div></div></a></div><div class="next-post pull-right"><a href="/posts/1315a465.html"><img class="next-cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">ä¸‹ä¸€ç¯‡</div><div class="next_info">rpm æ‰“åŒ…</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>ç›¸å…³æ¨è</span></div><div class="relatedPosts-list"><div><a href="/posts/9f353bc9.html" title="Devops"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-08-31</div><div class="title">Devops</div></div></a></div><div><a href="/posts/f5f9fa9b.html" title="Docker"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-08-31</div><div class="title">Docker</div></div></a></div><div><a href="/posts/34d20e28.html" title="ELK"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-08-31</div><div class="title">ELK</div></div></a></div><div><a href="/posts/8005.html" title="ELKå¿«é€Ÿéƒ¨ç½²"><img class="cover" src="https://tuchuangs.com/imgs/2022/09/18/074f3836d4f471b8.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-08-31</div><div class="title">ELKå¿«é€Ÿéƒ¨ç½²</div></div></a></div><div><a href="/posts/9bdc030a.html" title="HAproxy"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-08-31</div><div class="title">HAproxy</div></div></a></div><div><a href="/posts/a71433d.html" title="Ansible"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-08-31</div><div class="title">Ansible</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://images-1258700836.cos.ap-guangzhou.myqcloud.com/images/202209182232723.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">å£¹æ‹¾é™†</div><div class="author-info__description"></div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">69</div></a><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">4</div></a><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">5</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/mo-li001/"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>å…¬å‘Š</span></div><div class="announcement_content">ä¸ªäººç¬”è®°</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>ç›®å½•</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Zabbix"><span class="toc-text">Zabbix</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%80%E3%80%81Linux%E7%9A%84%E9%82%A3%E4%BA%9B%E7%8B%AC%E5%AD%A4%E4%B9%9D%E5%89%91%E7%BA%A7%E5%88%AB%E7%9A%84%E5%91%BD%E4%BB%A4"><span class="toc-text">ä¸€ã€Linuxçš„é‚£äº›ç‹¬å­¤ä¹å‰‘çº§åˆ«çš„å‘½ä»¤</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E5%85%AC%E5%8F%B8%E7%9B%91%E6%8E%A7%E5%A6%82%E4%BD%95%E5%81%9A%E7%9A%84"><span class="toc-text">äºŒã€å…¬å¸ç›‘æ§å¦‚ä½•åšçš„</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%89%E3%80%81%E7%9B%91%E6%8E%A7%E7%9A%84%E8%84%9A%E6%9C%AC%E6%97%B6%E4%BB%A3-%E8%BF%87%E5%8E%BB%E6%97%B6"><span class="toc-text">ä¸‰ã€ç›‘æ§çš„è„šæœ¬æ—¶ä»£-è¿‡å»æ—¶</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%9B%9B%E3%80%81%E7%9B%91%E6%8E%A7%E7%9A%84%E7%8E%B0%E4%BB%A3%E6%97%B6"><span class="toc-text">å››ã€ç›‘æ§çš„ç°ä»£æ—¶</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BA%94%E3%80%81Zabbix%E7%9B%91%E6%8E%A7%E6%9E%B6%E6%9E%84"><span class="toc-text">äº”ã€Zabbixç›‘æ§æ¶æ„</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#5-1-%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F"><span class="toc-text">5.1 ç”Ÿå‘½å‘¨æœŸ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-2-Zabbix%E7%9B%91%E6%8E%A7%E6%9E%B6%E6%9E%84"><span class="toc-text">5.2 Zabbixç›‘æ§æ¶æ„</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%85%AD%E3%80%81Zabbix%E7%94%9F%E4%BA%A7%E5%BF%AB%E9%80%9F%E5%AE%9E%E8%B7%B5%E6%8C%87%E5%8D%97"><span class="toc-text">å…­ã€Zabbixç”Ÿäº§å¿«é€Ÿå®è·µæŒ‡å—</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#6-1-%E4%B8%BB%E6%9C%BA%E8%A7%84%E5%88%92"><span class="toc-text">6.1 ä¸»æœºè§„åˆ’</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-2-%E4%BC%81%E4%B8%9AZabbix%E5%AE%89%E8%A3%85%E6%9C%80%E4%BD%B3%E5%AE%9E%E6%88%98-CentOS7"><span class="toc-text">6.2 ä¼ä¸šZabbixå®‰è£…æœ€ä½³å®æˆ˜-CentOS7</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%83%E3%80%81%E7%9B%91%E6%8E%A7%E4%B8%80%E5%8F%B0%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%BB%E6%9C%BA"><span class="toc-text">ä¸ƒã€ç›‘æ§ä¸€å°æœåŠ¡å™¨ä¸»æœº</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#7-1-Zabbix-agent-vs-agent2"><span class="toc-text">7.1 Zabbix agent vs agent2</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-2-Zabbix-Agent-2-%E7%9B%91%E6%8E%A7%E6%B5%81%E7%A8%8B"><span class="toc-text">7.2 Zabbix Agent[2]ç›‘æ§æµç¨‹</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%EF%BC%89%E8%A1%A5%E5%85%85-zabbix%E6%9C%8D%E5%8A%A1%E7%AB%AF%E4%B8%8E%E5%AE%A2%E6%88%B7%E7%AB%AF%E9%85%8D%E7%BD%AE%E8%AF%A6%E8%A7%A3"><span class="toc-text">1ï¼‰è¡¥å……:zabbixæœåŠ¡ç«¯ä¸å®¢æˆ·ç«¯é…ç½®è¯¦è§£</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%EF%BC%89%E7%9B%91%E6%8E%A7%E5%AE%A2%E6%88%B7%E7%AB%AF"><span class="toc-text">2ï¼‰ç›‘æ§å®¢æˆ·ç«¯</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-3-%E6%97%A5%E5%B8%B8%E6%9F%A5%E7%9C%8B%E6%95%B0%E6%8D%AE"><span class="toc-text">7.3 æ—¥å¸¸æŸ¥çœ‹æ•°æ®</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-4-Zabbix%E4%B8%AD%E6%96%87%E4%B9%B1%E7%A0%81%E9%97%AE%E9%A2%98"><span class="toc-text">7.4 Zabbixä¸­æ–‡ä¹±ç é—®é¢˜</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%85%AB%E3%80%81%E8%87%AA%E5%AE%9A%E4%B9%89%E7%9B%91%E6%8E%A7%E9%82%A3%E7%82%B9%E4%BA%8B"><span class="toc-text">å…«ã€è‡ªå®šä¹‰ç›‘æ§é‚£ç‚¹äº‹</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#8-1-%E8%87%AA%E5%AE%9A%E4%B9%89%E7%9B%91%E6%8E%A7%E6%A6%82%E8%BF%B0"><span class="toc-text">8.1 è‡ªå®šä¹‰ç›‘æ§æ¦‚è¿°</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-2-%E8%87%AA%E5%AE%9A%E4%B9%89%E7%9B%91%E6%8E%A7%E9%A1%B9%E6%B5%81%E7%A8%8B"><span class="toc-text">8.2 è‡ªå®šä¹‰ç›‘æ§é¡¹æµç¨‹</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#zbx-%E8%87%AA%E5%AE%9A%E4%B9%89%E7%9B%91%E6%8E%A7"><span class="toc-text">zbx-è‡ªå®šä¹‰ç›‘æ§</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E9%9C%80%E6%B1%82%EF%BC%9A%E6%A3%80%E6%9F%A5%E5%BD%93%E5%89%8D%E6%9C%BA%E5%99%A8%E6%98%AF%E5%90%A6root%E8%BF%9C%E7%A8%8B%E7%99%BB%E5%BD%95"><span class="toc-text">1.éœ€æ±‚ï¼šæ£€æŸ¥å½“å‰æœºå™¨æ˜¯å¦rootè¿œç¨‹ç™»å½•</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-1-Linux%EF%BC%9A%E5%91%BD%E4%BB%A4"><span class="toc-text">1.1 Linuxï¼šå‘½ä»¤</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-2-Linux%EF%BC%9A%E5%88%9B%E5%BB%BA%E9%94%AE%E5%80%BC-zbx-server%E8%AF%86%E5%88%AB%EF%BC%89"><span class="toc-text">1.2 Linuxï¼šåˆ›å»ºé”®å€¼(zbx-serverè¯†åˆ«ï¼‰</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-3-Linux%EF%BC%9A%E6%B5%8B%E8%AF%95-zbx-%E6%9C%8D%E5%8A%A1%E7%AB%AF"><span class="toc-text">1.3 Linuxï¼šæµ‹è¯•-zbx-æœåŠ¡ç«¯</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-4-web%EF%BC%9A%E5%88%9B%E5%BB%BA%E7%9B%91%E6%8E%A7%E9%A1%B9"><span class="toc-text">1.4 webï¼šåˆ›å»ºç›‘æ§é¡¹</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-5-web%EF%BC%9A%E5%88%9B%E5%BB%BA%E8%A7%A6%E5%8F%91%E5%99%A8"><span class="toc-text">1.5 webï¼šåˆ›å»ºè§¦å‘å™¨</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-6-web%EF%BC%9A%E5%88%9B%E5%BB%BA%E5%9B%BE%E5%BD%A2"><span class="toc-text">1.6 webï¼šåˆ›å»ºå›¾å½¢</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%88%9B%E5%BB%BA%E6%A8%A1%E6%9D%BF%EF%BC%9A%E6%B7%BB%E5%8A%A0%E7%9B%91%E6%8E%A7%E9%A1%B9%EF%BC%8C%E8%A7%A6%E5%8F%91%E5%99%A8%EF%BC%8C%E5%9B%BE%E5%BD%A2"><span class="toc-text">2.åˆ›å»ºæ¨¡æ¿ï¼šæ·»åŠ ç›‘æ§é¡¹ï¼Œè§¦å‘å™¨ï¼Œå›¾å½¢</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-1-%E5%88%9B%E5%BB%BA%E6%A8%A1%E6%9D%BF"><span class="toc-text">2.1 åˆ›å»ºæ¨¡æ¿</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-2-%E6%A8%A1%E6%9D%BF%E5%85%B3%E8%81%94%E4%B8%BB%E6%9C%BA"><span class="toc-text">2.2 æ¨¡æ¿å…³è”ä¸»æœº</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6"><span class="toc-text">3 ç›‘æ§å‘Šè­¦</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#zbx-%E5%85%A8%E7%BD%91%E5%85%A8%E9%93%BE%E8%B7%AF-x2F-%E5%85%A8%E6%B5%81%E7%A8%8B%E7%9B%91%E6%8E%A7-%E6%9E%B6%E6%9E%84"><span class="toc-text">zbx-å…¨ç½‘å…¨é“¾è·¯&#x2F;å…¨æµç¨‹ç›‘æ§-æ¶æ„</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B9%9D%E3%80%81%E7%9B%91%E6%8E%A7%E6%8A%A5%E8%AD%A6"><span class="toc-text">ä¹ã€ç›‘æ§æŠ¥è­¦</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#9-1-%E5%91%8A%E8%AD%A6%E5%88%86%E7%B1%BB"><span class="toc-text">9.1 å‘Šè­¦åˆ†ç±»</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-2-%E9%82%AE%E4%BB%B6%E6%8A%A5%E8%AD%A6"><span class="toc-text">9.2 é‚®ä»¶æŠ¥è­¦</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%EF%BC%89%E5%85%A8%E6%B5%81%E7%A8%8B"><span class="toc-text">1ï¼‰å…¨æµç¨‹</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%EF%BC%89%E4%B8%AA%E4%BA%BA%E9%82%AE%E7%AE%B1%E5%87%86%E5%A4%87%EF%BC%88%E7%95%A5%EF%BC%89"><span class="toc-text">2ï¼‰ä¸ªäººé‚®ç®±å‡†å¤‡ï¼ˆç•¥ï¼‰</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3%EF%BC%89%E9%85%8D%E7%BD%AE%E5%8F%91%E4%BB%B6%E4%BA%BA"><span class="toc-text">3ï¼‰é…ç½®å‘ä»¶äºº</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-3-%E5%BE%AE%E4%BF%A1%E6%8A%A5%E8%AD%A6"><span class="toc-text">9.3 å¾®ä¿¡æŠ¥è­¦</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%EF%BC%89%E5%85%A8%E6%B5%81%E7%A8%8B-1"><span class="toc-text">1ï¼‰å…¨æµç¨‹</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%EF%BC%89%E5%87%86%E5%A4%87%E7%8E%AF%E5%A2%83-1-3"><span class="toc-text">2ï¼‰å‡†å¤‡ç¯å¢ƒ 1-3</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3%EF%BC%89%E9%85%8D%E7%BD%AE%E5%8F%91%E4%BB%B6%E4%BA%BA-1"><span class="toc-text">3ï¼‰é…ç½®å‘ä»¶äºº</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%8D%81%E3%80%81%E6%8D%A2%E4%B8%AA%E8%A7%92%E5%BA%A6%E7%9C%8B%E7%9B%91%E6%8E%A7-zabbiz-agent"><span class="toc-text">åã€æ¢ä¸ªè§’åº¦çœ‹ç›‘æ§-zabbiz-agent</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#10-1-Zabbix%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%A6%82%E8%BF%B0"><span class="toc-text">10.1 Zabbixå®¢æˆ·ç«¯æ¦‚è¿°</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#10-2-Zabbix-agent2-%E7%9B%91%E6%8E%A7-windows"><span class="toc-text">10.2 Zabbix_agent2 ç›‘æ§ windows</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#10-3-snmp%E7%9B%91%E6%8E%A7%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87"><span class="toc-text">10.3 snmpç›‘æ§ç½‘ç»œè®¾å¤‡</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%EF%BC%89%E7%9B%91%E6%8E%A7%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87"><span class="toc-text">1ï¼‰ç›‘æ§ç½‘ç»œè®¾å¤‡</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#a-%E5%90%AF%E5%8A%A8snmp"><span class="toc-text">a.å¯åŠ¨snmp</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-6-zabbix%E5%AE%A2%E6%88%B7%E7%AB%AF%E5%B8%B8%E8%A7%81%E7%B1%BB%E5%9E%8B"><span class="toc-text">4.6 zabbixå®¢æˆ·ç«¯å¸¸è§ç±»å‹</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-%E8%87%AA%E5%8A%A8%E5%8C%96"><span class="toc-text">5.è‡ªåŠ¨åŒ–</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#5-1-%E8%87%AA%E5%8A%A8%E6%B7%BB%E5%8A%A0%E4%B8%BB%E6%9C%BA"><span class="toc-text">5.1 è‡ªåŠ¨æ·»åŠ ä¸»æœº</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#12-2-%E8%87%AA%E5%8A%A8%E5%8F%91%E7%8E%B0"><span class="toc-text">12.2 è‡ªåŠ¨å‘ç°</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2%EF%BC%89%E9%83%A8%E7%BD%B2%E6%B5%81%E7%A8%8B"><span class="toc-text">2ï¼‰éƒ¨ç½²æµç¨‹</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#12-3-%E8%87%AA%E5%8A%A8%E6%B3%A8%E5%86%8C"><span class="toc-text">12.3 è‡ªåŠ¨æ³¨å†Œ</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1%EF%BC%89%E7%8E%AF%E5%A2%83%E5%87%86%E5%A4%87"><span class="toc-text">1ï¼‰ç¯å¢ƒå‡†å¤‡</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2%EF%BC%89%E9%83%A8%E7%BD%B2%E6%B5%81%E7%A8%8B-1"><span class="toc-text">2ï¼‰éƒ¨ç½²æµç¨‹</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#a-%E4%BF%AE%E6%94%B9%E5%AE%A2%E6%88%B7%E7%AB%AF%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="toc-text">a.ä¿®æ”¹å®¢æˆ·ç«¯é…ç½®æ–‡ä»¶</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#15-1-%E7%9B%AE%E6%A0%87%EF%BC%9A%E7%9B%91%E6%8E%A7%E6%95%B4%E4%B8%AA%E7%BD%91%E7%AB%99%E6%9E%B6%E6%9E%84-%E5%85%A8%E6%B5%81%E7%A8%8B%EF%BC%89"><span class="toc-text">15.1 ç›®æ ‡ï¼šç›‘æ§æ•´ä¸ªç½‘ç«™æ¶æ„(å…¨æµç¨‹ï¼‰</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-%E6%9E%B6%E6%9E%84%E7%9B%91%E6%8E%A7"><span class="toc-text">6 æ¶æ„ç›‘æ§</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#6-1-%E5%9F%BA%E7%A1%80%E9%A1%B9%E7%9B%AE"><span class="toc-text">6.1 åŸºç¡€é¡¹ç›®</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-2-%E8%B4%9F%E8%BD%BD"><span class="toc-text">6.2 è´Ÿè½½</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4%EF%BC%89%E8%AF%81%E4%B9%A6%E6%98%AF%E5%90%A6%E8%BF%87%E6%9C%9F"><span class="toc-text">4ï¼‰è¯ä¹¦æ˜¯å¦è¿‡æœŸ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5%EF%BC%89%E7%AB%AF%E5%8F%A3%E8%BF%9B%E7%A8%8B"><span class="toc-text">5ï¼‰ç«¯å£è¿›ç¨‹</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6%EF%BC%89%E6%8A%8A%E5%88%9B%E5%BB%BA%E5%A5%BD%E7%9A%84%E7%9B%91%E6%8E%A7%E9%A1%B9%E5%A4%8D%E5%88%B6%E5%88%B0%E6%A8%A1%E6%9D%BF%E4%B8%AD"><span class="toc-text">6ï¼‰æŠŠåˆ›å»ºå¥½çš„ç›‘æ§é¡¹å¤åˆ¶åˆ°æ¨¡æ¿ä¸­</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#14-6-web%E6%9C%8D%E5%8A%A1%E5%99%A8"><span class="toc-text">14.6 webæœåŠ¡å™¨</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%EF%BC%89%E7%9B%91%E6%8E%A7php%E7%8A%B6%E6%80%81"><span class="toc-text">1ï¼‰ç›‘æ§phpçŠ¶æ€</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#14-8-mysql"><span class="toc-text">14.8 mysql</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#12-6-zabbix%E5%88%86%E5%B8%83%E5%BC%8F%E7%9B%91%E6%8E%A7proxy"><span class="toc-text">12.6 zabbixåˆ†å¸ƒå¼ç›‘æ§proxy</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#15-%E9%83%A8%E7%BD%B2%E5%89%8D%E7%AB%AF%E9%A1%B5%E9%9D%A2%E6%8F%90%E7%A4%BA%E8%BF%9E%E6%8E%A5%E6%95%B0%E6%8D%AE%E5%BA%93%E5%A4%B1%E8%B4%A5"><span class="toc-text">15.éƒ¨ç½²å‰ç«¯é¡µé¢æç¤ºè¿æ¥æ•°æ®åº“å¤±è´¥</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#zbx-%E6%95%85%E9%9A%9C%E8%AE%B0%E5%BD%95"><span class="toc-text">zbx-æ•…éšœè®°å½•</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Unknown-metric-root-login"><span class="toc-text">Unknown metric root.login</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#No-module-named-requests"><span class="toc-text">No module named requests</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#7-%E5%88%86%E5%B8%83%E5%BC%8F%E7%9B%91%E6%8E%A7-proxy"><span class="toc-text">7.åˆ†å¸ƒå¼ç›‘æ§-proxy</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#7-3-%E5%B0%8F%E7%BB%93"><span class="toc-text">7.3 å°ç»“</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#8-Grafana%E5%A2%9E%E5%BC%BA%E5%B1%95%E7%A4%BA"><span class="toc-text">8.Grafanaå¢å¼ºå±•ç¤º</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#12"><span class="toc-text">12</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>æœ€æ–°æ–‡ç« </span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/posts/c35a7f86.html" title="è„šæœ¬æš‚å­˜">è„šæœ¬æš‚å­˜</a><time datetime="2023-02-03T12:41:14.000Z" title="å‘è¡¨äº 2023-02-03 20:41:14">2023-02-03</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/posts/90f47a19.html" title="è‡ªåŠ¨åŒ–è£…æœº">è‡ªåŠ¨åŒ–è£…æœº</a><time datetime="2023-02-02T12:41:14.000Z" title="å‘è¡¨äº 2023-02-02 20:41:14">2023-02-02</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/posts/64202.html" title="linux">linux</a><time datetime="2023-02-02T12:41:14.000Z" title="å‘è¡¨äº 2023-02-02 20:41:14">2023-02-02</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/posts/8fb4d8df.html" title="zabbix">zabbix</a><time datetime="2023-02-02T01:43:57.000Z" title="å‘è¡¨äº 2023-02-02 09:43:57">2023-02-02</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/posts/8d6735b8.html" title="è¶…ç»å…¸SQLç»ƒä¹ é¢˜ï¼Œåšå®Œè¿™äº›ä½ çš„ï¼³ï¼±ï¼¬å°±è¿‡å…³äº†">è¶…ç»å…¸SQLç»ƒä¹ é¢˜ï¼Œåšå®Œè¿™äº›ä½ çš„ï¼³ï¼±ï¼¬å°±è¿‡å…³äº†</a><time datetime="2023-02-02T01:43:57.000Z" title="å‘è¡¨äº 2023-02-02 09:43:57">2023-02-02</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2023 By å£¹æ‹¾é™†</div><div class="framework-info"><span>æ¡†æ¶ </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>ä¸»é¢˜ </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="é˜…è¯»æ¨¡å¼"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="æµ…è‰²å’Œæ·±è‰²æ¨¡å¼è½¬æ¢"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="å•æ å’ŒåŒæ åˆ‡æ¢"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="è®¾ç½®"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="ç›®å½•"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="å›åˆ°é¡¶éƒ¨"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">æœç´¢</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  æ•°æ®åº“åŠ è½½ä¸­</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="æœç´¢æ–‡ç« " type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>