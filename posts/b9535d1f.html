<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>Mysql入门到高级 | 壹拾陆</title><meta name="keywords" content="Linux"><meta name="author" content="壹拾陆"><meta name="copyright" content="壹拾陆"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="Mysql入门到高级第03章基本的SELECT语句1. SQL的分类DDL：数据定义语言。CREATE ALTER \ DROP \ RENAME \ TRUNCATE DML：数据操作语言。INSERT \ DELETE \ UPDATE \ SELECT DCL：数据控制语言。COMMIT \ ROLLBACK \ SAVEPOINT \ GRANT \ REVOKE 学习技巧：大处着眼、小处">
<meta property="og:type" content="article">
<meta property="og:title" content="Mysql入门到高级">
<meta property="og:url" content="https://mo-li001.github.io/posts/b9535d1f.html">
<meta property="og:site_name" content="壹拾陆">
<meta property="og:description" content="Mysql入门到高级第03章基本的SELECT语句1. SQL的分类DDL：数据定义语言。CREATE ALTER \ DROP \ RENAME \ TRUNCATE DML：数据操作语言。INSERT \ DELETE \ UPDATE \ SELECT DCL：数据控制语言。COMMIT \ ROLLBACK \ SAVEPOINT \ GRANT \ REVOKE 学习技巧：大处着眼、小处">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2022-08-31T12:41:14.000Z">
<meta property="article:modified_time" content="2022-12-07T05:56:21.359Z">
<meta property="article:author" content="壹拾陆">
<meta property="article:tag" content="Linux">
<meta name="twitter:card" content="summary"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://mo-li001.github.io/posts/b9535d1f"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Mysql入门到高级',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2022-12-07 13:56:21'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="/css/custom.css" media="defer" onload="this.media='all'"><meta name="generator" content="Hexo 6.3.0"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://images-1258700836.cos.ap-guangzhou.myqcloud.com/images/202209182232723.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">68</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">4</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">5</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">壹拾陆</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Mysql入门到高级</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-08-31T12:41:14.000Z" title="发表于 2022-08-31 20:41:14">2022-08-31</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2022-12-07T05:56:21.359Z" title="更新于 2022-12-07 13:56:21">2022-12-07</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E7%AC%94%E8%AE%B0/">笔记</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="Mysql入门到高级"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="Mysql入门到高级"><a href="#Mysql入门到高级" class="headerlink" title="Mysql入门到高级"></a><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV17A4y197yK?p=12&vd_source=629395ac7befa1625191c3f496068941">Mysql入门到高级</a></h1><h2 id="第03章基本的SELECT语句"><a href="#第03章基本的SELECT语句" class="headerlink" title="第03章基本的SELECT语句"></a>第03章基本的SELECT语句</h2><h3 id="1-SQL的分类"><a href="#1-SQL的分类" class="headerlink" title="1. SQL的分类"></a>1. SQL的分类</h3><p>DDL：数据定义语言。CREATE ALTER \ DROP \ RENAME \ TRUNCATE</p>
<p>DML：数据操作语言。INSERT \ DELETE \ UPDATE \ SELECT</p>
<p>DCL：数据控制语言。COMMIT \ ROLLBACK \ SAVEPOINT \ GRANT \ REVOKE</p>
<p>学习技巧：大处着眼、小处着手。</p>
<h3 id="2-1-SQL的规则-—-必须要遵守"><a href="#2-1-SQL的规则-—-必须要遵守" class="headerlink" title="2.1 SQL的规则 —-必须要遵守"></a>2.1 SQL的规则 —-必须要遵守</h3><p>SQL可以写在一行或者多行。为了提高可读性，各子句分行写，必要时使用缩进</p>
<p>每条命令以 ; 或 \g 或 \G 结束</p>
<p>关键字不能被缩写也不能分行</p>
<p>关于标点符号</p>
<p>​	必须保证所有的()、单引号、双引号是成对结束的</p>
<p>​	必须使用英文状态下的半角输入方式</p>
<p>​	字符串型和日期时间类型的数据可以使用单引号（’ ‘）表示</p>
<p>​	列的别名，尽量使用双引号（””）而且不建议省略as</p>
<h3 id="2-2-SQL的规范-—-建议遵守"><a href="#2-2-SQL的规范-—-建议遵守" class="headerlink" title="2.2 SQL的规范 —-建议遵守"></a>2.2 SQL的规范 —-建议遵守</h3><p>MySQL 在 Windows 环境下是大小写不敏感的</p>
<p>MySQL 在 Linux 环境下是大小写敏感的</p>
<p>​	数据库名、表名、表的别名、变量名是严格区分大小写的</p>
<p>​	关键字、函数名、列名（或字段名）、列的别名（字段的别名）是忽略大小写的</p>
<p>推荐采用统一的书写规范：</p>
<p>​	数据库名、表名、表别名、字段名、字段别名等都小写</p>
<p>​	SQL关键字、函数名、绑定变量等都大写</p>
<h3 id="3-MySQL的三种注释的方式"><a href="#3-MySQL的三种注释的方式" class="headerlink" title="3. MySQL的三种注释的方式"></a>3. MySQL的三种注释的方式</h3><h3 id="4-导入现有的数据表、表的数据"><a href="#4-导入现有的数据表、表的数据" class="headerlink" title="4. 导入现有的数据表、表的数据"></a>4. 导入现有的数据表、表的数据</h3><p>方式1：source 文件的全路径名</p>
<p>举例：source d:\atguigudb.sql;</p>
<p>方式2：基于具体的图形化界面的工具可以导入数据</p>
<p>比如：SQLyog中选择“工具” – “执行sql脚本” – 选中 xxx.sql即可。</p>
<p>5.最基本的SELECT语句：SELETC 字段1，字段2，… FROM 表名</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="number">1</span> <span class="operator">+</span> <span class="number">1</span>,<span class="number">3</span> <span class="operator">*</span> <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="number">1</span> <span class="operator">+</span> <span class="number">1</span>,<span class="number">3</span> <span class="operator">*</span> <span class="number">2</span></span><br><span class="line"><span class="keyword">from</span> dual; <span class="comment">--dual: 伪表</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- *:表中的所有的字段(或列)</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> employees;</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> employee_id,last_name,salary</span><br><span class="line"><span class="keyword">from</span> employees;</span><br></pre></td></tr></table></figure>



<p>6.列的别名</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- as:全称: alias(别名),可以省略</span></span><br><span class="line"><span class="comment">-- 列的别名可以使用一对&quot;&quot;引起来。不要使用&#x27;&#x27;。</span></span><br><span class="line"><span class="keyword">select</span> employee_id emp_id,last_name <span class="keyword">as</span> lname,department_id &quot;部门id&quot;,salary <span class="operator">*</span> <span class="number">12</span> <span class="keyword">as</span> &quot;annual sal&quot;</span><br><span class="line"><span class="keyword">from</span> employees;</span><br></pre></td></tr></table></figure>



<p>7.去除重复行</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 查询员工表中一共有哪些部门id呢?</span></span><br><span class="line"><span class="keyword">select</span> department_id</span><br><span class="line"><span class="keyword">from</span> employees;</span><br><span class="line"><span class="comment">-- 正确的:去重的情况</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">distinct</span> department_id</span><br><span class="line"><span class="keyword">from</span> employees;</span><br><span class="line"><span class="comment">-- 错误的:</span></span><br><span class="line"><span class="keyword">select</span> salary,<span class="keyword">distinct</span> department_id</span><br><span class="line"><span class="keyword">from</span> employees;</span><br><span class="line"><span class="comment">-- 仅仅是没有报错，但是没有实际意义。</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">distinct</span> department_id,salary</span><br><span class="line"><span class="keyword">from</span> employees;</span><br></pre></td></tr></table></figure>



<p>8.空值参与运算</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 1.空值: null</span></span><br><span class="line"><span class="comment">-- 2.null不等同于0,&#x27;&#x27;,&#x27;null&#x27;</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> employees;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 3.空值参与运算: 结果一定也为空.</span></span><br><span class="line"><span class="keyword">select</span> employee_id,salary &quot;月工资&quot;,salary <span class="operator">*</span> (<span class="number">1</span> <span class="operator">+</span> commission_pct) <span class="operator">*</span> <span class="number">12</span> &quot;年工资&quot;,commission_pct</span><br><span class="line"><span class="keyword">from</span> employees;</span><br><span class="line"><span class="comment">-- 实际问题的解决方案: 引入ifnull</span></span><br><span class="line"><span class="keyword">select</span> employee_id,salary &quot;月工资&quot;,salary <span class="operator">*</span> (<span class="number">1</span> <span class="operator">+</span> ifnull(commission_pct,<span class="number">0</span>)) <span class="operator">*</span> <span class="number">12</span> &quot;年工资&quot;,commission_pct</span><br><span class="line"><span class="keyword">from</span> employees;</span><br></pre></td></tr></table></figure>



<p>9.着重号&#96;&#96;</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> `<span class="keyword">order</span>`;</span><br></pre></td></tr></table></figure>



<p>10.查询常数</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="string">&#x27;尚硅谷&#x27;</span>,<span class="number">123</span>,employee_id,last_name</span><br><span class="line"><span class="keyword">from</span> employoyees;</span><br></pre></td></tr></table></figure>



<p>11.显示表结构</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">describe</span> emloyees;</span><br></pre></td></tr></table></figure>



<p>12.过滤数据</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 练习: 查询90号部门的员工信息</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">from</span> employees</span><br><span class="line"><span class="comment">-- 过滤条件</span></span><br><span class="line"><span class="keyword">where</span> department_id <span class="operator">=</span> <span class="number">90</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 练习: 查询last_name为&#x27;King&#x27;的员工信息</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">from</span> employees</span><br><span class="line"><span class="keyword">where</span> last_name <span class="operator">=</span> <span class="string">&#x27;King&#x27;</span>;</span><br></pre></td></tr></table></figure>





<h3 id="第03章-基本的SELECT语句的课后练习"><a href="#第03章-基本的SELECT语句的课后练习" class="headerlink" title="第03章 基本的SELECT语句的课后练习"></a>第03章 基本的SELECT语句的课后练习</h3><p>1.查询员工12个月的工资总和，并起别名为ANNUAL SALARY</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 理解1: 计算12月的基本工资</span></span><br><span class="line"><span class="keyword">select</span> employee_id,last_name,salary <span class="operator">*</span> <span class="number">12</span> &quot;ANNUAL SALARY&quot;</span><br><span class="line"><span class="keyword">from</span> employees;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 理解2: 计算12月的基本工资和奖金</span></span><br><span class="line"><span class="keyword">select</span> employee_id,last_name,salary <span class="operator">*</span> <span class="number">12</span> <span class="operator">*</span> (<span class="number">1</span> <span class="operator">+</span> ifnull(commission_pct,<span class="number">0</span>)) &quot;ANNUAL SALARY&quot;</span><br><span class="line"><span class="keyword">from</span> employees;</span><br></pre></td></tr></table></figure>



<p>2.查询employees表中去除重复的job_id以后的数据</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">distinct</span> job_id</span><br><span class="line"><span class="keyword">from</span> employees;</span><br></pre></td></tr></table></figure>



<p>3.查询工资大于12000的员工姓名和工资</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> last_name,salary</span><br><span class="line"><span class="keyword">from</span> employees</span><br><span class="line"><span class="keyword">where</span> salary <span class="operator">&gt;</span> <span class="number">12000</span>;</span><br></pre></td></tr></table></figure>



<p>4.查询员工号为176的员工的姓名和部门号</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> last_name,department_id</span><br><span class="line"><span class="keyword">from</span> employees</span><br><span class="line"><span class="keyword">where</span> employee_id <span class="operator">=</span> <span class="number">176</span>;</span><br></pre></td></tr></table></figure>



<p>5.显示表 departments 的结构，并查询其中的全部数据</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">describe</span> departments;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> departments;</span><br></pre></td></tr></table></figure>





<h3 id="第04章-运算符"><a href="#第04章-运算符" class="headerlink" title="第04章 运算符"></a>第04章 运算符</h3><p>1.算术运算符：<code>+ - * / div % mod</code></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="number">100</span>, <span class="number">100</span> <span class="operator">+</span> <span class="number">0</span>, <span class="number">100</span><span class="operator">-</span> <span class="number">0</span>, <span class="number">100</span> <span class="operator">+</span> <span class="number">50</span>, <span class="number">100</span> <span class="operator">+</span> <span class="number">50</span> <span class="operator">*</span> <span class="number">30</span>, <span class="number">100</span> <span class="operator">+</span> <span class="number">35.5</span>, <span class="number">100</span> <span class="operator">-</span> <span class="number">35.5</span></span><br><span class="line"><span class="keyword">FROM</span> DUAL;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 在SQL中，+没有连接的作用，就表示加法运算。此时，会将字符串转换为数值N(隐式转换)</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="number">100</span> <span class="operator">+</span> <span class="string">&#x27;1&#x27;</span> <span class="comment">--在Java语言中，结果是：1001。</span></span><br><span class="line"><span class="keyword">FROM</span> DUAL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="number">100</span> <span class="operator">+</span> <span class="string">&#x27;a&#x27;</span>  <span class="comment">--此时将&#x27;a&#x27;看做0处理</span></span><br><span class="line"><span class="keyword">FROM</span> DUAL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="number">100</span> <span class="operator">+</span> <span class="keyword">NULL</span>  <span class="comment">--null值参与运算，结果为null</span></span><br><span class="line"><span class="keyword">FROM</span> DUAL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="number">100</span>, <span class="number">100</span> <span class="operator">*</span> <span class="number">1</span>, <span class="number">100</span> <span class="operator">*</span> <span class="number">1.0</span>, <span class="number">100</span> <span class="operator">/</span> <span class="number">1.0</span>, <span class="number">100</span> <span class="operator">/</span> <span class="number">2</span>,</span><br><span class="line"><span class="number">100</span> <span class="operator">+</span> <span class="number">2</span> <span class="operator">*</span> <span class="number">5</span> <span class="operator">/</span> <span class="number">2</span>,<span class="number">100</span> <span class="operator">/</span><span class="number">3</span>, <span class="number">100</span> DIV <span class="number">0</span>  <span class="comment">--分母如果为0,则结果为null</span></span><br><span class="line"><span class="keyword">FROM</span> DUAL;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 取模运算: % mod</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="number">12</span> <span class="operator">%</span> <span class="number">3</span>,<span class="number">12</span> <span class="operator">%</span> <span class="number">5</span>, <span class="number">12</span> MOD <span class="number">-5</span>,<span class="number">-12</span> <span class="operator">%</span> <span class="number">5</span>,<span class="number">-12</span> <span class="operator">%</span> <span class="number">-5</span></span><br><span class="line"><span class="keyword">FROM</span> DUAL;</span><br><span class="line"></span><br><span class="line"><span class="comment">--练习：查询员工id为偶数的员工信息</span></span><br><span class="line"><span class="keyword">SELECT</span> employee_id,last_name,salary</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">WHERE</span> employee_id <span class="operator">%</span> <span class="number">2</span> <span class="operator">=</span> <span class="number">0</span>;</span><br></pre></td></tr></table></figure>



<p>2.比较运算符</p>
<p>2.1 <code>= &lt;=&gt; &lt;&gt; != &lt; &lt;= &gt; &gt;=</code> </p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- = 的使用</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="number">1</span> <span class="operator">=</span> <span class="number">2</span>,<span class="number">1</span> <span class="operator">!=</span> <span class="number">2</span>,<span class="number">1</span> <span class="operator">=</span> <span class="string">&#x27;1&#x27;</span>,<span class="number">1</span> <span class="operator">=</span> <span class="string">&#x27;a&#x27;</span>  <span class="comment">--字符串存在隐式转换。如果转换数值不成功，则看做0</span></span><br><span class="line"><span class="keyword">FROM</span> DUAL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="string">&#x27;a&#x27;</span> <span class="operator">=</span> <span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;ab&#x27;</span> <span class="operator">=</span> <span class="string">&#x27;ab&#x27;</span>,<span class="string">&#x27;a&#x27;</span> <span class="operator">=</span> <span class="string">&#x27;b&#x27;</span>  <span class="comment">--两边都是字符串的话，则按照ANSI的比较规则进行比较。</span></span><br><span class="line"><span class="keyword">FROM</span> DUAL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="number">1</span> <span class="operator">=</span> <span class="keyword">NULL</span>,<span class="keyword">NULL</span> <span class="operator">=</span> <span class="keyword">NULL</span>  <span class="comment">--只要有null参与判断，结果就为null</span></span><br><span class="line"><span class="keyword">FROM</span> DUAL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> last_name,salary,commission_pc</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="comment">--WHERE salary = 6000;</span></span><br><span class="line"><span class="keyword">WHERE</span> commission_pct <span class="operator">=</span> <span class="keyword">null</span>;  <span class="comment">--此时执行，不会有任何的结果</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- &lt;=&gt; : 安全等于。记忆技巧：为NULL而生。</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="number">1</span> <span class="operator">&lt;=&gt;</span> <span class="number">2</span>,<span class="number">1</span> <span class="operator">&lt;=&gt;</span> <span class="string">&#x27;1&#x27;</span>,<span class="number">1</span> <span class="operator">&lt;=&gt;</span> <span class="string">&#x27;a&#x27;</span>,<span class="number">0</span> <span class="operator">&lt;=&gt;</span> <span class="string">&#x27;a&#x27;</span></span><br><span class="line"><span class="keyword">FROM</span> DUAL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="number">1</span> <span class="operator">&lt;=&gt;</span> <span class="keyword">NULL</span>,<span class="keyword">NULL</span> <span class="operator">&lt;=&gt;</span> <span class="keyword">NULL</span></span><br><span class="line"><span class="keyword">FROM</span> DUAL;</span><br><span class="line"></span><br><span class="line"><span class="comment">--练习：查询表中commission_pct为null的数据有哪些</span></span><br><span class="line"><span class="keyword">SELECT</span> last_name,salary,commission_pct</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">WHERE</span> commission_pct <span class="operator">&lt;=&gt;</span> <span class="keyword">NULL</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="number">3</span> <span class="operator">&lt;&gt;</span> <span class="number">2</span>,<span class="string">&#x27;4&#x27;</span> <span class="operator">&lt;&gt;</span> <span class="keyword">NULL</span>, <span class="string">&#x27;&#x27;</span> <span class="operator">!=</span> <span class="keyword">NULL</span>,<span class="keyword">NULL</span> <span class="operator">!=</span> <span class="keyword">NULL</span></span><br><span class="line"><span class="keyword">FROM</span> DUAL;</span><br></pre></td></tr></table></figure>



<p>2.2 <code>IS NULL \ IS NOT NULL \ ISNULL</code></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--练习：查询表中commission_pct为null的数据有哪些</span></span><br><span class="line"><span class="keyword">SELECT</span> last_name,salary,commission_pct</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">WHERE</span> commission_pct <span class="keyword">IS</span> <span class="keyword">NULL</span>;</span><br><span class="line"><span class="comment">--或</span></span><br><span class="line"><span class="keyword">SELECT</span> last_name,salary,commission_pct</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">WHERE</span> ISNULL(commission_pct );</span><br><span class="line"></span><br><span class="line"><span class="comment">--练习：查询表中commission_pct不为null的数据有哪些</span></span><br><span class="line"><span class="keyword">SELECT</span> last_name,salary,commission_pct</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">WHERE</span> commission_pct <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span>;</span><br><span class="line"><span class="comment">--或</span></span><br><span class="line"><span class="keyword">SELECT</span> last_name,salary,commission_pct</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">WHERE</span> <span class="keyword">NOT</span> commission_pct <span class="operator">&lt;=&gt;</span> <span class="keyword">NULL</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- LEAST() \ GREATEST</span></span><br><span class="line"><span class="keyword">SELECT</span> LEAST(<span class="string">&#x27;g&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;t&#x27;</span>,<span class="string">&#x27;m&#x27;</span>),GREATEST(<span class="string">&#x27;g&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;t&#x27;</span>,<span class="string">&#x27;m&#x27;</span>)</span><br><span class="line"><span class="keyword">FROM</span> DUAL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> LEAST(first_name,last_name),LEAST(LENGTH(first_name),LENGTH(last_name))</span><br><span class="line"><span class="keyword">FROM</span> employees;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">-- BETWEEN 条件下界1 AND 条件上界2  (查询条件1和条件2范围内的数据，包含边界)</span></span><br><span class="line"><span class="comment">-- 查询工资在6000 到 8000的员工信息</span></span><br><span class="line"><span class="keyword">SELECT</span> employee_id,last_name,salary</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="comment">--WHERE salary BETWEEN 6000 AND 8000;</span></span><br><span class="line"><span class="keyword">WHERE</span> salary <span class="operator">&gt;=</span> <span class="number">6000</span> <span class="operator">&amp;&amp;</span> <span class="operator">&lt;=</span> <span class="number">8000</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">--交换6000 和 8000之后，查询不到数据</span></span><br><span class="line"><span class="keyword">SELECT</span> employee_id,last_name,salary</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">WHERE</span> salary <span class="keyword">BETWEEN</span> <span class="number">8000</span> <span class="keyword">AND</span> <span class="number">6000</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">--查询工资不在6000 到 8000的员工信息</span></span><br><span class="line"><span class="keyword">SELECT</span> employee_id,last_name,salary</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">WHERE</span> salary <span class="keyword">NOT</span> <span class="keyword">BETWEEN</span> <span class="number">6000</span> <span class="keyword">AND</span> <span class="number">8000</span>;</span><br><span class="line"><span class="comment">--where salary &lt; 6000 or salary &gt; 8000;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">-- in (set) \ not in (set)</span></span><br><span class="line"><span class="comment">-- 练习：查询部门为10,20,30部门的员工信息</span></span><br><span class="line"><span class="keyword">SELECT</span> last_name,salary,department_id</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="comment">--where department_id = 10 or department_id = 20 or department_id = 30;</span></span><br><span class="line"><span class="keyword">WHERE</span> department_id <span class="keyword">IN</span> (<span class="number">10</span>,<span class="number">20</span>,<span class="number">30</span>);<span class="operator">|</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 练习：查询工资不是6000,7000,8000的员工信息</span></span><br><span class="line"><span class="keyword">SELECT</span> last_name,salary,department_id</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">WHERE</span> salary <span class="keyword">NOT</span> <span class="keyword">IN</span> (<span class="number">6000</span>,<span class="number">7000</span>,<span class="number">8000</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">-- LIKE: 模糊查询</span></span><br><span class="line"><span class="comment">-- %: 代表不确定个数的字符 (0个,1个,或多个)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 练习：查询last_name中包含字符&#x27;a&#x27;的员工信息</span></span><br><span class="line"><span class="keyword">SELECT</span> last_name</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">WHERE</span> last_name <span class="keyword">LIKE</span> <span class="string">&#x27;%a%&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 练习：查询last_name中以字符&#x27;a&#x27;开头的员工信息</span></span><br><span class="line"><span class="keyword">SELECT</span> last_name</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">WHERE</span> last_name <span class="keyword">LIKE</span> <span class="string">&#x27;a%&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 练习：查询last_name中包含字符&#x27;a&#x27;且包含字符&#x27;e&#x27;的员工信息</span></span><br><span class="line"><span class="comment">--写法1：</span></span><br><span class="line"><span class="keyword">SELECT</span> last_name</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">WHERE</span> last_name <span class="keyword">LIKE</span> <span class="string">&#x27;%a%&#x27;</span> <span class="keyword">AND</span> last_name <span class="keyword">LIKE</span> <span class="string">&#x27;%e%&#x27;</span>;</span><br><span class="line"><span class="comment">--写法2：</span></span><br><span class="line"><span class="keyword">SELECT</span> last_name</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">WHERE</span> last_name <span class="keyword">LIKE</span> <span class="string">&#x27;%a%e%&#x27;</span> <span class="keyword">OR</span> last_name <span class="keyword">LIKE</span> <span class="string">&#x27;%e%a%&#x27;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">-- _ : 代表一个不确定的字符</span></span><br><span class="line"><span class="comment">--练习：查询第3个字符是&#x27;a&#x27;的员工信息</span></span><br><span class="line"><span class="keyword">SELECT</span> last_name</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">WHERE</span> last_name <span class="keyword">LIKE</span> <span class="string">&#x27;__a%&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">--练习：查询第2个字符是_且第3个字符是&#x27;a&#x27;的员工信息</span></span><br><span class="line"><span class="comment">--需要使用转义字符: \</span></span><br><span class="line"><span class="keyword">SELECT</span> last_name</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">WHERE</span> last_name <span class="keyword">LIKE</span> <span class="string">&#x27;_\_a%&#x27;</span>;</span><br><span class="line"><span class="comment">--或者 (了解)</span></span><br><span class="line"><span class="keyword">SELECT</span> last_name</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">WHERE</span> last_name <span class="keyword">LIKE</span> <span class="string">&#x27;_$_a%&#x27;</span> <span class="keyword">ESCAPE</span> <span class="string">&#x27;$&#x27;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">-- REGEXP \ RLIKE ：正则表达式</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="string">&#x27;shkstart&#x27;</span> REGEXP <span class="string">&#x27;^shk&#x27;</span>, <span class="string">&#x27;shkstart&#x27;</span> REGEXP <span class="string">&#x27;t$&#x27;</span>, <span class="string">&#x27;shkstart&#x27;</span> REGEXP <span class="string">&#x27;hk&#x27;</span></span><br><span class="line"><span class="keyword">FROM</span> DUAL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="string">&#x27;atguigu&#x27;</span> REGEXP <span class="string">&#x27;gu.gu&#x27;</span>,<span class="string">&#x27;atguigu&#x27;</span> REGEXP <span class="string">&#x27;[ab]&#x27;</span></span><br><span class="line"><span class="keyword">FROM</span> DUAL;</span><br></pre></td></tr></table></figure>



<p>3.<code>逻辑运算符：OR || AND &amp;&amp; NOT ! XOR </code> </p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- or and</span></span><br><span class="line"><span class="keyword">SELECT</span> last_name,salary,department_id</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="comment">--where department_id = 10 or department_id = 20;</span></span><br><span class="line"><span class="comment">--where department_id = 10 and department_id = 20;</span></span><br><span class="line"><span class="keyword">where</span> department_id <span class="operator">=</span> <span class="number">10</span> <span class="keyword">and</span> salary <span class="operator">&gt;</span> <span class="number">6000</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- not</span></span><br><span class="line"><span class="keyword">SELECT</span> employee_id,last_name,salary</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="comment">--WHERE salary NOT BETWEEN 6000 AND 8000;</span></span><br><span class="line"><span class="comment">--WHERE commission_pct IS NOT NULL;</span></span><br><span class="line"><span class="keyword">WHERE</span> <span class="keyword">NOT</span> commission_pct <span class="operator">&lt;=&gt;</span> <span class="keyword">NULL</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- XOR : 追求的&quot;异&quot;</span></span><br><span class="line"><span class="keyword">SELECT</span> last_name,salary,department_id</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">where</span> department_id <span class="operator">=</span> <span class="number">10</span> XOR salary <span class="operator">&gt;</span> <span class="number">6000</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 注意：AND的优先级高于OR</span></span><br></pre></td></tr></table></figure>



<p>4.位运算符：<code>&amp; | ^ ~ &gt;&gt; &lt;&lt;</code></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="number">12</span> <span class="operator">&amp;</span> <span class="number">5</span>,<span class="number">12</span> <span class="operator">|</span> <span class="number">5</span>,<span class="number">12</span> <span class="operator">^</span> <span class="number">5</span></span><br><span class="line"><span class="keyword">FROM</span> DUAL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="number">10</span> <span class="operator">&amp;</span> <span class="operator">~</span><span class="number">1</span> <span class="keyword">FROM</span> DUAL;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 在一定范围内满足：每向左移动1位，相当于乘以2；每向右移动一位，相当于除以2。</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="number">4</span> <span class="operator">&lt;&lt;</span> <span class="number">1</span> , <span class="number">8</span> <span class="operator">&gt;&gt;</span> <span class="number">1</span></span><br><span class="line"><span class="keyword">FROM</span> DUAL;</span><br></pre></td></tr></table></figure>



<p>题目</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--1.选择工资不在5000到12000的员工的姓名和工资</span></span><br><span class="line"><span class="keyword">select</span> last_name,salary</span><br><span class="line"><span class="keyword">from</span> employees</span><br><span class="line"><span class="keyword">where</span> salary <span class="operator">&lt;</span> <span class="number">5000</span> <span class="keyword">or</span> salary <span class="operator">&gt;</span> <span class="number">12000</span>;</span><br><span class="line"><span class="comment">--或</span></span><br><span class="line"><span class="keyword">SELECT</span> last_name,salary</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">WHERE</span> salary <span class="keyword">NOT</span> <span class="keyword">BETWEEN</span> <span class="number">5000</span> <span class="keyword">AND</span> <span class="number">12000</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">--2.选择在20或50号部门工作的员工姓名和部门号</span></span><br><span class="line"><span class="keyword">select</span> last_name,department_id</span><br><span class="line"><span class="keyword">from</span> employees</span><br><span class="line"><span class="keyword">where</span> department_id <span class="operator">=</span> <span class="number">20</span> <span class="keyword">or</span> department_id <span class="operator">=</span> <span class="number">50</span>;</span><br><span class="line"><span class="comment">--或</span></span><br><span class="line"><span class="keyword">select</span> last_name,department_id</span><br><span class="line"><span class="keyword">from</span> employees</span><br><span class="line"><span class="keyword">where</span> department_id <span class="keyword">in</span> (<span class="number">20</span>,<span class="number">50</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">--3.选择公司中没有管理者的员工姓名及job_id</span></span><br><span class="line"><span class="keyword">select</span> last_name,job_id</span><br><span class="line"><span class="keyword">from</span> employees</span><br><span class="line"><span class="keyword">where</span> manager_id <span class="keyword">is</span> <span class="keyword">null</span>;</span><br><span class="line"><span class="comment">--或</span></span><br><span class="line"><span class="keyword">select</span> last_name,job_id</span><br><span class="line"><span class="keyword">from</span> employees</span><br><span class="line"><span class="keyword">where</span> manager_id <span class="operator">&lt;=&gt;</span> <span class="keyword">NULL</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">--4.选择公司中有奖金的员工姓名，工资和奖金级别</span></span><br><span class="line"><span class="keyword">select</span> last_name,salary,commission_pct</span><br><span class="line"><span class="keyword">from</span> employees</span><br><span class="line"><span class="keyword">where</span> commission_pct <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span>;</span><br><span class="line"><span class="comment">--或</span></span><br><span class="line"><span class="keyword">select</span> last_name,salary,commission_pct</span><br><span class="line"><span class="keyword">from</span> employees</span><br><span class="line"><span class="keyword">where</span> <span class="keyword">NOT</span> commission_pct <span class="operator">&lt;=&gt;</span> <span class="keyword">NULL</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">--5.选择员工姓名的第三个字母是a的员工姓名</span></span><br><span class="line"><span class="keyword">select</span> last_name</span><br><span class="line"><span class="keyword">from</span> employees</span><br><span class="line"><span class="keyword">where</span> last_name <span class="keyword">like</span> <span class="string">&#x27;__a%&#x27;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">--6.选择姓名中有字母a和k的员工姓名</span></span><br><span class="line"><span class="keyword">SELECT</span> last_name</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">WHERE</span> last_name <span class="keyword">LIKE</span> <span class="string">&#x27;%a%&#x27;</span> <span class="keyword">AND</span> last_name <span class="keyword">LIKE</span> <span class="string">&#x27;%k%&#x27;</span>;</span><br><span class="line"><span class="comment">--或</span></span><br><span class="line"><span class="keyword">SELECT</span> last_name</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">WHERE</span> last_name <span class="keyword">LIKE</span> <span class="string">&#x27;%a%k%&#x27;</span> <span class="keyword">AND</span> last_name <span class="keyword">LIKE</span> <span class="string">&#x27;%k%a%&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">--7.显示出表 employees 表中first_name 以&#x27;e&#x27;结尾的员工信息</span></span><br><span class="line"><span class="keyword">select</span> first_name,last_name</span><br><span class="line"><span class="keyword">from</span> employees</span><br><span class="line"><span class="keyword">where</span> first_name <span class="keyword">like</span> <span class="string">&#x27;%e&#x27;</span></span><br><span class="line"><span class="comment">--或</span></span><br><span class="line"><span class="keyword">select</span> first_name,last_name</span><br><span class="line"><span class="keyword">from</span> employees</span><br><span class="line"><span class="keyword">where</span> first_name regexp <span class="string">&#x27;e$&#x27;</span>  <span class="comment">--以e开头的写法: &#x27;^e&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--8.显示出表employees部门编号在80-100之间的姓名、工种</span></span><br><span class="line"><span class="keyword">select</span> last_name,job_id</span><br><span class="line"><span class="keyword">from</span> employees</span><br><span class="line"><span class="keyword">where</span> department_id <span class="operator">&gt;</span> <span class="number">79</span> <span class="keyword">and</span> department_id <span class="operator">&lt;</span> <span class="number">101</span></span><br><span class="line"><span class="comment">--where department_id &gt;= 80 and department_id &lt;= 100</span></span><br><span class="line"><span class="comment">--或</span></span><br><span class="line"><span class="keyword">select</span> last_name,job_id</span><br><span class="line"><span class="keyword">from</span> employees</span><br><span class="line"><span class="keyword">WHERE</span> department_id <span class="keyword">BETWEEN</span> <span class="number">80</span> <span class="keyword">AND</span> <span class="number">100</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">--9.显示出表 employees的manager_id是100,101,110的员工姓名、工资、管理者id</span></span><br><span class="line"><span class="keyword">select</span> last_name,salary,manager_id</span><br><span class="line"><span class="keyword">from</span> employees</span><br><span class="line"><span class="keyword">where</span> manager_id <span class="operator">=</span> <span class="number">100</span> <span class="keyword">or</span> manager_id <span class="operator">=</span> <span class="number">101</span> <span class="keyword">or</span> manager_id <span class="operator">=</span> <span class="number">110</span>;</span><br><span class="line"><span class="comment">--或</span></span><br><span class="line"><span class="keyword">select</span> last_name,salary,manager_id</span><br><span class="line"><span class="keyword">from</span> employees</span><br><span class="line"><span class="keyword">where</span> manager_id <span class="keyword">IN</span> (<span class="number">100</span>,<span class="number">101</span>,<span class="number">110</span>);</span><br></pre></td></tr></table></figure>





<h3 id="第05章-排序与分页"><a href="#第05章-排序与分页" class="headerlink" title="第05章 排序与分页"></a>第05章 排序与分页</h3><p>1.排序</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 如果没有使用排序操作，默认情况下查询返回的数据是按照添加数据的顺序显示的。</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> employees;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 1.1</span></span><br><span class="line"><span class="comment">-- 使用 ORDER BY 对查询到的数据进行排序操作。</span></span><br><span class="line"><span class="comment">-- 升序：ASC (ascend)</span></span><br><span class="line"><span class="comment">-- 降序：DESC (descend)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 练习：按照salary从高到低的顺序显示员工信息</span></span><br><span class="line"><span class="keyword">SELECT</span> employee_id,last_name,salary</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> salary <span class="keyword">DESC</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 练习：按照salary从低到高的顺序显示员工信息</span></span><br><span class="line"><span class="keyword">SELECT</span> employee_id,last_name,salary</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> salary <span class="keyword">ASC</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> employee_id,last_name,salary</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> salary;  <span class="comment">--如果在 ORDER BY 后没有显式指名排序的方式的话，则默认按照升序排列。</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 2.我们可以使用列的别名，进行排序</span></span><br><span class="line"><span class="keyword">SELECT</span> employee_id,salary,salary <span class="operator">*</span> <span class="number">12</span> annual_sal</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> annual_sal;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 列的别名只能在 ORDER BY 中使用，不能在WHERE中使用。</span></span><br><span class="line"><span class="comment">-- 如下操作报错！</span></span><br><span class="line"><span class="keyword">SELECT</span> employee_id,salary,salary <span class="operator">*</span> <span class="number">12</span> annual_sal</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">WHERE</span> annual_sal <span class="operator">&gt;</span> <span class="number">81600</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 3.强调格式：WHERE需要声明在FROM后，ORDER BY 之前。</span></span><br><span class="line"><span class="keyword">SELECT</span> employee_id,salary</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">WHERE</span> department_id <span class="keyword">IN</span> (<span class="number">50</span>,<span class="number">60</span>,<span class="number">70</span>)</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> department_id <span class="keyword">DESC</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 4.二级排序</span></span><br><span class="line"><span class="comment">-- 练习：显示员工信息，按照department_id的降序排列, salary的升序排列</span></span><br><span class="line"><span class="keyword">SELECT</span> employee_id,salary,department_id</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> department_id <span class="keyword">DESC</span>,salary <span class="keyword">ASC</span>;</span><br></pre></td></tr></table></figure>





<h3 id="2-分页"><a href="#2-分页" class="headerlink" title="2.分页"></a>2.分页</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 2.1 mysql使用limit实现数据的分页显示</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 需求1：每页显示20条记录，此时显示第1页</span></span><br><span class="line"><span class="keyword">SELECT</span> employee_id,last_name</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line">LIMIT <span class="number">0</span>,<span class="number">20</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 需求2：每页显示20条记录，此时显示第2页</span></span><br><span class="line"><span class="keyword">SELECT</span> employee_id,last_name</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line">LIMIT <span class="number">20</span>,<span class="number">20</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 需求2：每页显示20条记录，此时显示第3页</span></span><br><span class="line"><span class="keyword">SELECT</span> employee_id,last_name</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line">LIMIT <span class="number">40</span>,<span class="number">20</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 需求：每页显示pageSize条记录，此时显示第pageNo页：</span></span><br><span class="line"><span class="comment">-- 公式：LIMIT (pageNo-1) * pageSize,pageSize;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 2.2 WHERE ... ORDER BY ... LIMIT 声明顺序如下：</span></span><br><span class="line"><span class="comment">-- LIMIT的格式：严格来说：LIMIT 位置偏移量，条目数</span></span><br><span class="line"><span class="comment">-- 结构&quot;LIMIT 0,条目数&quot; 等价于 &quot;LIMIT 条目数&quot;</span></span><br><span class="line"><span class="keyword">SELECT</span> employee_id,last_name,salary</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">WHERE</span> salary <span class="operator">&gt;</span> <span class="number">6000</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> salary <span class="keyword">DESC</span></span><br><span class="line"><span class="comment">--LIMIT 0,10;</span></span><br><span class="line">LIMIT <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 练习：表里有107条数据，我们只想要显示第 32、33 条数据怎么办呢?</span></span><br><span class="line"><span class="keyword">SELECT</span> employee_id,last_name</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line">LIMIT <span class="number">31</span>,<span class="number">2</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 2.3 MYSQL8.0新特性：LIMIT ... OFFSET ...</span></span><br><span class="line"><span class="comment">-- 练习：表里有107条数据，我们只想要显示第 32、33 条数据怎么办呢</span></span><br><span class="line"><span class="keyword">SELECT</span> employee_id,last_name</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line">LIMIT <span class="number">2</span> <span class="keyword">OFFSET</span> <span class="number">31</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 练习：查询员工表中工资最高的员工信息</span></span><br><span class="line"><span class="keyword">SELECT</span> employee_id,last_name,salary</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> salary <span class="keyword">DESC</span></span><br><span class="line"><span class="comment">--limit 0,1</span></span><br><span class="line">LIMIT <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 2.4 LIMIT 可以使用在MySQL、PGSQL、MariaDB、SQLite 等数据库中使用，表示分页。</span></span><br><span class="line"><span class="comment">-- 不能使用在SQLServer、DB2、Oracle!</span></span><br></pre></td></tr></table></figure>



<h3 id="第05章-排序与分页的课后练习"><a href="#第05章-排序与分页的课后练习" class="headerlink" title="第05章 排序与分页的课后练习"></a>第05章 排序与分页的课后练习</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 1.查询员工的姓名和部门号和年薪，按年薪降序，按姓名升序显示</span></span><br><span class="line"><span class="keyword">SELECT</span> last_name,department_id,salary <span class="operator">*</span> <span class="number">12</span> annual_salary</span><br><span class="line"><span class="keyword">FROM</span> empLoyees</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> annual_salary <span class="keyword">DESC</span>,last_name <span class="keyword">ASC</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 2.选择工资不在 8000 到 17000 的员工的姓名和工资，按工资降序，显示第21到40位置的数据</span></span><br><span class="line"><span class="keyword">SELECT</span> last_name,salary</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">WHERE</span> salarY <span class="keyword">NOT</span> <span class="keyword">BETWEEN</span> <span class="number">8000</span> <span class="keyword">AND</span> <span class="number">17000</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> salary <span class="keyword">DESC</span></span><br><span class="line">LIMIT <span class="number">20</span>,<span class="number">20</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 3.查询邮箱中包含 e 的员工信息，并先按邮箱的字节数降序，再按部门号升序</span></span><br><span class="line"><span class="keyword">SELECT</span> employee_id,last_name,email,department_id</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="comment">--where email like &#x27;%e%&#x27;</span></span><br><span class="line"><span class="keyword">WHERE</span> email REGEXP <span class="string">&#x27;[e]&#x27;</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> LENGTH(email) <span class="keyword">DESC</span>,department_id;</span><br></pre></td></tr></table></figure>





<h3 id="第06章-多表查询"><a href="#第06章-多表查询" class="headerlink" title="第06章 多表查询"></a>第06章 多表查询</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">SELECT ...,...,..,</span></span><br><span class="line"><span class="comment">FROM ...</span></span><br><span class="line"><span class="comment">WHERE .... AND / OR / NOT ....</span></span><br><span class="line"><span class="comment">ORDER BY .... (ASC/DESC),...,...</span></span><br><span class="line"><span class="comment">LIMIT ...,...</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 1.熟悉常见的几个表</span></span><br><span class="line"><span class="keyword">DESC</span> employees;</span><br><span class="line"><span class="keyword">DESC</span> departments;</span><br><span class="line"><span class="keyword">DESC</span> locations;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 查询员工名为&#x27;Abel&#x27;的人在哪个城市工作?</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">WHERE</span> last_name <span class="operator">=</span> <span class="string">&#x27;Abel&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> departments</span><br><span class="line"><span class="keyword">WHERE</span> department_id <span class="operator">=</span> <span class="number">80</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> loactions</span><br><span class="line"><span class="keyword">WHERE</span> loaction_id <span class="operator">=</span> <span class="number">2500</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 2.出现笛卡尔积的错误</span></span><br><span class="line"><span class="comment">-- 错误的原因：缺少了多表的连接条件</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 错误的实现方式：每个员工都与每个部门匹配了一遍。</span></span><br><span class="line"><span class="keyword">SELECT</span> employee_id,department_name</span><br><span class="line"><span class="keyword">FROM</span> employees,departments;  <span class="comment">--查询出2889条记录</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 错误的方式</span></span><br><span class="line"><span class="keyword">SELECT</span> employee_id,department_name</span><br><span class="line"><span class="keyword">FROM</span> employees <span class="keyword">CROSS</span> <span class="keyword">JOIN</span> departments;  <span class="comment">--查询出2889条记录</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> employees;  <span class="comment">--107条记录</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="number">2889</span> <span class="operator">/</span> <span class="number">107</span></span><br><span class="line"><span class="keyword">FROM</span> DUAL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> departments;  <span class="comment">--27条记录</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 3.多表查询的正确方式：需要有连接条件</span></span><br><span class="line"><span class="keyword">SELECT</span> employee_id,department_name</span><br><span class="line"><span class="keyword">FROM</span> employees,departments</span><br><span class="line"><span class="comment">--两个表的连接条件</span></span><br><span class="line"><span class="keyword">WHERE</span> employees.department_id <span class="operator">=</span> departments.department_id;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 4.如果益询语句中出现了多个表中都存在的字段，则必须指明此字段所在的表。</span></span><br><span class="line"><span class="keyword">SELECT</span> employees.employee_id,departments.department_name,employees.department_id</span><br><span class="line"><span class="keyword">FROM</span> employees,departments</span><br><span class="line"><span class="keyword">WHERE</span> employees.department_id <span class="operator">=</span> departments.department_id;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 建议：从sql优化的角度，建议多表查询时，每个字段前都指明其所在的表。</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 5.可以给表起别名，在SELECT和WHERE中使用表的别名。</span></span><br><span class="line"><span class="keyword">SELECT</span> emps.employee_id,dept.department_name,emp.department_id</span><br><span class="line"><span class="keyword">FROM</span> employees emp,departments dept</span><br><span class="line"><span class="keyword">WHERE</span> emp.department_id <span class="operator">=</span> dept.department_id;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 如果给表起了别名，一旦在SELECT或WHERE中使用表名的话，则必须使用表的别名，而不能再使用表的原名。</span></span><br><span class="line"><span class="comment">-- 如下的操作是错误的：</span></span><br><span class="line"><span class="keyword">SELECT</span> emps.employee_id,departments.department_name,emp.department_id</span><br><span class="line"><span class="keyword">FROM</span> employees emp,departments dept</span><br><span class="line"><span class="keyword">WHERE</span> emp.department_id <span class="operator">=</span> departments.department_id;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 6.如果有n个表实现多表的查询，则需要至少n-1个连接条件</span></span><br><span class="line"><span class="comment">-- 练习：查询员工的employee_id,last_name,department_name,city</span></span><br><span class="line"><span class="keyword">SELECT</span> e.employee_id,e.last_name,d.department_name,l.city,e.department_id,l.location_id</span><br><span class="line"><span class="keyword">FROM</span> employees e,departments d,locations l</span><br><span class="line"><span class="keyword">WHERE</span> e.department_id <span class="operator">=</span> d.department_id</span><br><span class="line"><span class="keyword">AND</span> d.location_id <span class="operator">=</span> l.location_id;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">演绎式：提出问题1 ---&gt; 解决问题1 ---&gt; 提出问题2 ---&gt; 解决问题2 ....</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">归纳式：总--分</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 7.多表查询的分类</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">角度1： 等值连接 vs 非等值连接</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">角度2： 自连接 vs 非自连接</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">角度3： 内连接 vs 外连接</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 7.1 等值连接 vs 非等值连接</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> job_grades;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> e.last_name,e.salary,j.grade_level</span><br><span class="line"><span class="keyword">FROM</span> employees e, job_grades j</span><br><span class="line"><span class="comment">--WHERE e.salary BETWEEN j.lowest_sal AND j.highest_sal&#x27;;</span></span><br><span class="line"><span class="keyword">WHERE</span> e.salary <span class="operator">&gt;=</span> j.lowest_sal <span class="keyword">AND</span> e.salary <span class="operator">&lt;=</span> j.highest_sal;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 7.2 自连接 vs 非自连接</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> employees;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 自连接的例子</span></span><br><span class="line"><span class="comment">-- 练习：查询员工id,员工姓名及其管理者的id和姓名</span></span><br><span class="line"><span class="keyword">SELECT</span> emp.employee_id,emp.last_name,mgr.employee_id,mgr.last_name</span><br><span class="line"><span class="keyword">FROM</span> employees emp,employees mgr</span><br><span class="line"><span class="keyword">WHERE</span> emp.manager_id <span class="operator">=</span> mgr.employee_id;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 7.3 内连接 vs 外连接</span></span><br><span class="line"><span class="comment">-- 内连接：合并具有同一列的两个以上的表的行，结果集中不包含一个表与另一个表不匹配的行</span></span><br><span class="line"><span class="keyword">SELECT</span> employee_id,department_name</span><br><span class="line"><span class="keyword">FROM</span> employees e,departments d</span><br><span class="line"><span class="keyword">WHERE</span> e.department_id <span class="operator">=</span> d.department_id; <span class="comment">--只有106条记录</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 外连接：合并具有同一列的两个以上的表的行，结果集中除了包含一个表与另一个表匹配的行之外，</span></span><br><span class="line"><span class="comment">-- 还查询到了左表 或 右表中不匹配的行。</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 外连接的分类：左外连接、右外连接、满外连接</span></span><br><span class="line"><span class="comment">-- 左外连接：两个表在连接过程中除了返回满足连接条件的行以外还返回左表中不满足条件的行，这种连接称为左外连接。</span></span><br><span class="line"><span class="comment">-- 右外连接：两个表在连接过程中除了返回满足连接条件的行以外还返回右表中不满足条件的行，这种连接称为右外连接。</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--练习：查询所有的员工的last_name,department_name信息</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> employee_id,department_name</span><br><span class="line"><span class="keyword">FROM</span> employees e,departments d</span><br><span class="line"><span class="keyword">WHERE</span> e.department_id <span class="operator">=</span> d.department_id;  <span class="comment">-- 需要使用左外连接</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--SQL92语法实现内连接：见上，略</span></span><br><span class="line"><span class="comment">--SQL92语法实现外连接：使用 +  ----------MySQL不支持SQL92语法中外连接的写法！</span></span><br><span class="line"><span class="comment">--不支持：</span></span><br><span class="line"><span class="keyword">SELECT</span> employee_id,department_name</span><br><span class="line"><span class="keyword">FROM</span> employees e,departments d</span><br><span class="line"><span class="keyword">WHERE</span> e.department_id <span class="operator">=</span> d.department_id(<span class="operator">+</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- SQL99语法中使用JOIN ... ON 的方式实现多表的查询。这种方式也能解决外连接的问题。MySQL是支持此种方式的。</span></span><br><span class="line"><span class="comment">-- SQL99语法如何实现多表的查询。</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- SQL99语法实现内连接：</span></span><br><span class="line"><span class="keyword">SELECT</span> last_name,department_name,city</span><br><span class="line"><span class="keyword">FROM</span> employees e <span class="keyword">INNER</span> <span class="keyword">JOIN</span> departments d  <span class="comment">-- INNER JOIN 可以省略为 JOIN</span></span><br><span class="line"><span class="keyword">ON</span> e.department_id <span class="operator">=</span> d.department_id;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> last_name,department_name,city</span><br><span class="line"><span class="keyword">FROM</span> employees e <span class="keyword">JOIN</span> departments d</span><br><span class="line"><span class="keyword">ON</span> e.department_id <span class="operator">=</span> d.department_id</span><br><span class="line"><span class="keyword">JOIN</span> locations l</span><br><span class="line"><span class="keyword">ON</span> d.location_id <span class="operator">=</span> l.location_id;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- SQL99语法实现外连接：</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 练习：查询所有的员工的last_name,department_name信息</span></span><br><span class="line"><span class="comment">-- 左外连接：</span></span><br><span class="line"><span class="keyword">SELECT</span> last_name,department_name</span><br><span class="line"><span class="keyword">FROM</span> employees e <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> departments d  <span class="comment">-- LEFT OUTER JOIN 可以省略为 LEFT JOIN</span></span><br><span class="line"><span class="keyword">ON</span> e.department_id <span class="operator">=</span> d.department_id;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 右外连接：</span></span><br><span class="line"><span class="keyword">SELECT</span> last_name,department_name</span><br><span class="line"><span class="keyword">FROM</span> employees e <span class="keyword">RIGHT</span> <span class="keyword">OUTER</span> <span class="keyword">JOIN</span> departments d  <span class="comment">-- RIGHT OUTER JOIN 可以省略为 RIGHT JOIN</span></span><br><span class="line"><span class="keyword">ON</span> e.department_id <span class="operator">=</span> d.department_id;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 满外连接：mysql不支持FULL OUTER JOIN</span></span><br><span class="line"><span class="keyword">SELECT</span> last_name,department_name</span><br><span class="line"><span class="keyword">FROM</span> employees e <span class="keyword">FULL</span> <span class="keyword">OUTER</span> <span class="keyword">JOIN</span> departments d</span><br><span class="line"><span class="keyword">ON</span> e.department_id <span class="operator">=</span> d.department_id;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 8. UNION 和 UNION ALL的使用</span></span><br><span class="line"><span class="comment">-- UNION：会执行去重操作</span></span><br><span class="line"><span class="comment">-- UNION ALL：不会执行去重操作</span></span><br><span class="line"><span class="comment">-- 结论：如果明确知道合并数据后的结果数据不存在重复数据，或者不需要去除重复的数据，</span></span><br><span class="line"><span class="comment">-- 则尽量使用UNION ALL语句，以提高数据查询的效率。</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 9. 7种JOIN的实现：</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 中图：内连接</span></span><br><span class="line"><span class="keyword">SELECT</span> employee_id,department_name</span><br><span class="line"><span class="keyword">FROM</span> employees e <span class="keyword">JOIN</span> departments d</span><br><span class="line"><span class="keyword">ON</span> e.department_id <span class="operator">=</span> d.department_id;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 左上图：左外连接</span></span><br><span class="line"><span class="keyword">SELECT</span> employee_id,department_name</span><br><span class="line"><span class="keyword">FROM</span> employees e <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> departments d</span><br><span class="line"><span class="keyword">ON</span> e.department_id <span class="operator">=</span> d.department_id;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 右上图：右外连接</span></span><br><span class="line"><span class="keyword">SELECT</span> employee_id,department_name</span><br><span class="line"><span class="keyword">FROM</span> employees e <span class="keyword">RIGHT</span> <span class="keyword">JOIN</span> departments d</span><br><span class="line"><span class="keyword">ON</span> e.department_id <span class="operator">=</span> d.department_id;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 左中图：</span></span><br><span class="line"><span class="keyword">SELECT</span> employee_id,department_name</span><br><span class="line"><span class="keyword">FROM</span> employees e <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> departments d</span><br><span class="line"><span class="keyword">ON</span> e.department_id <span class="operator">=</span> d.department_id</span><br><span class="line"><span class="keyword">WHERE</span> d.department_id <span class="keyword">IS</span> <span class="keyword">NULL</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 右中图：</span></span><br><span class="line"><span class="keyword">SELECT</span> employee_id,department_name</span><br><span class="line"><span class="keyword">FROM</span> employees e <span class="keyword">RIGHT</span> <span class="keyword">JOIN</span> departments d</span><br><span class="line"><span class="keyword">ON</span> e.department_id <span class="operator">=</span> d.department_id</span><br><span class="line"><span class="keyword">WHERE</span> e.department_id <span class="keyword">IS</span> <span class="keyword">NULL</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 左下图：满外连接</span></span><br><span class="line"><span class="comment">-- 方式1：左上图 UNION ALL 右中图</span></span><br><span class="line"><span class="keyword">SELECT</span> employee_id,department_name</span><br><span class="line"><span class="keyword">FROM</span> employees e <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> departments d</span><br><span class="line"><span class="keyword">ON</span> e.department_id <span class="operator">=</span> d.department_id</span><br><span class="line"><span class="keyword">UNION</span> <span class="keyword">ALL</span></span><br><span class="line"><span class="keyword">SELECT</span> employee_id,department_name</span><br><span class="line"><span class="keyword">FROM</span> employees e <span class="keyword">RIGHT</span> <span class="keyword">JOIN</span> departments d</span><br><span class="line"><span class="keyword">ON</span> e.department_id <span class="operator">=</span> d.department_id</span><br><span class="line"><span class="keyword">WHERE</span> e.department_id <span class="keyword">IS</span> <span class="keyword">NULL</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 方式2：左中图 UNION ALL 右上图</span></span><br><span class="line"><span class="keyword">SELECT</span> employee_id,department_name</span><br><span class="line"><span class="keyword">FROM</span> employees e <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> departments d</span><br><span class="line"><span class="keyword">ON</span> e.department_id <span class="operator">=</span> d.department_id</span><br><span class="line"><span class="keyword">WHERE</span> d.department_id <span class="keyword">IS</span> <span class="keyword">NULL</span></span><br><span class="line"><span class="keyword">UNION</span> <span class="keyword">ALL</span></span><br><span class="line"><span class="keyword">SELECT</span> employee_id,department_name</span><br><span class="line"><span class="keyword">FROM</span> employees e <span class="keyword">RIGHT</span> <span class="keyword">JOIN</span> departments d</span><br><span class="line"><span class="keyword">ON</span> e.department_id <span class="operator">=</span> d.department_id;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 右下图：左中图 UNION ALL 右中图</span></span><br><span class="line"><span class="keyword">SELECT</span> employee_id,department_name</span><br><span class="line"><span class="keyword">FROM</span> employees e <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> departments d</span><br><span class="line"><span class="keyword">ON</span> e.department_id <span class="operator">=</span> d.department_id</span><br><span class="line"><span class="keyword">WHERE</span> d.department_id <span class="keyword">IS</span> <span class="keyword">NULL</span></span><br><span class="line"><span class="keyword">UNION</span> <span class="keyword">ALL</span></span><br><span class="line"><span class="keyword">SELECT</span> employee_id,department_name</span><br><span class="line"><span class="keyword">FROM</span> employees e <span class="keyword">RIGHT</span> <span class="keyword">JOIN</span> departments d</span><br><span class="line"><span class="keyword">ON</span> e.department_id <span class="operator">=</span> d.department_id</span><br><span class="line"><span class="keyword">WHERE</span> e.department_id <span class="keyword">IS</span> <span class="keyword">NULL</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 10.SQL99语法的新特性1：自然连接</span></span><br><span class="line"><span class="keyword">SELECT</span> employee_id,last_name,department_name</span><br><span class="line"><span class="keyword">FROM</span> employees e <span class="keyword">JOIN</span> departments d</span><br><span class="line"><span class="keyword">ON</span> e.department_id <span class="operator">=</span> d.department_id</span><br><span class="line"><span class="keyword">AND</span> e.manager_id <span class="operator">=</span> d.manager_id;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- NATURAL JOIN：它会帮你自动查询两张连接表中`所有相同的字段`，然后进行`等值连接`。</span></span><br><span class="line"><span class="keyword">SELECT</span> employee_id,last_name,department_name</span><br><span class="line"><span class="keyword">FROM</span> employees e <span class="keyword">NATURAL</span> <span class="keyword">JOIN</span> departments d;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 11.SQL99语法的新特性2：USING</span></span><br><span class="line"><span class="keyword">SELECT</span> employee_id,last_name,department_name</span><br><span class="line"><span class="keyword">FROM</span> employees e <span class="keyword">JOIN</span> departments d</span><br><span class="line"><span class="keyword">ON</span> e.department_id <span class="operator">=</span> d.department_id;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> employee_id,last_name,department_nane</span><br><span class="line"><span class="keyword">FROM</span> employees e <span class="keyword">JOIN</span> departments d</span><br><span class="line"><span class="keyword">USING</span> (department_id);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 拓展：</span></span><br><span class="line"><span class="keyword">SELECT</span> last_name,job_title,department_name</span><br><span class="line"><span class="keyword">FROM</span> employees <span class="keyword">INNER</span> <span class="keyword">JOIN</span> departments <span class="keyword">INNER</span> <span class="keyword">JOIN</span> jobs</span><br><span class="line"><span class="keyword">ON</span> employees.department_id <span class="operator">=</span> departments.department_id</span><br><span class="line"><span class="keyword">AND</span> employees.job_id <span class="operator">=</span> jobs.job_id;</span><br></pre></td></tr></table></figure>



<p>多表查询</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `t_dept` (</span><br><span class="line">`id` <span class="type">INT</span> (<span class="number">11</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT,</span><br><span class="line">`deptName` <span class="type">VARCHAR</span>(<span class="number">30</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">`ADDress` <span class="type">VARCHAR</span> (<span class="number">40</span>) <span class="keyword">DEFAULT</span> NUAL,</span><br><span class="line"><span class="keyword">PRIMARY</span> KEY (`id`)</span><br><span class="line">) ENGINE<span class="operator">=</span>INNODB AUTO_INCREMENT<span class="operator">=</span><span class="number">1</span> <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8;</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `t_emp` (</span><br><span class="line">`id` <span class="type">INT</span> (<span class="number">11</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT,</span><br><span class="line">`name` <span class="type">VARCHAR</span>(<span class="number">20</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">`age` <span class="type">INT</span> (<span class="number">3</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">`deptId` <span class="type">INT</span>(<span class="number">11</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">empno <span class="type">INT</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line"><span class="keyword">PRIMARY</span> KEY (`id`),</span><br><span class="line">KEY `idx_dept_id` (`deptId`)</span><br><span class="line"><span class="comment">--CONSTRAINT `fk_dept_id` FOREIGN KEY (`deptId`) REFERENCES `t_dept` (`id`)</span></span><br><span class="line">) ENGINE<span class="operator">=</span>INNODB AUTO_INCREMENT<span class="operator">=</span><span class="number">1</span> <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8;</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> t_dept (deptName,ADDress) <span class="keyword">VALUES</span>(<span class="string">&#x27;华山&#x27;</span>,<span class="string">&#x27;华山&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> t_dept (deptName,ADDress) <span class="keyword">VALUES</span>(<span class="string">&#x27;丐帮&#x27;</span>，<span class="string">&#x27;洛阳&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> t_dept (deptName,ADDress) <span class="keyword">VALUES</span>(<span class="string">&#x27;峨眉&#x27;</span>，<span class="string">&#x27;峨眉山&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> t_dept(deptName,ADDress) <span class="keyword">VALUES</span>(<span class="string">&#x27;武当&#x27;</span>，<span class="string">&#x27;武当山&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> t_dept (deptName,ADDress) <span class="keyword">VALUES</span>(<span class="string">&#x27;明教&#x27;</span>,<span class="string">&#x27;光明顶&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> t_dept (deptName,ADDress) <span class="keyword">VALUES</span>(<span class="string">&#x27;少林&#x27;</span>,<span class="string">&#x27;少林寺&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> t_emp (NAME,age,deptId,empno) <span class="keyword">VALUES</span>(<span class="string">&#x27;风清扬&#x27;</span>,<span class="number">90</span>,<span class="number">1</span>,<span class="number">100001</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> t_emp (NAME,age,deptId,empno) <span class="keyword">VALUES</span>(<span class="string">&#x27;岳不群&#x27;</span>,<span class="number">50</span>,<span class="number">1</span>,<span class="number">100002</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> t_emp (NAME,age,deptId,empno) <span class="keyword">VALUES</span>(<span class="string">&#x27;令狐冲&#x27;</span>,<span class="number">24</span>,<span class="number">1</span>,<span class="number">100003</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> t_emp (NAME,age,deptId,empno) <span class="keyword">VALUES</span>(<span class="string">&#x27;洪七公&#x27;</span>,<span class="number">70</span>,<span class="number">2</span>,<span class="number">100004</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> t_emp (NAME,age,deptId,empno) <span class="keyword">VALUES</span>(<span class="string">&#x27;乔峰&#x27;</span>,<span class="number">35</span>,<span class="number">2</span>,<span class="number">100005</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> t_emp (NAME,age,deptId,empno) <span class="keyword">VALUES</span>(<span class="string">&#x27;灭绝师太&#x27;</span>,<span class="number">70</span>,<span class="number">3</span>,<span class="number">100006</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> t_emp (NAME,age,deptId,empno) <span class="keyword">VALUES</span>(<span class="string">&#x27;周芷若&#x27;</span>,<span class="number">20</span>,<span class="number">3</span>,<span class="number">100007</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> t_emp (NAME,age,deptId,empno) <span class="keyword">VALUES</span>(<span class="string">&#x27;张三丰&#x27;</span>,<span class="number">100</span>,<span class="number">4</span>,<span class="number">100008</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> t_emp (NAME,age,deptId,empno) <span class="keyword">VALUES</span>(<span class="string">&#x27;张无忌&#x27;</span>,<span class="number">25</span>,<span class="number">5</span>,<span class="number">100009</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> t_emp (NAME,age,deptId,empno) <span class="keyword">VALUES</span>(<span class="string">&#x27;韦小宝&#x27;</span>,<span class="number">18</span>,<span class="keyword">NULL</span>,<span class="number">100010</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">【题目】</span><br><span class="line"><span class="comment">--1.所有有门派的人员信息（A、B两表共有）</span></span><br><span class="line"><span class="keyword">SELECT</span> `name`,age,deptname </span><br><span class="line"><span class="keyword">FROM</span> t_emp</span><br><span class="line"><span class="keyword">JOIN</span> t_dept</span><br><span class="line"><span class="keyword">ON</span> t_emp.deptid <span class="operator">=</span> t_dept.id</span><br><span class="line"></span><br><span class="line"><span class="comment">--2.列出所有用户，并显示其机构信息（A的全集）</span></span><br><span class="line"><span class="keyword">select</span> e.name,d.deptname</span><br><span class="line"><span class="keyword">from</span> t_emp e</span><br><span class="line"><span class="keyword">left</span> <span class="keyword">join</span> t_dept d</span><br><span class="line"><span class="keyword">on</span> e.deptId<span class="operator">=</span>d.id</span><br><span class="line"></span><br><span class="line"><span class="comment">--3.列出所有门派(B的全集）</span></span><br><span class="line"> <span class="keyword">select</span> <span class="keyword">distinct</span> address</span><br><span class="line"><span class="keyword">from</span> t_dept d</span><br><span class="line"><span class="keyword">left</span> <span class="keyword">join</span> t_emp e</span><br><span class="line"><span class="keyword">on</span> d.id <span class="operator">=</span> e.deptid</span><br><span class="line"></span><br><span class="line"><span class="comment">--4.所有不入门派的人员（A的独有)</span></span><br><span class="line"><span class="keyword">select</span> e.name,d.deptname</span><br><span class="line"><span class="keyword">from</span> t_emp e</span><br><span class="line"><span class="keyword">left</span> <span class="keyword">join</span> t_dept d</span><br><span class="line"><span class="keyword">on</span> e.deptId<span class="operator">=</span>d.id</span><br><span class="line"><span class="keyword">WHERE</span> e.deptid <span class="keyword">is</span> <span class="keyword">NULL</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--5.所有没人入的门派（B的独有）</span></span><br><span class="line"><span class="keyword">select</span> d.deptname</span><br><span class="line"><span class="keyword">from</span> t_dept d</span><br><span class="line"><span class="keyword">left</span> <span class="keyword">join</span> t_emp e</span><br><span class="line"><span class="keyword">on</span> d.id <span class="operator">=</span> e.deptid</span><br><span class="line"><span class="keyword">where</span> e.deptid <span class="keyword">is</span> <span class="keyword">NULL</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--6.列出所有人员和机构的对照关系（AB全有）</span></span><br><span class="line"><span class="keyword">select</span> e.name,d.deptname</span><br><span class="line"><span class="keyword">from</span> t_emp e</span><br><span class="line"><span class="keyword">left</span> <span class="keyword">join</span> t_dept d</span><br><span class="line"><span class="keyword">on</span> e.deptId<span class="operator">=</span>d.id</span><br><span class="line"><span class="keyword">union</span> <span class="keyword">all</span></span><br><span class="line"><span class="keyword">select</span> e.name,d.deptname</span><br><span class="line"><span class="keyword">from</span> t_dept d</span><br><span class="line"><span class="keyword">left</span> <span class="keyword">join</span> t_emp e</span><br><span class="line"><span class="keyword">on</span> d.id <span class="operator">=</span> e.deptid</span><br><span class="line"><span class="keyword">where</span> e.deptid <span class="keyword">is</span> <span class="keyword">NULL</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--MySQL FULL Join的实现因为MySQL不支持FULL JOIN,下面是替代方法</span></span><br><span class="line"><span class="comment">--left join+ union(可去除重复数据)+ right join</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">--7.列出所有没入派的人员和没人入的门派(A的独有+B的独有)</span></span><br><span class="line"><span class="keyword">select</span> e.name,d.deptname</span><br><span class="line"><span class="keyword">from</span> t_emp e</span><br><span class="line"><span class="keyword">left</span> <span class="keyword">join</span> t_dept d</span><br><span class="line"><span class="keyword">on</span> e.deptId<span class="operator">=</span>d.id</span><br><span class="line"><span class="keyword">WHERE</span> e.deptid <span class="keyword">is</span> <span class="keyword">NULL</span></span><br><span class="line"><span class="keyword">UNION</span> <span class="keyword">ALL</span></span><br><span class="line"><span class="keyword">select</span> e.name,d.deptname</span><br><span class="line"><span class="keyword">from</span>  t_dept d</span><br><span class="line"><span class="keyword">left</span> <span class="keyword">join</span> t_emp e</span><br><span class="line"><span class="keyword">on</span> d.id <span class="operator">=</span> e.deptid</span><br><span class="line"><span class="keyword">where</span> e.deptid <span class="keyword">is</span> <span class="keyword">NULL</span></span><br></pre></td></tr></table></figure>





<h3 id="06章-多表查询的课后练习"><a href="#06章-多表查询的课后练习" class="headerlink" title="06章 多表查询的课后练习"></a>06章 多表查询的课后练习</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 1.显示所有员工的姓名，部门号和部门名称。</span></span><br><span class="line"><span class="keyword">SELECT</span> e.last_name,e.department_id,d.department_name</span><br><span class="line"><span class="keyword">FROM</span> employees e <span class="keyword">LEFT</span> <span class="keyword">OUTER</span> <span class="keyword">JOIN</span> departments d</span><br><span class="line"><span class="keyword">ON</span> e.department_id <span class="operator">=</span> d.department_id;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 2.查询90号部门员工的job_id和90号部门的location_id</span></span><br><span class="line"><span class="keyword">SELECT</span> e.job_id,d.location_id</span><br><span class="line"><span class="keyword">FROM</span> employees e <span class="keyword">JOIN</span> departments d</span><br><span class="line"><span class="keyword">ON</span> e.department_id <span class="operator">=</span> d.department_id</span><br><span class="line"><span class="keyword">WHERE</span> d.department_id <span class="operator">=</span> <span class="number">90</span>;<span class="operator">|</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 3.选择所有有奖金的员工的last_name，department_name，location_1d，c1ty，</span></span><br><span class="line"><span class="keyword">SELECT</span> e.last_name ,e.commission_pct,d.department_name,d.location_id,l.city</span><br><span class="line"><span class="keyword">FROM</span> employees e <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> departments d</span><br><span class="line"><span class="keyword">ON</span> e.department_id <span class="operator">=</span> d.department_id</span><br><span class="line">LEET <span class="keyword">JOIN</span> locations l</span><br><span class="line"><span class="keyword">ON</span> d.location_id <span class="operator">=</span> l.location_id</span><br><span class="line"><span class="keyword">WHERE</span> e.commission_pct <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span>;  <span class="comment">-- 也应该是35条记录</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 4.选择city在Toronto工作的员工的 last_name,job_id, department_id, department_name</span></span><br><span class="line"><span class="keyword">SELECT</span> e.last_name,e.job_id,e.department_id,d.department_name</span><br><span class="line"><span class="keyword">FROM</span> employees e <span class="keyword">JOIN</span> departments d</span><br><span class="line"><span class="keyword">ON</span> e.department_id <span class="operator">=</span> d.department_id</span><br><span class="line"><span class="keyword">JOIN</span> locations l</span><br><span class="line"><span class="keyword">ON</span> d.location_id <span class="operator">=</span> l.location_id</span><br><span class="line"><span class="keyword">WHERE</span> l.city <span class="operator">=</span> <span class="string">&#x27;Toronto&#x27;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 5.查询员工所在的部门名称、部门地址、姓名、工作、工资，其中员工所在部门的部门名称为&#x27;Executive&#x27;</span></span><br><span class="line"><span class="keyword">SELECT</span> d.department_name,l.street_ADDress,e.last_name,e.job_id,e.salary</span><br><span class="line"><span class="keyword">FROM</span> departments d <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> employees e</span><br><span class="line"><span class="keyword">ON</span> e.department_id <span class="operator">=</span> d.department_id</span><br><span class="line"><span class="keyword">LEFT</span> <span class="keyword">JOIN</span> locations l</span><br><span class="line"><span class="keyword">ON</span> d.location_id <span class="operator">=</span> l.location_id</span><br><span class="line"><span class="keyword">WHERE</span> d.department_name <span class="operator">=</span> <span class="string">&#x27;Executive&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">DESC</span> departments;</span><br><span class="line"><span class="keyword">DESC</span> locations;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 6.选择指定员工的姓名，员工号，以及他的管理者的姓名和员工号，结果类似于下面的格式</span></span><br><span class="line">employees  Emp#  manager  Mgr#</span><br><span class="line">kochhar    <span class="number">101</span>   king     <span class="number">100</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> emp.last_name &quot;employees&quot;,emp.employee_id &quot;Emp#&quot;,mgr.last_name &quot;manager&quot;,mgr.employee_id &quot;Mgr#&quot;</span><br><span class="line"><span class="keyword">FROM</span> employees emp <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> employees mgr</span><br><span class="line"><span class="keyword">ON</span> emp.manager_id <span class="operator">=</span> mgr.employee_id;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 7.查询哪些部门没有员工</span></span><br><span class="line"><span class="keyword">SELECT</span> d.department_id</span><br><span class="line"><span class="keyword">FROM</span> departments d <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> employees e</span><br><span class="line"><span class="keyword">ON</span> d.department_id <span class="operator">=</span> e.department_id</span><br><span class="line"><span class="keyword">WHERE</span> e.department_id <span class="keyword">IS</span> <span class="keyword">NULL</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 8.查询哪个城市没有部门</span></span><br><span class="line"><span class="keyword">SELECT</span> l.location_id,l.city</span><br><span class="line"><span class="keyword">FROM</span> locations l <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> departments d</span><br><span class="line"><span class="keyword">ON</span> l.location_id <span class="operator">=</span> d.location id</span><br><span class="line"><span class="keyword">WHERE</span> d.location_id <span class="keyword">IS</span> <span class="keyword">NULL</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 9.查询部门名为Sales或IT的员工信息</span></span><br><span class="line"><span class="keyword">SELECT</span> e.employee_id,e.last_name,e.department_id</span><br><span class="line"><span class="keyword">FROM</span> employees e <span class="keyword">JOIN</span> departments d</span><br><span class="line"><span class="keyword">ON</span> e.department_id <span class="operator">=</span> d.department_id</span><br><span class="line"><span class="keyword">WHERE</span> d.department_name <span class="keyword">IN</span> (<span class="string">&#x27;Sales&#x27;</span>,<span class="string">&#x27;IT&#x27;</span>);</span><br></pre></td></tr></table></figure>







<h3 id="第7章-单行函数"><a href="#第7章-单行函数" class="headerlink" title="第7章 单行函数"></a>第7章 单行函数</h3><h1 id="二、数值函数"><a href="#二、数值函数" class="headerlink" title="二、数值函数"></a>二、数值函数</h1><h2 id="1、基本函数"><a href="#1、基本函数" class="headerlink" title="1、基本函数"></a>1、基本函数</h2><table>
<thead>
<tr>
<th>函数</th>
<th>用法</th>
</tr>
</thead>
<tbody><tr>
<td>ABS(x)</td>
<td>返回x的绝对值</td>
</tr>
<tr>
<td>SIGN(X)</td>
<td>返回X的符号。正数返回1，负数返回-1，0返回0</td>
</tr>
<tr>
<td>PI()</td>
<td>返回圆周率的值</td>
</tr>
<tr>
<td>CEIL(x)，CEILING(x)</td>
<td>返回大于或等于某个值的最小整数</td>
</tr>
<tr>
<td>FLOOR(x)</td>
<td>返回小于或等于某个值的最大整数</td>
</tr>
<tr>
<td>LEAST(e1,e2,e3…)</td>
<td>返回列表中的最小值</td>
</tr>
<tr>
<td>GREATEST(e1,e2,e3…)</td>
<td>返回列表中的最大值</td>
</tr>
<tr>
<td>MOD(x,y)</td>
<td>返回X除以Y后的余数</td>
</tr>
<tr>
<td><strong>RAND()</strong></td>
<td>返回0~1的随机值</td>
</tr>
<tr>
<td>RAND(x)</td>
<td>返回0~1的随机值，其中x的值用作种子值，相同的X值会产生相同的随机数</td>
</tr>
<tr>
<td><strong>ROUND(x)</strong></td>
<td>返回一个对x的值进行四舍五入后，最接近于X的整数</td>
</tr>
<tr>
<td><strong>ROUND(x,y)</strong></td>
<td>返回一个对x的值进行四舍五入后最接近X的值，并保留到小数点后面Y位</td>
</tr>
<tr>
<td><strong>TRUNCATE(x,y)</strong></td>
<td>返回数字x截断为y位小数的结果</td>
</tr>
<tr>
<td>SQRT(x)</td>
<td>返回x的平方根。当X的值为负数时，返回NULL</td>
</tr>
</tbody></table>
<p>举例：</p>
<h5 id="基本的操作"><a href="#基本的操作" class="headerlink" title="基本的操作"></a>基本的操作</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="built_in">ABS</span>(<span class="number">-123</span>),<span class="built_in">ABS</span>(<span class="number">32</span>),SIGN(<span class="number">-23</span>),SIGN(<span class="number">43</span>),PI(),</span><br><span class="line"><span class="built_in">CEIL</span>(<span class="number">32.32</span>),<span class="built_in">CEILING</span>(<span class="number">-43.23</span>),<span class="built_in">FLOOR</span>(<span class="number">32.32</span>),</span><br><span class="line"><span class="built_in">FLOOR</span>(<span class="number">-43.23</span>),<span class="built_in">MOD</span>(<span class="number">12</span>,<span class="number">5</span>),<span class="number">12</span> MOD <span class="number">5</span>,<span class="number">12</span> <span class="operator">%</span> <span class="number">5</span></span><br><span class="line"><span class="keyword">FROM</span> DUAL;</span><br></pre></td></tr></table></figure>

<h5 id="取随机数"><a href="#取随机数" class="headerlink" title="取随机数"></a>取随机数</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> RAND(),RAND(),RAND(<span class="number">10</span>),RAND(<span class="number">10</span>),RAND(<span class="number">-1</span>),RAND(<span class="number">-1</span>) <span class="comment">--伪随机数</span></span><br><span class="line"><span class="keyword">FROM</span> DUAL;</span><br></pre></td></tr></table></figure>

<h5 id="四舍五入"><a href="#四舍五入" class="headerlink" title="四舍五入"></a>四舍五入</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> ROUND(<span class="number">123.456</span>),ROUND(<span class="number">123.456</span>,<span class="number">0</span>),ROUND(<span class="number">123.456</span>,<span class="number">1</span>),ROUND(<span class="number">123.456</span>,<span class="number">2</span>),</span><br><span class="line">ROUND(<span class="number">123.456</span>,<span class="number">-1</span>),ROUND(<span class="number">123.456</span>,<span class="number">-2</span>)</span><br><span class="line"><span class="keyword">FROM</span> DUAL;</span><br></pre></td></tr></table></figure>

<h5 id="截断操作"><a href="#截断操作" class="headerlink" title="截断操作"></a>截断操作</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">TRUNCATE</span>(<span class="number">123.456</span>,<span class="number">0</span>),<span class="keyword">TRUNCATE</span>(<span class="number">123.456</span>,<span class="number">1</span>),<span class="keyword">TRUNCATE</span>(<span class="number">123.456</span>,<span class="number">-1</span>)</span><br><span class="line"><span class="keyword">FROM</span> DUAL;</span><br></pre></td></tr></table></figure>

<h5 id="单行函数可以嵌套"><a href="#单行函数可以嵌套" class="headerlink" title="单行函数可以嵌套"></a>单行函数可以嵌套</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">TRUNCATE</span>(ROUND(<span class="number">123.456</span>, <span class="number">2</span>),<span class="number">0</span>)</span><br><span class="line"><span class="keyword">FROM</span> DUAL;</span><br></pre></td></tr></table></figure>



<h2 id="2、角度与弧度互换函数"><a href="#2、角度与弧度互换函数" class="headerlink" title="2、角度与弧度互换函数"></a>2、角度与弧度互换函数</h2><p>因为三角函数需要用弧度值，所以需要进行角度和弧度的互换</p>
<table>
<thead>
<tr>
<th>函数</th>
<th>用法</th>
</tr>
</thead>
<tbody><tr>
<td>RADIANS(x)</td>
<td>将角度转化为弧度，其中，参数x为角度值</td>
</tr>
<tr>
<td>DEGREES(x)</td>
<td>将弧度转化为角度，其中，参数x为弧度值</td>
</tr>
</tbody></table>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> RADIANS(<span class="number">30</span>),RADIANS(<span class="number">45</span>),RADIANS(<span class="number">60</span>),RADIANS(<span class="number">90</span>),</span><br><span class="line">DEGREES(<span class="number">2</span><span class="operator">*</span>PI()),DEGREES(RADIANS(<span class="number">60</span>))</span><br><span class="line"><span class="keyword">FROM</span> DUAL;</span><br></pre></td></tr></table></figure>





<h2 id="3、三角函数"><a href="#3、三角函数" class="headerlink" title="3、三角函数"></a>3、三角函数</h2><table>
<thead>
<tr>
<th>函数</th>
<th>用法</th>
</tr>
</thead>
<tbody><tr>
<td>SIN(x)</td>
<td>返回x的正弦值，其中，参数x为弧度值</td>
</tr>
<tr>
<td>ASIN(x)</td>
<td>返回x的反正弦值，即获取正弦为x的值。如果x的值不在-1到1之间，则返回NULL</td>
</tr>
<tr>
<td>COS(x)</td>
<td>返回x的余弦值，其中，参数x为弧度值</td>
</tr>
<tr>
<td>ACOS(x)</td>
<td>返回x的反余弦值，即获取余弦为x的值。如果x的值不在-1到1之间，则返回NULL</td>
</tr>
<tr>
<td>TAN(x)</td>
<td>返回x的正切值，其中，参数x为弧度值</td>
</tr>
<tr>
<td>ATAN(x)</td>
<td>返回x的反正切值，即返回正切值为x的值</td>
</tr>
<tr>
<td>ATAN2(m,n)</td>
<td>返回两个参数的反正切值</td>
</tr>
<tr>
<td>COT(x)</td>
<td>返回x的余切值，其中，X为弧度值</td>
</tr>
</tbody></table>
<p>三角函数</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="built_in">SIN</span>(RADIANS(<span class="number">30</span>)),DEGREES(<span class="built_in">ASIN</span>(<span class="number">1</span>)),<span class="built_in">TAN</span>(RADIANS(<span class="number">45</span>)),DEGREES(<span class="built_in">ATAN</span>(<span class="number">1</span>))</span><br><span class="line"><span class="keyword">FROM</span> DUAL;</span><br></pre></td></tr></table></figure>



<h2 id="4、指数与对数"><a href="#4、指数与对数" class="headerlink" title="4、指数与对数"></a>4、指数与对数</h2><table>
<thead>
<tr>
<th>函数</th>
<th>用法</th>
</tr>
</thead>
<tbody><tr>
<td>POW(x,y)，POWER(X,Y)</td>
<td>返回x的y次方</td>
</tr>
<tr>
<td>EXP(X)</td>
<td>返回e的X次方，其中e是一个常数，2.718281828459045</td>
</tr>
<tr>
<td>LN(X)，LOG(X)</td>
<td>返回以e为底的X的对数，当X &lt;&#x3D; 0 时，返回的结果为NULL</td>
</tr>
<tr>
<td>LOG10(X)</td>
<td>返回以10为底的X的对数，当X &lt;&#x3D; 0 时，返回的结果为NULL</td>
</tr>
<tr>
<td>LOG2(X)</td>
<td>返回以2为底的X的对数，当X &lt;&#x3D; 0 时，返回NULL</td>
</tr>
</tbody></table>
<p>指数与对数</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> POW(<span class="number">2</span>,<span class="number">5</span>),<span class="built_in">POWER</span>(<span class="number">2</span>,<span class="number">4</span>),<span class="built_in">EXP</span>(<span class="number">2</span>)</span><br><span class="line"><span class="keyword">FROM</span> DUAL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">LN</span>(<span class="built_in">EXP</span>(<span class="number">2</span>)),<span class="built_in">LOG</span>(<span class="built_in">EXP</span>(<span class="number">2</span>)),<span class="built_in">LOG10</span>(<span class="number">10</span>),LOG2(<span class="number">4</span>)</span><br><span class="line"><span class="keyword">FROM</span> DUAL;</span><br></pre></td></tr></table></figure>



<h2 id="5、进制间的转换"><a href="#5、进制间的转换" class="headerlink" title="5、进制间的转换"></a>5、进制间的转换</h2><table>
<thead>
<tr>
<th>函数</th>
<th>用法</th>
</tr>
</thead>
<tbody><tr>
<td>BIN(x)</td>
<td>返回x的二进制编码</td>
</tr>
<tr>
<td>HEX(x)</td>
<td>返回x的十六进制编码</td>
</tr>
<tr>
<td>OCT(x)</td>
<td>返回x的八进制编码</td>
</tr>
<tr>
<td>CONV(x,f1,f2)</td>
<td>返回f1进制数变成f2进制数</td>
</tr>
</tbody></table>
<p>进制间的转换</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> BIN(<span class="number">10</span>),HEX(<span class="number">10</span>),OCT(<span class="number">10</span>),CONV(<span class="number">10</span>,<span class="number">10</span>,<span class="number">8</span>)</span><br><span class="line"><span class="keyword">FROM</span> DUAL;</span><br></pre></td></tr></table></figure>





<h1 id="三、字符串函数"><a href="#三、字符串函数" class="headerlink" title="三、字符串函数"></a>三、<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=%E5%AD%97%E7%AC%A6%E4%B8%B2&spm=1001.2101.3001.7020">字符串</a>函数</h1><table>
<thead>
<tr>
<th>函数</th>
<th>用法</th>
</tr>
</thead>
<tbody><tr>
<td>ASCII(S)</td>
<td>返回字符串S中的第一个字符的ASCII码值</td>
</tr>
<tr>
<td>CHAR_LENGTH(s)</td>
<td>返回字符串s的字符数。作用与CHARACTER_LENGTH(s)相同</td>
</tr>
<tr>
<td>LENGTH(s)</td>
<td>返回字符串s的字节数，和字符集有关</td>
</tr>
<tr>
<td>CONCAT(s1,s2,…,sn)</td>
<td>连接s1,s2,…,sn为一个字符串</td>
</tr>
<tr>
<td>CONCAT_WS(x, s1,s2,…,sn)</td>
<td>同CONCAT(s1,s2,…)函数，但是每个字符串之间要加上x</td>
</tr>
<tr>
<td>INSERT(str, idx, len, replacestr)</td>
<td>将字符串str从第idx位置开始，len个字符长的子串替换为字符串replacestr</td>
</tr>
<tr>
<td>REPLACE(str, a, b)</td>
<td>用字符串b替换字符串str中所有出现的字符串a</td>
</tr>
<tr>
<td>UPPER(s) 或 UCASE(s)</td>
<td>将字符串s的所有字母转成大写字母</td>
</tr>
<tr>
<td>LOWER(s) 或LCASE(s)</td>
<td>将字符串s的所有字母转成小写字母</td>
</tr>
<tr>
<td>LEFT(str,n)</td>
<td>返回字符串str最左边的n个字符</td>
</tr>
<tr>
<td>RIGHT(str,n)</td>
<td>返回字符串str最右边的n个字符</td>
</tr>
<tr>
<td>LPAD(str, len, pad)</td>
<td>用字符串pad对str最左边进行填充，直到str的长度为len个字符</td>
</tr>
<tr>
<td>RPAD(str ,len, pad)</td>
<td>用字符串pad对str最右边进行填充，直到str的长度为len个字符</td>
</tr>
<tr>
<td>LTRIM(s)</td>
<td>去掉字符串s左侧的空格</td>
</tr>
<tr>
<td>RTRIM(s)</td>
<td>去掉字符串s右侧的空格</td>
</tr>
<tr>
<td>TRIM(s)</td>
<td>去掉字符串s开始与结尾的空格</td>
</tr>
<tr>
<td>TRIM(s1 FROM s)</td>
<td>去掉字符串s开始与结尾的s1</td>
</tr>
<tr>
<td>TRIM(LEADING s1 FROM s)</td>
<td>去掉字符串s开始处的s1</td>
</tr>
<tr>
<td>TRIM(TRAILING s1 FROM s)</td>
<td>去掉字符串s结尾处的s1</td>
</tr>
<tr>
<td>REPEAT(str, n)</td>
<td>返回str重复n次的结果</td>
</tr>
<tr>
<td>SPACE(n)</td>
<td>返回n个空格</td>
</tr>
<tr>
<td>STRCMP(s1,s2)</td>
<td>比较字符串s1,s2的ASCII码值的大小</td>
</tr>
<tr>
<td>SUBSTR(s,index,len)</td>
<td>返回从字符串s的index位置其len个字符，作用与SUBSTRING(s,n,len)、MID(s,n,len)相同</td>
</tr>
<tr>
<td>LOCATE(substr,str)</td>
<td>返回字符串substr在字符串str中首次出现的位置，作用于POSITION(substr IN str)、INSTR(str,substr)相同。未找到，返回0</td>
</tr>
<tr>
<td>ELT(m,s1,s2,…,sn)</td>
<td>返回指定位置的字符串，如果m&#x3D;1，则返回s1，如果m&#x3D;2，则返回s2，如果m&#x3D;n，则返回sn</td>
</tr>
<tr>
<td>FIELD(s,s1,s2,…,sn)</td>
<td>返回字符串s在字符串列表中第一次出现的位置</td>
</tr>
<tr>
<td>FIELD(s,s1,s2,…,sn)返回字符串s在字符串列表中第一次出现的位置FIND_IN_SET(s1,s2)</td>
<td>返回字符串s1在字符串s2中出现的位置。其中，字符串s2是一个以逗号分隔的字符串</td>
</tr>
<tr>
<td>REVERSE(s)</td>
<td>返回s反转后的字符串</td>
</tr>
<tr>
<td>NULLIF(value1,value2)</td>
<td>比较两个字符串，如果value1与value2相等，则返回NULL，否则返回value1</td>
</tr>
</tbody></table>
<blockquote>
<p>注意：MySQL中，字符串的位置是从1开始的。</p>
</blockquote>
<blockquote>
<p>LPAD：实现右对齐效果<br>RPAD：实现左对齐效果</p>
</blockquote>
<p>字符串函数</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> ASCII(<span class="string">&#x27;Abcdfsf&#x27;</span>),<span class="keyword">CHAR_LENGTH</span>(<span class="string">&#x27;hello&#x27;</span>),<span class="keyword">CHAR_LENGTH</span>(<span class="string">&#x27;我们&#x27;</span>),</span><br><span class="line">LENGTH(<span class="string">&#x27;hello&#x27;</span>),LENGTH(<span class="string">&#x27;我们&#x27;</span>)</span><br><span class="line"><span class="keyword">FROM</span> DUAL;</span><br></pre></td></tr></table></figure>

<p>xxx worked for yyy</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> CONCAT(emp.last_name,<span class="string">&#x27; worked for &#x27;</span>,mgr.last_name) &quot;details&quot;</span><br><span class="line"><span class="keyword">FROM</span> employees emp <span class="keyword">JOIN</span> employees mgr</span><br><span class="line"><span class="keyword">WHERE</span> emp.manager_id <span class="operator">=</span> mgr.employee_id;</span><br></pre></td></tr></table></figure>



<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> CONCAT_WS(<span class="string">&#x27;-&#x27;</span>,<span class="string">&#x27;hello&#x27;</span>,<span class="string">&#x27;world&#x27;</span>,<span class="string">&#x27;hello&#x27;</span>,<span class="string">&#x27;beijing&#x27;</span>)</span><br><span class="line"><span class="keyword">FROM</span> DUAL;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 字符串的索引是从1开始的!</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">INSERT</span>(<span class="string">&#x27;helloworld&#x27;</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="string">&#x27;aaaaa&#x27;</span>),REPLACE(<span class="string">&#x27;hello&#x27;</span>,<span class="string">&#x27;ll&#x27;</span>,<span class="string">&#x27;mmm&#x27;</span>)</span><br><span class="line"><span class="keyword">FROM</span> DUAL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">UPPER</span>(<span class="string">&#x27;HelLo&#x27;</span>),<span class="built_in">LOWER</span>(<span class="string">&#x27;HelLo&#x27;</span>)</span><br><span class="line"><span class="keyword">FROM</span> DUAL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> last_name,salary</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">WHERE</span> last_name <span class="operator">=</span> <span class="string">&#x27;King&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> last_name,salary</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">WHERE</span> <span class="built_in">LOWER</span>(last_name) <span class="operator">=</span> <span class="string">&#x27;King&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">LEFT</span>(<span class="string">&#x27;hello&#x27;</span>,<span class="number">2</span>),<span class="keyword">RIGHT</span>(<span class="string">&#x27;hello&#x27;</span>,<span class="number">3</span>),RGHT(<span class="string">&#x27;hello&#x27;</span>,<span class="number">13</span>)</span><br><span class="line"><span class="keyword">FROM</span> DUAL;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- LPAD:实现右对齐效果</span></span><br><span class="line"><span class="comment">-- RPAD:实现左对齐效果</span></span><br><span class="line"><span class="keyword">SELECT</span> employee_id,last_name,LPAD(salary,<span class="number">10</span>,<span class="string">&#x27;*&#x27;</span>)</span><br><span class="line"><span class="keyword">FROM</span> employees;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> CONCAT(<span class="string">&#x27;---&#x27;</span>,<span class="built_in">TRIM</span>(<span class="string">&#x27;   h  el  lo   &#x27;</span>),<span class="string">&#x27;***&#x27;</span>)</span><br><span class="line"><span class="keyword">FROM</span> DUAL;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> CONCAT(<span class="string">&#x27;---&#x27;</span>,LTRIM(<span class="string">&#x27;   h  el  lo   &#x27;</span>),<span class="string">&#x27;***&#x27;</span>)</span><br><span class="line"><span class="built_in">TRIM</span>(<span class="string">&#x27;o&#x27;</span> <span class="keyword">FROM</span> <span class="string">&#x27;ooheollo&#x27;</span>)</span><br><span class="line"><span class="keyword">FROM</span> DUAL;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> REPEAT(<span class="string">&#x27;hello&#x27;</span>,<span class="number">4</span>)</span><br><span class="line"><span class="keyword">FROM</span> DUAL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> REPEAT(<span class="string">&#x27;hello&#x27;</span>,<span class="number">4</span>),LENGTH(SPACE(<span class="number">5</span>)),STRCMP(<span class="string">&#x27;abc&#x27;</span>,<span class="string">&#x27;abd&#x27;</span>)</span><br><span class="line"><span class="keyword">FROM</span> DUAL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> SUBSTR(<span class="string">&#x27;hello&#x27;</span>,<span class="number">2</span>,<span class="number">2</span>),LOCATE(<span class="string">&#x27;lll&#x27;</span>, <span class="string">&#x27;hello&#x27;</span>)</span><br><span class="line"><span class="keyword">FROM</span> DUAL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> ELT(<span class="number">2</span>,<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;c&#x27;</span>,<span class="string">&#x27;d&#x27;</span>),FIELD(<span class="string">&#x27;mm&#x27;</span>,<span class="string">&#x27;gg&#x27;</span>,<span class="string">&#x27;jj&#x27;</span>,<span class="string">&#x27;mm&#x27;</span>,<span class="string">&#x27;dd&#x27;</span>,<span class="string">&#x27;mm&#x27;</span>),</span><br><span class="line">FIND_IN_SET(<span class="string">&#x27;mm&#x27;</span>,<span class="string">&#x27;gg,mm,jj,dd,mm,gg&#x27;</span>)</span><br><span class="line"><span class="keyword">FROM</span> DUAL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> employee_id,<span class="built_in">NULLIF</span>(LENGTH(first_name),LENGTH(last_name)) &quot;compare&quot;</span><br><span class="line"><span class="keyword">FROM</span> employees;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h1 id="四、日期和时间函数"><a href="#四、日期和时间函数" class="headerlink" title="四、日期和时间函数"></a>四、日期和时间函数</h1><h2 id="1、获取日期、时间"><a href="#1、获取日期、时间" class="headerlink" title="1、获取日期、时间"></a>1、获取日期、时间</h2><table>
<thead>
<tr>
<th>函数</th>
<th>用法</th>
</tr>
</thead>
<tbody><tr>
<td><strong>CURDATE()</strong> ，CURRENT_DATE()</td>
<td>返回当前日期，只包含年、月、日</td>
</tr>
<tr>
<td><strong>CURTIME()</strong> ， CURRENT_TIME()</td>
<td>返回当前时间，只包含时、分、秒</td>
</tr>
<tr>
<td><strong>NOW()</strong> &#x2F; SYSDATE() &#x2F; CURRENT_TIMESTAMP() &#x2F; LOCALTIME() &#x2F; LOCALTIMESTAMP()</td>
<td>返回当前系统日期和时间</td>
</tr>
<tr>
<td>UTC_DATE()</td>
<td>返回UTC（世界标准时间）日期</td>
</tr>
<tr>
<td>UTC_TIME()</td>
<td>返回UTC（世界标准时间）时间</td>
</tr>
</tbody></table>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 3.日期和时间函数</span></span><br><span class="line"><span class="comment">-- 3.1 获取日期、时间</span></span><br><span class="line"><span class="keyword">SELECT</span> CURDATE(),<span class="built_in">CURRENT_DATE</span>(),CURTIME(),NOW(),SYSDATE(),</span><br><span class="line">UTC_DATE(),UTC_TIME()</span><br><span class="line"><span class="keyword">FROM</span> DUAL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> CURDATE(),CURTIME(),NOW(),SYSDATE()<span class="operator">+</span><span class="number">0</span>,UTC_DATE(),UTC_DATE()<span class="operator">+</span><span class="number">0</span>,UTC_TIME(),UTC_TIME()<span class="operator">+</span><span class="number">0</span></span><br><span class="line"><span class="keyword">FROM</span> DUAL;</span><br></pre></td></tr></table></figure>



<h2 id="2、日期与时间戳的转换"><a href="#2、日期与时间戳的转换" class="headerlink" title="2、日期与时间戳的转换"></a>2、日期与<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=%E6%97%B6%E9%97%B4%E6%88%B3&spm=1001.2101.3001.7020">时间戳</a>的转换</h2><p>时间戳是指格林威治时间自1970年1月1日（00:00:00 GMT）至当前时间的总秒数。它也被称为Unix时间戳（Unix Timestamp）。通俗的讲，时间戳是一份能够表示一份数据在一个特定时间点已经存在的完整的可验证的数据。</p>
<table>
<thead>
<tr>
<th>函数</th>
<th>用法</th>
</tr>
</thead>
<tbody><tr>
<td>UNIX_TIMESTAMP()</td>
<td>以UNIX时间戳的形式返回当前时间。SELECT UNIX_TIMESTAMP() -&gt;1634348884</td>
</tr>
<tr>
<td>UNIX_TIMESTAMP(date)</td>
<td>将时间date以UNIX时间戳的形式返回。</td>
</tr>
<tr>
<td>FROM_UNIXTIME(timestamp)</td>
<td>将UNIX时间戳的时间转换为普通格式的时间</td>
</tr>
</tbody></table>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> UNIX_TIMESTAMP(),UNIX_TIMESTAMP(&quot;2022-1-19 19:06:22&quot;),</span><br><span class="line">FROM_UNIXTIME(<span class="number">1642589008</span>),FROM_UNIXTIME(<span class="number">1642590382</span>)</span><br><span class="line"><span class="keyword">FROM</span> DUAL</span><br></pre></td></tr></table></figure>

<h2 id="3、获取月份、星期、星期数、天数等函数"><a href="#3、获取月份、星期、星期数、天数等函数" class="headerlink" title="3、获取月份、星期、星期数、天数等函数"></a>3、获取月份、星期、星期数、天数等函数</h2><table>
<thead>
<tr>
<th>函数</th>
<th>用法</th>
</tr>
</thead>
<tbody><tr>
<td>YEAR(date) &#x2F; MONTH(date) &#x2F; DAY(date)</td>
<td>返回具体的日期值</td>
</tr>
<tr>
<td>函数用法YEAR(date) &#x2F; MONTH(date) &#x2F; DAY(date)返回具体的日期值HOUR(time) &#x2F; MINUTE(time) &#x2F; SECOND(time)</td>
<td>返回具体的时间值</td>
</tr>
<tr>
<td>MONTHNAME(date)</td>
<td>返回月份：January，…</td>
</tr>
<tr>
<td>DAYNAME(date)</td>
<td>返回星期几：MONDAY，TUESDAY…SUNDAY</td>
</tr>
<tr>
<td>WEEKDAY(date)</td>
<td>返回周几，注意，周1是0，周2是1，。。。周日是6</td>
</tr>
<tr>
<td>QUARTER(date)</td>
<td>返回日期对应的季度，范围为1～4</td>
</tr>
<tr>
<td>WEEK(date) ， WEEKOFYEAR(date)</td>
<td>返回一年中的第几周</td>
</tr>
<tr>
<td>DAYOFYEAR(date)</td>
<td>返回日期是一年中的第几天</td>
</tr>
<tr>
<td>DAYOFMONTH(date)</td>
<td>返回日期位于所在月份的第几天</td>
</tr>
<tr>
<td>DAYOFWEEK(date)</td>
<td>返回周几，注意：周日是1，周一是2，。。。周六是7</td>
</tr>
</tbody></table>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 3.3获取月份、星期、星期数、天数等函数</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">YEAR</span>(CURDATE()),<span class="keyword">MONTH</span>(CURDATE()),<span class="keyword">DAY</span>(CURDATE()),</span><br><span class="line"><span class="keyword">HOUR</span>(CURTIME()),<span class="keyword">MINUTE</span>(NOW()),<span class="keyword">SECOND</span>(SYSDATE())</span><br><span class="line"><span class="keyword">FROM</span> DUAL;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> MONTHNAME(<span class="string">&#x27;2021-10-26&#x27;</span>),DAYNAME(<span class="string">&#x27;2021-10-26&#x27;</span>),WEEKDAY(<span class="string">&#x27;2021-10-26&#x27;</span>),</span><br><span class="line">QUARTER(CURDATE()),WEEK(CURDATE()),DAYOFYEAR(NOW()),</span><br><span class="line">DAYOFMONTH(NOW()),DAYOFWEEK(NOW())</span><br><span class="line"><span class="keyword">FROM</span> DUAL;</span><br></pre></td></tr></table></figure>



<h2 id="4、日期的操作函数"><a href="#4、日期的操作函数" class="headerlink" title="4、日期的操作函数"></a>4、日期的操作函数</h2><table>
<thead>
<tr>
<th>函数</th>
<th>用法</th>
</tr>
</thead>
<tbody><tr>
<td>EXTRACT(type FROM date)</td>
<td>返回指定日期中特定的部分，type指定返回的值</td>
</tr>
</tbody></table>
<p>EXTRACT(type FROM date)函数中type的取值与含义：</p>
<table>
<thead>
<tr>
<th>type取值</th>
<th>含义</th>
</tr>
</thead>
<tbody><tr>
<td>MICROSECOND</td>
<td>返回毫秒数</td>
</tr>
<tr>
<td>SECOND</td>
<td>返回秒数</td>
</tr>
<tr>
<td>MINUTE</td>
<td>返回分钟数</td>
</tr>
<tr>
<td>HOUR</td>
<td>返回小时数</td>
</tr>
<tr>
<td>DAY</td>
<td>返回天数</td>
</tr>
<tr>
<td>WEEK</td>
<td>返回日期在一年中的第几个星期</td>
</tr>
<tr>
<td>MONTH</td>
<td>返回日期在一年中的第几个月</td>
</tr>
<tr>
<td>QUARTER</td>
<td>返回日期在一年中的第几个季度</td>
</tr>
<tr>
<td>YEAR</td>
<td>返回日期的年份</td>
</tr>
<tr>
<td>SECOND_MICROSECOND</td>
<td>返回秒和毫秒值</td>
</tr>
<tr>
<td>MINUTE_MICROSECOND</td>
<td>返回分钟和毫秒值</td>
</tr>
<tr>
<td>MINUTE_SECOND</td>
<td>返回分钟和秒值</td>
</tr>
<tr>
<td>HOUR_MICROSECOND</td>
<td>返回小时和毫秒值</td>
</tr>
<tr>
<td>HOUR_SECOND</td>
<td>返回小时和秒值</td>
</tr>
<tr>
<td>HOUR_MINUTE</td>
<td>返回小时和分钟值</td>
</tr>
<tr>
<td>DAY_MICROSECOND</td>
<td>返回天和毫秒值</td>
</tr>
<tr>
<td>DAY_SECOND</td>
<td>返回天和秒值</td>
</tr>
<tr>
<td>DAY_MINUTE</td>
<td>返回天和分钟值</td>
</tr>
<tr>
<td>DAY_HOUR</td>
<td>返回天和小时</td>
</tr>
<tr>
<td>YEAR_MONTH</td>
<td>返回年和月</td>
</tr>
</tbody></table>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="built_in">EXTRACT</span>(<span class="keyword">MINUTE</span> <span class="keyword">FROM</span> NOW()),<span class="built_in">EXTRACT</span>( WEEK <span class="keyword">FROM</span> NOW()),</span><br><span class="line"><span class="built_in">EXTRACT</span>( QUARTER <span class="keyword">FROM</span> NOW()),<span class="built_in">EXTRACT</span>( MINUTE_SECOND <span class="keyword">FROM</span> NOW())</span><br><span class="line"><span class="keyword">FROM</span> DUAL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">EXTRACT</span>(<span class="keyword">SECOND</span> <span class="keyword">FROM</span> NOW()),<span class="built_in">EXTRACT</span>(<span class="keyword">DAY</span> <span class="keyword">FROM</span> NOW()),</span><br><span class="line"><span class="built_in">EXTRACT</span>(HOUR_MINUTE <span class="keyword">FROM</span> NOW()), <span class="built_in">EXTRACT</span> (QUARTER <span class="keyword">FROM</span> <span class="string">&#x27;2021-05-12&#x27;</span>)</span><br><span class="line"><span class="keyword">FROM</span> DUAL;</span><br></pre></td></tr></table></figure>



<h2 id="5、时间和秒钟转换的函数"><a href="#5、时间和秒钟转换的函数" class="headerlink" title="5、时间和秒钟转换的函数"></a>5、时间和秒钟转换的函数</h2><table>
<thead>
<tr>
<th>函数</th>
<th>用法</th>
</tr>
</thead>
<tbody><tr>
<td>TIME_TO_SEC(time)</td>
<td>将 time 转化为秒并返回结果值。转化的公式为：<code>小时*3600+分钟*60+秒</code></td>
</tr>
<tr>
<td>SEC_TO_TIME(seconds)</td>
<td>将 seconds 描述转化为包含小时、分钟和秒的时间</td>
</tr>
</tbody></table>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> TIME_TO_SEC(CURTIME()),</span><br><span class="line">SEC_TO_TIME(<span class="number">71890</span>)</span><br><span class="line"><span class="keyword">FROM</span> DUAL;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 3.5时间和秒钟转换的函数</span></span><br><span class="line"><span class="keyword">SELECT</span> TIME_TO_SEC(CURTIME()),</span><br><span class="line">SEC_TO_TIME(<span class="number">83355</span>)</span><br><span class="line"><span class="keyword">FROM</span> DUAL;</span><br></pre></td></tr></table></figure>



<h2 id="6、计算日期和时间的函数"><a href="#6、计算日期和时间的函数" class="headerlink" title="6、计算日期和时间的函数"></a>6、计算日期和时间的函数</h2><p>第一组：</p>
<table>
<thead>
<tr>
<th>函数</th>
<th>用法</th>
</tr>
</thead>
<tbody><tr>
<td>DATE_ADD(datetime, INTERVAL expr type)，ADDDATE(date,INTERVAL expr type)</td>
<td>返回与给定日期时间相差INTERVAL时间段的日期时间</td>
</tr>
<tr>
<td>DATE_SUB(date,INTERVAL expr type)，SUBDATE(date,INTERVAL expr type)</td>
<td>返回与date相差INTERVAL时间间隔的日期</td>
</tr>
</tbody></table>
<p>上述函数中type的取值：</p>
<table>
<thead>
<tr>
<th>间隔类型</th>
<th>含义</th>
</tr>
</thead>
<tbody><tr>
<td>HOUR</td>
<td>小时</td>
</tr>
<tr>
<td>MINUTE</td>
<td>分钟</td>
</tr>
<tr>
<td>SECOND</td>
<td>秒</td>
</tr>
<tr>
<td>YEAR</td>
<td>年</td>
</tr>
<tr>
<td>MONTH</td>
<td>月</td>
</tr>
<tr>
<td>DAY</td>
<td>日</td>
</tr>
<tr>
<td>YEAR_MONTH</td>
<td>年和月</td>
</tr>
<tr>
<td>DAY_HOUR</td>
<td>日和小时</td>
</tr>
<tr>
<td>DAY_MINUTE</td>
<td>日和分钟</td>
</tr>
<tr>
<td>DAY_SECOND</td>
<td>日和秒</td>
</tr>
<tr>
<td>HOUR_MINUTE</td>
<td>小时和分钟</td>
</tr>
<tr>
<td>HOUR_SECOND</td>
<td>小时和秒</td>
</tr>
<tr>
<td>MINUTE_SECOND</td>
<td>分钟和秒</td>
</tr>
</tbody></table>
<p>举例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 3.6计算日期和时间的函数</span></span><br><span class="line"><span class="keyword">SELECT</span> NOW(),DATE_ADD(NOW(),<span class="type">INTERVAL</span> <span class="number">1</span> <span class="keyword">YEAR</span>),</span><br><span class="line">DATE_ADD(NOW(), <span class="type">INTERVAL</span> <span class="number">-1</span> <span class="keyword">YEAR</span>),</span><br><span class="line">DATE_SUB(NOW(), <span class="type">INTERVAL</span> <span class="number">1</span> <span class="keyword">YEAR</span>)</span><br><span class="line"><span class="keyword">FROM</span> DUAL;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> DATE_ADD(NOW(), <span class="type">INTERVAL</span> <span class="number">1</span> <span class="keyword">DAY</span>) <span class="keyword">AS</span> col1,DATE_ADD(<span class="string">&#x27;2021-10-21 23:32:12&#x27;</span>,<span class="type">INTERVAL</span> <span class="number">1</span> <span class="keyword">SECOND</span>) <span class="keyword">AS</span> col2,</span><br><span class="line">ADDDATE(<span class="string">&#x27;2021-10-21 23:32:12&#x27;</span>,<span class="type">INTERVAL</span> <span class="number">1</span> <span class="keyword">SECOND</span>) <span class="keyword">AS</span> col3,</span><br><span class="line">DATE_ADD(<span class="string">&#x27;2021-10-21 23:32:12&#x27;</span>,<span class="type">INTERVAL</span> <span class="string">&#x27;1_1&#x27;</span> MINUTE_SECOND) <span class="keyword">AS</span> col4,</span><br><span class="line">DATE_ADD(NOW(), <span class="type">INTERVAL</span> <span class="number">-1</span> <span class="keyword">YEAR</span>) <span class="keyword">AS</span> col5, <span class="comment">--可以是负数</span></span><br><span class="line">DATE_ADD(NOW(), <span class="type">INTERVAL</span> <span class="string">&#x27;1_1&#x27;</span> YEAR_MONTH) <span class="keyword">AS</span> col6 <span class="comment">--需要单引号</span></span><br><span class="line"><span class="keyword">FROM</span> DUAL;</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> DATE_SUB(<span class="string">&#x27;2021-01-21&#x27;</span>,<span class="type">INTERVAL</span> <span class="number">31</span> <span class="keyword">DAY</span>) <span class="keyword">AS</span> col1,</span><br><span class="line">SUBDATE(<span class="string">&#x27;2021-01-21&#x27;</span>,<span class="type">INTERVAL</span> <span class="number">31</span> <span class="keyword">DAY</span>) <span class="keyword">AS</span> col2,</span><br><span class="line">DATE_SUB(<span class="string">&#x27;2021-01-21 02:01:01&#x27;</span>,<span class="type">INTERVAL</span> <span class="string">&#x27;1 1&#x27;</span> DAY_HOUR) <span class="keyword">AS</span> col3</span><br><span class="line"><span class="keyword">FROM</span> DUAL;</span><br></pre></td></tr></table></figure>

<p>第二组：</p>
<table>
<thead>
<tr>
<th>函数</th>
<th>用法</th>
</tr>
</thead>
<tbody><tr>
<td>ADDTIME(time1,time2)</td>
<td>返回time1加上time2的时间。当time2为一个数字时，代表的是<code>秒</code>，可以为负数</td>
</tr>
<tr>
<td>SUBTIME(time1,time2)</td>
<td>返回time1减去time2后的时间。当time2为一个数字时，代表的是<code>秒</code>，可以为负数</td>
</tr>
<tr>
<td>DATEDIFF(date1,date2)</td>
<td>返回date1 - date2的日期间隔天数</td>
</tr>
<tr>
<td>TIMEDIFF(time1, time2)</td>
<td>返回time1 - time2的时间间隔</td>
</tr>
<tr>
<td>FROM_DAYS(N)</td>
<td>返回从0000年1月1日起，N天以后的日期</td>
</tr>
<tr>
<td>TO_DAYS(date)</td>
<td>返回日期date距离0000年1月1日的天数</td>
</tr>
<tr>
<td>LAST_DAY(date)</td>
<td>返回date所在月份的最后一天的日期</td>
</tr>
<tr>
<td>MAKEDATE(year,n)</td>
<td>针对给定年份与所在年份中的天数返回一个日期</td>
</tr>
<tr>
<td>MAKETIME(hour,minute,second)</td>
<td>将给定的小时、分钟和秒组合成时间并返回</td>
</tr>
<tr>
<td>PERIOD_ADD(time,n)</td>
<td>返回time加上n后的时间</td>
</tr>
</tbody></table>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> ADDTIME(NOW(),<span class="number">20</span>),SUBTIME(NOW(),<span class="number">30</span>),SUBTIME(NOW(),<span class="string">&#x27;1:1:3&#x27;</span>),DATEDIFF(NOW(),<span class="string">&#x27;2021-10-01&#x27;</span>),</span><br><span class="line">TIMEDIFF(NOW(),<span class="string">&#x27;2021-10-25 22:10:10&#x27;</span>),FROM_DAYS(<span class="number">366</span>),TO_DAYS(<span class="string">&#x27;0000-12-25&#x27;</span>),</span><br><span class="line">LAST_DAY(NOW()),MAKEDATE(<span class="keyword">YEAR</span>(NOW()),<span class="number">12</span>),MAKETIME(<span class="number">10</span>,<span class="number">21</span>,<span class="number">23</span>),PERIOD_ADD(<span class="number">20200101010101</span>,<span class="number">10</span>)</span><br><span class="line"><span class="keyword">FROM</span> DUAL;</span><br></pre></td></tr></table></figure>

<h2 id="7、-日期的格式化与解析"><a href="#7、-日期的格式化与解析" class="headerlink" title="7、 日期的格式化与解析"></a>7、 日期的格式化与解析</h2><p>格式化：日期—&gt;字符串<br>解析：字符串–&gt;日期</p>
<table>
<thead>
<tr>
<th>函数</th>
<th>用法</th>
</tr>
</thead>
<tbody><tr>
<td>DATE_FORMAT(date,fmt)</td>
<td>按照字符串fmt格式化日期date值(年月日)</td>
</tr>
<tr>
<td>TIME_FORMAT(time,fmt)</td>
<td>按照字符串fmt格式化时间time值(时分秒)</td>
</tr>
<tr>
<td>GET_FORMAT(date_type,format_type)</td>
<td>返回日期字符串的显示格式 (可以便捷的进行获取fmt)</td>
</tr>
<tr>
<td>STR_TO_DATE(str, fmt)</td>
<td>按照字符串fmt对str进行解析，解析为一个日期</td>
</tr>
</tbody></table>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 3.7日期的格式化与解析</span></span><br><span class="line"><span class="comment">-- 格式化：日期---&gt;字符串</span></span><br><span class="line"><span class="comment">-- 解析：字符串----&gt;日期</span></span><br><span class="line"><span class="comment">-- 此时我们谈的是日期的显式格式化和解析</span></span><br><span class="line"><span class="comment">-- 之前，我们接触过隐式的格式化或解析</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">WHERE</span> hire_date <span class="operator">=</span> <span class="string">&#x27;adfs-01-13&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 格式化：</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="type">DATE</span> FORMAT(CURDATE(),<span class="string">&#x27;%Y-%M-%D&#x27;</span>),</span><br><span class="line">DATE_FORMAT(NOW(),<span class="string">&#x27;%Y-%m-%d&#x27;</span>),TIME_FORMAT(CURTIME(),<span class="string">&#x27;%h:%i:%S&#x27;</span>),</span><br><span class="line">DATE_FORMAT(NOW(),<span class="string">&#x27;%Y-%M-%D %h:%i:%S %W %w %T %r&#x27;</span>)</span><br><span class="line"><span class="keyword">FROM</span> DUAL;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 解析：格式化的逆过程</span></span><br><span class="line"><span class="keyword">SELECT</span> STR_TO_DATE(<span class="string">&#x27;2021-oCTOBER-25th 11:34:42 Monday 1&#x27;</span>,<span class="string">&#x27;%Y-%M-%D %h:%i:%S %W %w&#x27;</span>)</span><br><span class="line"><span class="keyword">FROM</span> DUAL;</span><br></pre></td></tr></table></figure>

<p>上述<code>非GET_FORMAT</code>函数中fmt参数常用的格式符：&#x3D;&#x3D;key&#x3D;&#x3D;</p>
<table>
<thead>
<tr>
<th>格式符</th>
<th>说明</th>
<th>格式符</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>%Y</td>
<td>4位数字表示年份</td>
<td>%y</td>
<td>表示两位数字表示年份</td>
</tr>
<tr>
<td>%M</td>
<td>月名表示月份（January,…）</td>
<td>%m</td>
<td>两位数字表示月份（01,02,03。。。</td>
</tr>
<tr>
<td>%b</td>
<td>缩写的月名（Jan.，Feb.，…）</td>
<td>%c</td>
<td>数字表示月份（1,2,3,…）</td>
</tr>
<tr>
<td>%D</td>
<td>英文后缀表示月中的天数（1st,2nd,3rd,…）</td>
<td>%d</td>
<td>两位数字表示月中的天数(01,02…)</td>
</tr>
<tr>
<td>%e</td>
<td>数字形式表示月中的天数（1,2,3,4,5…）</td>
<td></td>
<td></td>
</tr>
<tr>
<td>%H</td>
<td>两位数字表示小数，24小时制（01,02…）</td>
<td>%h和%I</td>
<td>两位数字表示小时，12小时制（01,02…）</td>
</tr>
<tr>
<td>%k</td>
<td>数字形式的小时，24小时制(1,2,3)</td>
<td>%l</td>
<td>数字形式表示小时，12小时制（1,2,3,4…）</td>
</tr>
<tr>
<td>%i</td>
<td>两位数字表示分钟（00,01,02）</td>
<td>%S和%s</td>
<td>两位数字表示秒(00,01,02…)</td>
</tr>
<tr>
<td>%W</td>
<td>一周中的星期名称（Sunday…）</td>
<td>%a</td>
<td>一周中的星期缩写（Sun.，Mon.,Tues.，…）</td>
</tr>
<tr>
<td>%w</td>
<td>以数字表示周中的天数(0&#x3D;Sunday,1&#x3D;Monday…)</td>
<td></td>
<td></td>
</tr>
<tr>
<td>%j</td>
<td>以3位数字表示年中的天数(001,002…)</td>
<td>%U</td>
<td>以数字表示年中的第几周，（1,2,3。。）其中Sunday为周中第一天</td>
</tr>
<tr>
<td>%u</td>
<td>以数字表示年中的第几周，（1,2,3。。）其中Monday为周中第一天</td>
<td></td>
<td></td>
</tr>
<tr>
<td>%T</td>
<td>24小时制</td>
<td>%r</td>
<td>12小时制</td>
</tr>
<tr>
<td>%p</td>
<td>AM或PM</td>
<td>%%</td>
<td>表示%</td>
</tr>
</tbody></table>
<p>GET_FORMAT函数中date_type和format_type参数取值如下：  </p>
<table>
<thead>
<tr>
<th>日期类型</th>
<th>格式化类型</th>
<th>返回的格式化字符串</th>
</tr>
</thead>
<tbody><tr>
<td>DATE</td>
<td>USA</td>
<td>%m.%d.%Y</td>
</tr>
<tr>
<td>DATE</td>
<td>JIS</td>
<td>%Y-%m-%d</td>
</tr>
<tr>
<td>DATE</td>
<td>ISO</td>
<td>%Y-%m-%d</td>
</tr>
<tr>
<td>DATE</td>
<td>EUR</td>
<td>%d.%m.%Y</td>
</tr>
<tr>
<td>DATE</td>
<td>INTERNAL</td>
<td>%Y%m%d</td>
</tr>
<tr>
<td>TIME</td>
<td>USA</td>
<td>%h:%i:%s%p</td>
</tr>
<tr>
<td>TIME</td>
<td>JIS</td>
<td>%H:%i:%s</td>
</tr>
<tr>
<td>TIME</td>
<td>ISO</td>
<td>%H:%i:%s</td>
</tr>
<tr>
<td>TIME</td>
<td>EUR</td>
<td>%H:%i:%s</td>
</tr>
<tr>
<td>TIME</td>
<td>INTERNAL</td>
<td>%H%i%s</td>
</tr>
<tr>
<td>DATETIME</td>
<td>USA</td>
<td>%Y-%m-%d%H.%i.%s</td>
</tr>
<tr>
<td>DATETIME</td>
<td>JIS</td>
<td>%Y-%m-%d%H.%i.%s</td>
</tr>
<tr>
<td>DATETIME</td>
<td>ISO</td>
<td>%Y-%m-%d%H.%i.%s</td>
</tr>
<tr>
<td>DATETIME</td>
<td>EUR</td>
<td>%Y-%m-%d%H.%i.%s</td>
</tr>
<tr>
<td>DATETIME</td>
<td>INTERNAL</td>
<td>%Y%m%d%H%i%s</td>
</tr>
</tbody></table>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">#GET_FORMAT()可以便捷的进行获取fmt</span><br><span class="line"><span class="keyword">SELECT</span> GET_FORMAT(<span class="type">DATE</span>,<span class="string">&#x27;USA&#x27;</span>),GET_FORMAT(<span class="type">DATE</span>,<span class="string">&#x27;ISO&#x27;</span>)</span><br><span class="line"><span class="keyword">FROM</span> DUAL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> GET_FORMAT(<span class="type">DATE</span>,<span class="string">&#x27;USA&#x27;</span>)</span><br><span class="line"><span class="keyword">FROM</span> DUAL;</span><br><span class="line"><span class="keyword">SELECT</span> DATE_FORMAT(CURDATE(),GET_FORMAT(<span class="type">DATE</span>,<span class="string">&#x27;USA&#x27;</span>)</span><br><span class="line"><span class="keyword">FROM</span> DUAL;</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> DATE_FORMAT(CURDATE(),GET_FORMAT(<span class="type">DATE</span>,<span class="string">&#x27;USA&#x27;</span>))  <span class="keyword">AS</span> <span class="string">&#x27;date1&#x27;</span>,</span><br><span class="line">DATE_FORMAT(CURDATE(),GET_FORMAT(<span class="type">DATE</span>,<span class="string">&#x27;ISO&#x27;</span>)) <span class="keyword">AS</span> <span class="string">&#x27;date2&#x27;</span></span><br><span class="line"><span class="keyword">FROM</span> DUAL;</span><br></pre></td></tr></table></figure>



<h1 id="五、流程控制函数"><a href="#五、流程控制函数" class="headerlink" title="五、流程控制函数"></a>五、流程控制函数</h1><p>流程处理函数可以根据不同的条件，执行不同的处理流程，可以在SQL语句中实现不同的条件选择。MySQL中的流程处理函数主要包括IF()、IFNULL()和CASE()函数。</p>
<table>
<thead>
<tr>
<th>函数</th>
<th>用法</th>
</tr>
</thead>
<tbody><tr>
<td>IF(value,value1,value2)</td>
<td>如果value的值为TRUE，返回value1，否则返回value2</td>
</tr>
<tr>
<td>IFNULL(value1, value2)</td>
<td>如果value1不为NULL，返回value1，否则返回value2</td>
</tr>
<tr>
<td>CASE WHEN 条件1 THEN 结果1 WHEN 条件2 THEN 结果2 … [ELSE resultn] END</td>
<td>相当于Java的if…else if…else…</td>
</tr>
<tr>
<td>CASE expr WHEN 常量值1 THEN 值1 WHEN 常量值1 THEN 值1 … [ELSE 值n] END</td>
<td>相当于Java的switch…case…</td>
</tr>
</tbody></table>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 4.流程控制函数</span></span><br><span class="line"><span class="comment">-- 4.1 IF(VALUE,VALUE1,VALUE2)</span></span><br><span class="line"><span class="keyword">SELECT</span> last_name,salary,IF(salary <span class="operator">&gt;=</span> <span class="number">6000</span>,<span class="string">&#x27;高工资&#x27;</span>,<span class="string">&#x27;低工资&#x27;</span>) &quot;details&quot;</span><br><span class="line"><span class="keyword">FROM</span> employees;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> last_name,commission_pct,IF(commission_pct <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span>,commission_pct,<span class="number">0</span>) &quot;details&quot;</span><br><span class="line"><span class="keyword">FROM</span> employees;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 4.2 IFNULL(VALUE1，VALUE2)：看做是IF(VALUE,VALUE1,VALUE2)的特殊情况</span></span><br><span class="line"><span class="keyword">SELECT</span> last_name,commission_pct,IFNULL(commission_pct,<span class="number">0</span>) &quot;details&quot;</span><br><span class="line"><span class="keyword">FROM</span> employees;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 4.3  CASE WHEN ... THEN ... WHEN ... THEN ... ELSE ... END</span></span><br><span class="line"><span class="comment">-- 类似于java的if ... else if ... else if ... else</span></span><br><span class="line"><span class="keyword">SELECT</span> last_name,salary,<span class="keyword">CASE</span> <span class="keyword">WHEN</span> salary <span class="operator">&gt;=</span> <span class="number">15000</span> <span class="keyword">THEN</span> <span class="string">&#x27;白骨精&#x27;</span></span><br><span class="line">                             <span class="keyword">WHEN</span> salary <span class="operator">&gt;=</span> <span class="number">10000</span> <span class="keyword">THEN</span> <span class="string">&#x27;潜力股&#x27;</span></span><br><span class="line">                             <span class="keyword">WHEN</span> salary <span class="operator">&gt;=</span> <span class="number">8000</span> <span class="keyword">THEN</span> <span class="string">&#x27;小屌丝&#x27;</span></span><br><span class="line">                             <span class="keyword">ELSE</span> <span class="string">&#x27;草根&#x27;</span> <span class="keyword">END</span> &quot;details&quot;</span><br><span class="line"><span class="keyword">FROM</span> employees;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 4.4 CASE ... WHEN ... THEN ... WHEN ... THEN ... ELSE ... END</span></span><br><span class="line"><span class="comment">-- 类似于java的swich ... case ... </span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">练习1</span></span><br><span class="line"><span class="comment">查询部门号为 10,20,30 的员工信息，</span></span><br><span class="line"><span class="comment">若部门号为10，则打印其工资的 1.1 倍，</span></span><br><span class="line"><span class="comment">20号部门，则打印其工资的 1.2 倍，</span></span><br><span class="line"><span class="comment">30号部门，打印其工资的 1.3 倍数，</span></span><br><span class="line"><span class="comment">其他部门，打印其工资的 1.3 倍数</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">SELECT</span> employee_id,last_name,department_id,salary,<span class="keyword">CASE</span> department_id <span class="keyword">WHEN</span> <span class="number">10</span> <span class="keyword">THEN</span> salary <span class="operator">*</span> <span class="number">1.1</span></span><br><span class="line">                                                                     <span class="keyword">WHEN</span> <span class="number">20</span> <span class="keyword">THEN</span> salary <span class="operator">*</span> <span class="number">1.2</span></span><br><span class="line">                                                                     <span class="keyword">WHEN</span> <span class="number">30</span> <span class="keyword">THEN</span> salary <span class="operator">*</span> <span class="number">1.3</span></span><br><span class="line">                                                                     <span class="keyword">ELSE</span> salary <span class="operator">*</span> <span class="number">1.4</span> <span class="keyword">END</span> &quot;details&quot;</span><br><span class="line"><span class="keyword">FROM</span> employees;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">练习2</span></span><br><span class="line"><span class="comment">查询部门号为10，20，30的员工信息，</span></span><br><span class="line"><span class="comment">若部门号为10，则打印其工资的1.1倍，</span></span><br><span class="line"><span class="comment">20号部门，则打印其工资的1.2倍，</span></span><br><span class="line"><span class="comment">30号部门打印其工资的1.3倍数</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">SELECT</span> employee_id,last_name,department_id,salary,<span class="keyword">CASE</span> department_id <span class="keyword">WHEN</span> <span class="number">10</span> <span class="keyword">THEN</span> salary <span class="operator">*</span> <span class="number">1.1</span></span><br><span class="line">                                                                     <span class="keyword">WHEN</span> <span class="number">20</span> <span class="keyword">THEN</span> salary <span class="operator">*</span> <span class="number">1.2</span></span><br><span class="line">                                                                     <span class="keyword">WHEN</span> <span class="number">30</span> <span class="keyword">THEN</span> salary <span class="operator">*</span> <span class="number">1.3</span></span><br><span class="line">                                                                     <span class="keyword">ELSE</span> salary <span class="operator">*</span> <span class="number">1.4</span> <span class="keyword">END</span> &quot;details&quot;</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line">WHRER department_id <span class="keyword">IN</span> (<span class="number">10</span>,<span class="number">20</span>,<span class="number">30</span>);</span><br></pre></td></tr></table></figure>







<h1 id="六、加密与解密函数"><a href="#六、加密与解密函数" class="headerlink" title="六、加密与解密函数"></a>六、<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=%E5%8A%A0%E5%AF%86&spm=1001.2101.3001.7020">加密</a>与解密函数</h1><p>加密与解密函数主要用于对数据库中的数据进行加密和解密处理，以防止数据被他人窃取。这些函数在保证数据库安全时非常有用。</p>
<table>
<thead>
<tr>
<th>函数</th>
<th>用法</th>
</tr>
</thead>
<tbody><tr>
<td>PASSWORD(str)</td>
<td>返回字符串str的加密版本，41位长的字符串。加密结果<code>不可逆</code>，常用于用户的密码加密</td>
</tr>
<tr>
<td>MD5(str)</td>
<td>返回字符串str的md5加密后的值，也是一种加密方式。若参数为NULL，则会返回NULL</td>
</tr>
<tr>
<td>SHA(str)</td>
<td>从原明文密码str计算并返回加密后的密码字符串，当参数为NULL时，返回NULL。<code>SHA加密算法比MD5更加安全</code>。</td>
</tr>
<tr>
<td>ENCODE(value,password_seed)</td>
<td>返回使用password_seed作为加密密码加密value</td>
</tr>
<tr>
<td>DECODE(value,password_seed)</td>
<td>返回使用password_seed作为加密密码解密value</td>
</tr>
</tbody></table>
<blockquote>
<p>可以看到，ENCODE(value,password_seed)函数与DECODE(value,password_seed)函数互为反函数。</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 5.加密与解密的函数</span></span><br><span class="line"><span class="comment">-- PASSWORD() 在mysql8.0中弃用。</span></span><br><span class="line"><span class="keyword">SELECT</span> MD5(<span class="string">&#x27;mysql&#x27;</span>),SHA(<span class="string">&#x27;mysql&#x27;</span>)</span><br><span class="line"><span class="keyword">FROM</span> DUAL;</span><br><span class="line"></span><br><span class="line"><span class="comment">--ENCODE()\DECODE() 在mysql8.0中弃用。</span></span><br><span class="line"><span class="keyword">SELECT</span> ENCODE(<span class="string">&#x27;atguigu&#x27;</span>,<span class="string">&#x27;mysql&#x27;</span>)</span><br><span class="line"><span class="keyword">FROM</span> DUAL;</span><br></pre></td></tr></table></figure>







<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 6.MySQL信息函数</span></span><br><span class="line"><span class="keyword">SELECT</span> VERSION(),CONNECTION_ID(),DATABASE(),SCHEMA(),</span><br><span class="line"><span class="keyword">USER</span>(),<span class="built_in">CURRENT_USER</span>(),CHARSET(<span class="string">&#x27;尚硅谷&#x27;</span>),<span class="keyword">COLLATION</span>(<span class="string">&#x27;尚硅谷&#x27;</span>)</span><br><span class="line"><span class="keyword">FROM</span> DUAL;</span><br></pre></td></tr></table></figure>



<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 7．其他函数</span></span><br><span class="line"><span class="comment">-- 如果n的值小于或者等于0，则只保留整数部分</span></span><br><span class="line"><span class="keyword">SELECT</span> FORMAT(<span class="number">123.125</span>,<span class="number">2</span>), FORMAT(<span class="number">123.125</span>,<span class="number">0</span>), FORMAT(<span class="number">123.125</span>,<span class="number">-2</span>)</span><br><span class="line"><span class="keyword">FROM</span> DUAL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> CONV(<span class="number">16</span>, <span class="number">10</span>, <span class="number">2</span>),CONV(<span class="number">8888</span>,<span class="number">10</span>,<span class="number">16</span>),CONV(<span class="keyword">NULL</span>,<span class="number">10</span>, <span class="number">2</span>)</span><br><span class="line"><span class="keyword">FROM</span> DUAL;</span><br><span class="line"></span><br><span class="line"><span class="comment">--以&quot;192.168.1.100&quot;为例，计算方式为192乘以256的3次方，加上168乘以256的2次方，加上1乘以256，再加上100。</span></span><br><span class="line"><span class="keyword">SELECT</span> INET_ATON(<span class="string">&#x27;192.168.1.100&#x27;</span>), INET_NTOA (<span class="number">3232235876</span>)</span><br><span class="line"><span class="keyword">FROM</span> DUAL;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- BENCHMARK() 用于测试表达式的执行效率</span></span><br><span class="line"><span class="keyword">SELECT</span> BENCHMARK(<span class="number">100000</span>,MD5(<span class="string">&#x27;mysql&#x27;</span>))</span><br><span class="line"><span class="keyword">FROM</span> DUAL;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- CONVERT():可以实现字符集的转换</span></span><br><span class="line"><span class="keyword">SELECT</span> CHARSET(<span class="string">&#x27;atguigu&#x27;</span>),CHARSET(<span class="keyword">CONVERT</span>(<span class="string">&#x27;atguigu&#x27;</span> <span class="keyword">USING</span> <span class="string">&#x27;gbk&#x27;</span>))</span><br><span class="line"><span class="keyword">FROM</span> DUAL;</span><br></pre></td></tr></table></figure>





<p>第07章 单行函数的课后练习</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 1.显示系统时间（注：日期+时间）</span></span><br><span class="line"><span class="keyword">SELECT</span> NOW(),SYSDATE(),<span class="built_in">CURRENT_TIMESTAMP</span>(),<span class="built_in">LOCALTIME</span>(),<span class="built_in">LOCALTIMESTAMP</span>()</span><br><span class="line"><span class="keyword">FROM</span> DUAL;  <span class="comment">--大家只需要掌握一个函数就可以了</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 2.查询员工号，姓名，工资，以及工资提高百分之20后的结果（new salary）</span></span><br><span class="line"><span class="keyword">SELECT</span> employee_id,last_name,salary,salary <span class="operator">*</span> <span class="number">1.2</span> &quot;new salary&quot;</span><br><span class="line"><span class="keyword">FROM</span> employees;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 3.将员工的姓名按首字母排序，并写出姓名的长度(length)</span></span><br><span class="line"><span class="keyword">SELECT</span> last_name,LENGTH(last_name) &quot;name_length&quot;</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="comment">--ORDER BY last_name ASC;</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> name_length <span class="keyword">ASC</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 4.查询员工id,last_name,salary,并作为一个列输出，别名为OUT_PUT</span></span><br><span class="line"><span class="keyword">SELECT</span> CONCAT(employee_id,<span class="string">&#x27;,&#x27;</span>,last_name,<span class="string">&#x27;,&#x27;</span>,salary) &quot;OUT_PUT&quot;</span><br><span class="line"><span class="keyword">FROM</span> employees;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 5.查询公司各员工工作的年数、工作的天数，并按工作年数的降序排序</span></span><br><span class="line"><span class="keyword">SELECT</span> employee_id,DATEDIFF(CURDATE(),hire_date)<span class="operator">/</span><span class="number">365</span> &quot;worked_years&quot;,DATEDIFF(CURDATE(),hire_date) &quot;worked_days&quot;,TO_DAYS(CURDATE()) <span class="operator">-</span> TO_DAYS(hire_date) &quot;worked_days1&quot;</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> worked_years <span class="keyword">DESC</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 6.查询员工姓名,hire_date,department_id,满足以下条件：</span></span><br><span class="line"><span class="comment">-- 雇用时间在1997年之后,department_id 为80 或90 或110,commission_pct不为空</span></span><br><span class="line"><span class="keyword">SELECT</span> last_name,hire_date,department_id</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">WHERE</span> department_id <span class="keyword">IN</span> (<span class="number">80</span>,<span class="number">90</span>,<span class="number">110</span>)</span><br><span class="line"><span class="keyword">AND</span> commission_pct <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span></span><br><span class="line"><span class="comment">--AND hire_date &gt;= &#x27;1997-01-01&#x27;;  --存在着隐式转换</span></span><br><span class="line"><span class="comment">--AND DATE_FORMAT(hire_date,&#x27;%Y-%m-%d&#x27;) &gt;= &#x27;1997-01-01&#x27;;  -- 显式转换操作，格式化：日期 ---&gt; 字符串</span></span><br><span class="line"><span class="comment">--AND DATE_FORMAT(hire_date,&#x27;%Y&#x27;) &gt;= &#x27;1997&#x27;;  -- 显式转换操作，格式化</span></span><br><span class="line"><span class="keyword">AND</span> hire_date <span class="operator">&gt;=</span> STR_TO_DATE(<span class="string">&#x27;1997-01-01&#x27;</span>,<span class="string">&#x27;%Y-%m-%d&#x27;</span>);  <span class="comment">-- 显式转换操作,解析：字符串 ----&gt; 日期</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--7.查询公司中入职超过10000天的员工姓名、入职时间</span></span><br><span class="line"><span class="keyword">SELECT</span> last_name,hire_date</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">WHERE</span> DATEDIFF(CURDATE(),hire_date) <span class="operator">&gt;=</span> <span class="number">10000</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 8.做一个查询，产生下面的结果</span></span><br><span class="line"><span class="comment">-- &lt;last_name&gt; earns &lt;salary&gt; monthly but wants &lt;salary*3&gt;</span></span><br><span class="line"><span class="keyword">SELECT</span> CONOAT(last_name,<span class="string">&#x27; earns &#x27;</span>,salary,<span class="string">&#x27; monthly but wants &#x27;</span>,salary <span class="operator">*</span> <span class="number">3</span>) &quot;Dream Salary&quot;</span><br><span class="line"><span class="keyword">FROM</span> employees;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 9.使用case-when,按照下面的条件：</span></span><br><span class="line"><span class="comment">/*job        grade</span></span><br><span class="line"><span class="comment">AD_PRES       A</span></span><br><span class="line"><span class="comment">ST_MAN        B</span></span><br><span class="line"><span class="comment">IT_PROG       C</span></span><br><span class="line"><span class="comment">SA_REP        D</span></span><br><span class="line"><span class="comment">ST_CLERK      E</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">产生下面的结果：</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">SELECT</span> last_name &quot;Last_name&quot;,job_id &quot;Job_id&quot;,<span class="keyword">CASE</span> job_id <span class="keyword">WHEN</span> <span class="string">&#x27;AD_PRES&#x27;</span> <span class="keyword">THEN</span> <span class="string">&#x27;A&#x27;</span></span><br><span class="line">                                                         <span class="keyword">WHEN</span> <span class="string">&#x27;ST_MAN&#x27;</span> <span class="keyword">THEN</span> <span class="string">&#x27;B&#x27;</span></span><br><span class="line">                                                         <span class="keyword">WHEN</span> <span class="string">&#x27;IT_PROG&#x27;</span> <span class="keyword">THEN</span> <span class="string">&#x27;C&#x27;</span></span><br><span class="line">                                                         <span class="keyword">WHEN</span> <span class="string">&#x27;SA_REP&#x27;</span> <span class="keyword">THEN</span> <span class="string">&#x27;D&#x27;</span></span><br><span class="line">                                                         <span class="keyword">WHEN</span> <span class="string">&#x27;ST_CLERK&#x27;</span> <span class="keyword">THEN</span> <span class="string">&#x27;E&#x27;</span></span><br><span class="line">                                                         <span class="keyword">ELSE</span> &quot;undefined&quot; <span class="keyword">END</span> &quot;Grade&quot;</span><br><span class="line"><span class="keyword">FROM</span> employees;</span><br></pre></td></tr></table></figure>







<p>P38-48 跳过</p>
<h3 id="标识命名规则"><a href="#标识命名规则" class="headerlink" title="标识命名规则"></a>标识命名规则</h3><ul>
<li>数据库、表名不得超过30个字符，变量名限制为29个</li>
<li>必须只能包含 A–Z, a–z, 0–9, _共63个字符</li>
<li>数据库名、表名、字段名等对象名中间不要包含空格 同一个MySQL软件中，数据库不能同名；同一个库中，表不能重名；</li>
<li>同一个表中，字段不能重名 必须保证你的字段没有和保留字、数据库系统或常用方法冲突。如果坚持使用，请在SQL语句中使 用&#96;（着重号）引起来</li>
<li>保持字段名和类型的一致性，在命名字段并为其指定数据类型的时候一定要保证一致性。假如数据 类型在一个表里是整数，那在另一个表里可就别变成字符型了</li>
</ul>
<p>第10章 创建和管理表</p>
<p>1.创建和管理数据库</p>
<p>1.1创建数据库</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--方式1：创建数据库 ( 数据库名存在时，会报错 )</span></span><br><span class="line"><span class="keyword">CREATE</span> DATABASE 数据库名;</span><br><span class="line"><span class="keyword">CREATE</span> DATABASE mytest1;  <span class="comment">--创建的此数据库使用的是默认的字符集</span></span><br><span class="line"><span class="comment">--查看创建数据库的结构</span></span><br><span class="line"><span class="keyword">SHOW</span> <span class="keyword">CREATE</span> DATABASE mytest1;</span><br><span class="line"></span><br><span class="line"><span class="comment">--方式2：创建数据库并指定字符集 ( 数据库名存在时，会报错 )</span></span><br><span class="line"><span class="keyword">CREATE</span> DATABASE 数据库名 <span class="type">CHARACTER</span> <span class="keyword">SET</span> 字符集;  <span class="comment">--(&#x27;不指定字符集会选择默认字符集&#x27;) </span></span><br><span class="line"><span class="keyword">CREATE</span> DATABASE mytest2 <span class="type">CHARACTER</span> <span class="keyword">SET</span> <span class="string">&#x27;gbk&#x27;</span>;  <span class="comment">--显式了指名了要创建的数据库的字符集</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--方式3：判断数据库是否已经存在，不存在则创建数据库**（推荐）**</span></span><br><span class="line"><span class="comment">--方式3(推荐)：如果要创建的数据库已经存在，则创建不成功，但不会报错。</span></span><br><span class="line"><span class="keyword">CREATE</span> DATABASE IF <span class="keyword">NOT</span> <span class="keyword">EXISTS</span> 数据库名;</span><br><span class="line"><span class="keyword">CREATE</span> DATABASE IF <span class="keyword">NOT</span> <span class="keyword">EXISTS</span> mytest2 <span class="type">CHARACTER</span> <span class="keyword">SET</span> <span class="string">&#x27;gbk&#x27;</span>;</span><br><span class="line"><span class="comment">--如果要创建的数据库不存在，则创建成功</span></span><br><span class="line"><span class="keyword">CREATE</span> DATABASE IF <span class="keyword">NOT</span> <span class="keyword">EXISTS</span> mytest3 <span class="type">CHARACTER</span> <span class="keyword">SET</span> <span class="string">&#x27;utf8&#x27;</span>;</span><br><span class="line"><span class="keyword">SHOW</span> DATABASES;</span><br><span class="line"><span class="comment">--注意：DATABASE 不能改名。一些可视化工具可以改名，它是建新库，把所有表复制到新库，再删旧库完成的</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">--1.2 管理数据库</span></span><br><span class="line"><span class="comment">--查看当前连接中的数据库都有哪些</span></span><br><span class="line"><span class="comment">--使用数据库</span></span><br><span class="line"><span class="comment">--查看当前所有的数据库</span></span><br><span class="line"><span class="keyword">SHOW</span> DATABASES; <span class="comment">--有一个S，代表多个数据库</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--切换数据库</span></span><br><span class="line">USE mytest2;</span><br><span class="line"></span><br><span class="line"><span class="comment">--查看当前数据库在中保存的数据表</span></span><br><span class="line"><span class="keyword">SHOW</span> TABLES;</span><br><span class="line"></span><br><span class="line"><span class="comment">--查看当前使用的数据库</span></span><br><span class="line"><span class="keyword">SELECT</span> DATABASE(); <span class="comment">--使用的一个 mysql 中的全局函数</span></span><br><span class="line"><span class="keyword">SELECT</span> DATABASE() <span class="keyword">FROM</span> DUAL;</span><br><span class="line"></span><br><span class="line"><span class="comment">--查看指定数据库下保存的数据表</span></span><br><span class="line"><span class="keyword">SHOW</span> TABLES <span class="keyword">FROM</span> 数据库名;</span><br><span class="line"><span class="keyword">SHOW</span> TABLES <span class="keyword">FROM</span> mysql;</span><br><span class="line"></span><br><span class="line"><span class="comment">--1.3 修改数据库</span></span><br><span class="line"><span class="comment">--更改数据库字符集</span></span><br><span class="line"><span class="keyword">SHOW</span> <span class="keyword">CREATE</span> DATABASE mytest2;</span><br><span class="line"></span><br><span class="line"><span class="keyword">ALTER</span> DATABASE mytest2 <span class="type">CHARACTER</span> <span class="keyword">SET</span> <span class="string">&#x27;utf8&#x27;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">--查看数据库的创建信息</span></span><br><span class="line"><span class="keyword">SHOW</span> <span class="keyword">CREATE</span> DATABASE 数据库名;</span><br><span class="line"><span class="comment">--或者： </span></span><br><span class="line"><span class="keyword">SHOW</span> <span class="keyword">CREATE</span> DATABASE 数据库名\G</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">--1.4 删除数据库</span></span><br><span class="line"><span class="comment">--方式1：删除指定的数据库  如果要删除的数据库存在，则删除成功。如果不存在，则报错</span></span><br><span class="line"><span class="keyword">DROP</span> DATABASE 数据库名;</span><br><span class="line"><span class="keyword">DROP</span> DATABASE mytest1;</span><br><span class="line"><span class="keyword">SHOW</span> DATABASES;</span><br><span class="line"></span><br><span class="line"><span class="comment">--方式2：删除指定的数据库**（推荐）**  推荐。如果要删除的数据库存在，则删除成功。如果不存在，则默默结束，不会报错。</span></span><br><span class="line"><span class="keyword">DROP</span> DATABASE IF <span class="keyword">EXISTS</span> 数据库名; <span class="comment">--IF EXISTS 是否存在此表名 有的话就不删除了 没有的话就删除</span></span><br><span class="line"><span class="keyword">DROP</span> DATABASE IF <span class="keyword">EXISTS</span> mytest1;</span><br></pre></td></tr></table></figure>



<p>1.3 MySQL中的数据类型</p>
<table>
<thead>
<tr>
<th>类型</th>
<th>类型举例</th>
</tr>
</thead>
<tbody><tr>
<td>整数类型</td>
<td>TINYINT、SMALLINT、MEDIUMINT、**INT(或INTEGER)**、BIGINT</td>
</tr>
<tr>
<td>浮点类型</td>
<td>FLOAT、DOUBLE</td>
</tr>
<tr>
<td>定点数类型</td>
<td><strong>DECIMAL</strong></td>
</tr>
<tr>
<td>位类型</td>
<td>BIT</td>
</tr>
<tr>
<td>日期时间类型</td>
<td>YEAR、 TIME、 <strong>DATE</strong>、 DATETIME、 TIMESTAMP</td>
</tr>
<tr>
<td>文本字符串类型</td>
<td>CHAR、 VARCHAR、 TINYTEXT、 TEXT、MEDIUMTEXT、LONGTEXT</td>
</tr>
<tr>
<td>枚举类型</td>
<td>ENUM</td>
</tr>
<tr>
<td>集合类型</td>
<td>SET</td>
</tr>
<tr>
<td>二进制字符串类型</td>
<td>BINARY、 VARBINARY、 TINYBLOB、 BLOB、 MEDIUMBLOB、 LONGBLOB</td>
</tr>
<tr>
<td>JSON类型</td>
<td>JSON对象、JSON数组</td>
</tr>
<tr>
<td>空间数据类型</td>
<td>单值：GEOMETRY、POINT、LINESTRING、POLYGON;<br/>集合：MULTIPOINT、MULTILINESTRING、MULTIPOLYGON、GEOMETRYCOLLECTION</td>
</tr>
</tbody></table>
<p>其中，常用的几类类型介绍如下：</p>
<table>
<thead>
<tr>
<th>数据类型</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>INT</td>
<td>从-2^31到2^31-1的整型数据。存储大小为4个字节</td>
</tr>
<tr>
<td>CHAR(size)</td>
<td>定长字符数据。若未指定，默认为1个字符，最大长度255</td>
</tr>
<tr>
<td>VARCHAR(size)</td>
<td>可变长字符数据，根据字符串实际长度保存，<strong>必须指定长度</strong></td>
</tr>
<tr>
<td>FLOAT(M,D)</td>
<td>单精度，占用4个字节，M&#x3D;整数位+小数位，D&#x3D;小数位。D&lt;&#x3D;M&lt;&#x3D;255,0&lt;&#x3D;D&lt;&#x3D;30，默认M+D&lt;&#x3D;6</td>
</tr>
<tr>
<td>DOUBLE(M,D)</td>
<td>双精度，占用8个字节，D&lt;&#x3D;M&lt;&#x3D;255,0&lt;&#x3D;D&lt;&#x3D;30，默认M+D&lt;&#x3D;15</td>
</tr>
<tr>
<td>DECIMAL(M,D)</td>
<td>高精度小数，占用M+2个字节，D&lt;&#x3D;M&lt;&#x3D;65，0&lt;&#x3D;D&lt;&#x3D;30，最大取值范围与DOUBLE相同。</td>
</tr>
<tr>
<td>DATE</td>
<td>日期型数据，格式’YYYY-MM-DD’</td>
</tr>
<tr>
<td>BLOB</td>
<td>二进制形式的长文本数据，最大可达4G</td>
</tr>
<tr>
<td>TEXT</td>
<td>长文本数据，最大可达4G</td>
</tr>
</tbody></table>
<p>2.如何创建数据表</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br></pre></td><td class="code"><pre><span class="line">use atguiguddb;</span><br><span class="line"><span class="keyword">show</span> <span class="keyword">create</span> <span class="keyword">TABLE</span> database atguigudb;  <span class="comment">--默认使用的是utf8</span></span><br><span class="line"><span class="keyword">show</span> TABLEs;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 方式1：&quot;白手起家&quot;的方式</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">TABLE</span> if <span class="keyword">not</span> <span class="keyword">exists</span> myemp1(  <span class="comment">--需要用户具备创建表的权限</span></span><br><span class="line">id <span class="type">int</span>,</span><br><span class="line">emp_name <span class="type">varchar</span>(<span class="number">15</span>),  <span class="comment">--使用varchar来定义字符串，必须在使用varchar时指明其长度</span></span><br><span class="line">hire_date <span class="type">date</span></span><br><span class="line">);</span><br><span class="line"><span class="comment">-- 查看表结构</span></span><br><span class="line"><span class="keyword">desc</span> myemp1;</span><br><span class="line"><span class="comment">-- 查看创建表的语句结构</span></span><br><span class="line"><span class="keyword">show</span> <span class="keyword">create</span> <span class="keyword">TABLE</span> myemp1;  <span class="comment">--如果创建表时没有指明使用的字符集，则默认使用表所在的数据库的字符集。</span></span><br><span class="line"><span class="comment">-- 查看表数据</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> myempl;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 方式2：基于现有的表,同时导入数据</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> myemp2</span><br><span class="line"><span class="keyword">AS</span></span><br><span class="line"><span class="keyword">SELECT</span> employee_id,last_name,salary</span><br><span class="line"><span class="keyword">FROM</span> employees;</span><br><span class="line"></span><br><span class="line"><span class="keyword">DESC</span> myemp2;</span><br><span class="line"><span class="keyword">DESC</span> employees;</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> myemp2;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 说明1：查询语句中字段的别名，可以作为新创建的表的字段的名称。</span></span><br><span class="line"><span class="comment">-- 说明2：此时的查询语句可以结构比较丰富，使用前面章节讲过的各种SELECT</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> myemp3</span><br><span class="line"><span class="keyword">AS</span></span><br><span class="line"><span class="keyword">SELECT</span> e.employee_id emp_id,e.last_name lname,d.department_name</span><br><span class="line"><span class="keyword">FROM</span> employees e <span class="keyword">JOIN</span> departments d</span><br><span class="line"><span class="keyword">ON</span> e.department_id <span class="operator">=</span> d.department_id;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> myemp3;</span><br><span class="line"></span><br><span class="line"><span class="keyword">DESC</span> myemp3;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 练习1：创建一个表employees_copy,实现对employees表的复制，包括表数据</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> employees_copY</span><br><span class="line"><span class="keyword">AS</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> employees;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> employees_copy;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 练习2：创建一个表employees_blank，实现对employees表的复制，不包括表数据</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> employees_blank</span><br><span class="line"><span class="keyword">AS</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="comment">--where department_id &gt; 10000;</span></span><br><span class="line"><span class="keyword">WHERE</span> <span class="number">1</span> <span class="operator">=</span> <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 3．修改表 --&gt; ALTER TABLE</span></span><br><span class="line"><span class="keyword">DESC</span> myemp1;</span><br><span class="line"></span><br><span class="line"><span class="comment">--3.1 添加一个字段</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> myemp1</span><br><span class="line"><span class="keyword">ADD</span> salary <span class="keyword">DOUBLE</span>(<span class="number">10</span>,<span class="number">2</span>);  <span class="comment">--默认添加到表中的最后一个字段的位置</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> myemp1</span><br><span class="line"><span class="keyword">ADD</span> phone_number <span class="type">varchar</span>(<span class="number">20</span>) <span class="keyword">FIRST</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> myemp1</span><br><span class="line"><span class="keyword">ADD</span> email <span class="type">varchar</span>(<span class="number">45</span>) AFTER emp_name;</span><br><span class="line"></span><br><span class="line"><span class="comment">--3.2 修改一个字段：数据类型、长度、默认值(略)</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> myemp1</span><br><span class="line">MODIFY emp_name <span class="type">varchar</span>(<span class="number">25</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> myemp1</span><br><span class="line">MODIFY emp_name <span class="type">varchar</span>(<span class="number">25</span>) <span class="keyword">DEFAULT</span> <span class="string">&#x27;aaa&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">--3.3 重命名一个字段</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> myemp1</span><br><span class="line">CHANGE salary monthly_salary <span class="keyword">double</span>(<span class="number">10</span>,<span class="number">2</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> myemp1</span><br><span class="line">CHANGE email my_email <span class="type">VARCHAR</span>(<span class="number">50</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">--3.4 删除一个字段</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> myemp1</span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">COLUMN</span> my_email;</span><br><span class="line"></span><br><span class="line"><span class="comment">--4．重命名表</span></span><br><span class="line"><span class="comment">--方式1：</span></span><br><span class="line">RENAME <span class="keyword">TABLE</span> myemp1</span><br><span class="line"><span class="keyword">TO</span> myemp11;</span><br><span class="line"></span><br><span class="line"><span class="keyword">DESC</span> myemp11;</span><br><span class="line"></span><br><span class="line"><span class="comment">--方式2：</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> myemp2</span><br><span class="line">RENAME <span class="keyword">TO</span> myemp12;</span><br><span class="line"></span><br><span class="line"><span class="keyword">DESC</span> myemp12;</span><br><span class="line"></span><br><span class="line"><span class="comment">--5.删除表</span></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> IF <span class="keyword">EXISTS</span> myemp2;</span><br><span class="line"></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> IF <span class="keyword">EXISTS</span> myemp12;</span><br><span class="line"></span><br><span class="line"><span class="comment">--6.清空表</span></span><br><span class="line"><span class="comment">--清空表，表示清空表中的所有数据，但是表结构保留。</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> employees_copy;</span><br><span class="line"></span><br><span class="line"><span class="keyword">TRUNCATE</span> <span class="keyword">TABLE</span> employees_copy;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> employees_copy;</span><br><span class="line"></span><br><span class="line"><span class="keyword">DESC</span> employees_copy;</span><br><span class="line"></span><br><span class="line"><span class="comment">--7. DCL 中 COMMIT 和 ROLLBACK</span></span><br><span class="line"><span class="comment">-- COMMIT：提交数据。一旦执行COMMIT，则数据就被永久的保存在了数据库中，意味着数据不可以回滚。</span></span><br><span class="line"><span class="comment">-- ROLLBACK：回滚数据。一旦执行ROLLBACK，则可以实现数据的回滚。回滚到最近的一次COMMIT之后。</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--8.对比 TRUNCATE TABLE 和 DELETE FROM</span></span><br><span class="line"><span class="comment">--相同点：都可以实现对表中所有数据的删除，同时保留表结构。</span></span><br><span class="line"><span class="comment">--不同点：</span></span><br><span class="line"><span class="comment">--    TRUNCATE TABLE：一旦执行此操作，表数据全部清除。同时，数据是不可以回滚的。</span></span><br><span class="line"><span class="comment">--    DELETE FROM：一旦执行此操作，表数据可以全部清除(不带WHERE)。同时，数据是可以实现回滚。</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">DDL和 DML的说明</span></span><br><span class="line"><span class="comment">  DDL的操作一旦执行，就不可回滚。指令SET autocommit = FALSE对DDL操作失效。（因为在执行完DDL操作之后，一定会执行一次COMMIT。而此COMMIT操作不受SET autocommit = FALSE影响的。）</span></span><br><span class="line"><span class="comment">  DML的操作默认情况，一旦执行，也是不可回滚的。但是如果在执行DML之前，执行了 SET autocommit = FALSE，则执行的DML操作就可以实现回滚。</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 演示：DELETE FROM</span></span><br><span class="line"><span class="comment">-- 1)</span></span><br><span class="line"><span class="keyword">COMMIT</span>;</span><br><span class="line"><span class="comment">-- 2)</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> myemp3;</span><br><span class="line"><span class="comment">-- 3)</span></span><br><span class="line"><span class="keyword">SET</span> autocommit <span class="operator">=</span> <span class="literal">FALSE</span>;</span><br><span class="line"><span class="comment">-- 4)</span></span><br><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> myemp3;</span><br><span class="line"><span class="comment">-- 5)</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> myemp3;</span><br><span class="line"><span class="comment">-- 6)</span></span><br><span class="line"><span class="keyword">ROLLBACK</span>;</span><br><span class="line"><span class="comment">-- 7)</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> myemp3;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 演示：TRUNCATE TABLE</span></span><br><span class="line"><span class="comment">-- 1)</span></span><br><span class="line"><span class="keyword">COMMIT</span>;</span><br><span class="line"><span class="comment">-- 2)</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> myemp3;</span><br><span class="line"><span class="comment">-- 3)</span></span><br><span class="line"><span class="keyword">SET</span> autocommit <span class="operator">=</span> <span class="literal">FALSE</span>;</span><br><span class="line"><span class="comment">-- 4)</span></span><br><span class="line"><span class="keyword">TRUNCATE</span> <span class="keyword">TABLE</span> myemp3;</span><br><span class="line"><span class="comment">-- 5)</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> myemp3;</span><br><span class="line"><span class="comment">-- 6)</span></span><br><span class="line"><span class="keyword">ROLLBACK</span>;</span><br><span class="line"><span class="comment">-- 7)</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> myemp3;</span><br></pre></td></tr></table></figure>



<h2 id="2-创建和管理数据库"><a href="#2-创建和管理数据库" class="headerlink" title="2.创建和管理数据库"></a>2.创建和管理数据库</h2><h3 id="2-1-创建数据库"><a href="#2-1-创建数据库" class="headerlink" title="2.1 创建数据库"></a>2.1 创建数据库</h3><ul>
<li>方式1：创建数据库</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> DATABASE 数据库名;</span><br></pre></td></tr></table></figure>

<ul>
<li>方式2：创建数据库并指定字符集</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> DATABSE 数据库名 <span class="type">CHARACTER</span> <span class="keyword">SET</span> 字符集;</span><br></pre></td></tr></table></figure>

<ul>
<li>方式3：判断数据库是否已经存在，不存在则创建数据库（推荐）</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> DATABASE IF <span class="keyword">NOT</span> <span class="keyword">EXISTS</span> 数据库名;</span><br></pre></td></tr></table></figure>

<p>如果MySQL中已经存有相关的数据库，则忽略创建语句，不再创建数据库。</p>
<blockquote>
<p>注意：DATABASE不能改名。一些可视化工具可以改名，它是建新库，，把所有表复制到新库，再删旧库完成的。</p>
</blockquote>
<h3 id="2-2-使用数据库"><a href="#2-2-使用数据库" class="headerlink" title="2.2 使用数据库"></a>2.2 使用数据库</h3><ul>
<li>查看当前所有的数据库</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SHOW</span> DATABASES;  <span class="comment">--有一个S,代表多个数据库</span></span><br></pre></td></tr></table></figure>

<ul>
<li>查看当前正在使用的数据库</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> DATABASE();  <span class="comment">--使用的一个 mysql 中的全局函数</span></span><br></pre></td></tr></table></figure>

<ul>
<li>查看指定库下所有的表</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SHOW</span> TABLES <span class="keyword">FROM</span> 数据库名;</span><br></pre></td></tr></table></figure>

<ul>
<li>查看数据库的创建信息</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SHOW</span> <span class="keyword">CREATE</span> DATABASE 数据库名;</span><br><span class="line">或者:</span><br><span class="line"><span class="keyword">SHOW</span> <span class="keyword">CREATE</span> DATABASE 数据库名\G</span><br></pre></td></tr></table></figure>

<ul>
<li>使用&#x2F;切换数据库</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">USE 数据库名;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>注意：要操作表格和数据之前必须先说明是对哪个数据库进行操作，否则就要对所有对象加上“数据库名.”。</p>
</blockquote>
<h3 id="2-3-修改数据库"><a href="#2-3-修改数据库" class="headerlink" title="2.3 修改数据库"></a>2.3 修改数据库</h3><ul>
<li>更改数据库字符集</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> DATABASE 数据库名 <span class="type">CHARACTER</span> <span class="keyword">SET</span> 字符集; <span class="comment">--比如：gbk、utf8等</span></span><br></pre></td></tr></table></figure>



<h3 id="2-4-删除数据库"><a href="#2-4-删除数据库" class="headerlink" title="2.4 删除数据库"></a>2.4 删除数据库</h3><ul>
<li>方式1：删除指定的数据库</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> DATABASE 数据库名;</span><br></pre></td></tr></table></figure>

<ul>
<li>方式2：删除指定的数据库（推荐）</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> DATABASE IF <span class="keyword">EXISTS</span> 数据库名;</span><br></pre></td></tr></table></figure>



<h2 id="3-创建表"><a href="#3-创建表" class="headerlink" title="3.创建表"></a>3.创建表</h2><h3 id="3-1创建方式1"><a href="#3-1创建方式1" class="headerlink" title="3.1创建方式1"></a>3.1创建方式1</h3><ul>
<li>必须具备：<ul>
<li>CREATE TABLE权限</li>
<li>存储空间</li>
</ul>
</li>
<li>语法格式：</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> [IF <span class="keyword">NOT</span> <span class="keyword">EXISTS</span>] 表名( </span><br><span class="line">    字段<span class="number">1</span> 数据类型 [约束条件] [默认值], </span><br><span class="line">    字段<span class="number">2</span> 数据类型 [约束条件] [默认值], </span><br><span class="line">    字段<span class="number">3</span> 数据类型 [约束条件] [默认值],</span><br><span class="line">    ...</span><br><span class="line">    [表约束条件] </span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<blockquote>
<p>加上了IF NOT EXISTS关键字，则表示：如果当前数据库中不存在要创建的数据表，则创建数据表；如果当前数据库中已经存在要创建的数据表，则忽略建表语句，不再创建数据表。</p>
</blockquote>
<ul>
<li><strong>必须指定：</strong><ul>
<li>表名</li>
<li>列名(或字段名)，数据类型，<strong>长度</strong></li>
</ul>
</li>
<li><strong>可选指定：</strong></li>
</ul>
<h2 id="5-重命名表"><a href="#5-重命名表" class="headerlink" title="5.重命名表"></a>5.重命名表</h2><ul>
<li>方式一：使用RENAME</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">RENAME TABLE emp</span><br><span class="line">T0 myemp;</span><br></pre></td></tr></table></figure>

<ul>
<li>方式二：</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ALTER TABLE dept</span><br><span class="line">RENAME [TO] detail_dept;  # [TO]可以省略</span><br></pre></td></tr></table></figure>

<ul>
<li>必须是对象的拥有者</li>
</ul>
<h2 id="6-删除表"><a href="#6-删除表" class="headerlink" title="6.删除表"></a>6.删除表</h2><ul>
<li>在MySQL中，当一张数据表 <code>没有与其他任何数据表形成关联关系</code> 时，可以将当前数据表直接删除。</li>
<li>数据和结构都被删除</li>
<li>所有正在运行的相关事务被提交</li>
<li>所有相关索引被删除</li>
<li>语法格式：</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DROP TABLE [IF EXISTS] 数据表1 [, 数据表2, ..., 数据表n];</span><br></pre></td></tr></table></figure>

<p><code>IF EXISTS</code> 的含义为：如果当前数据库中存在相应的数据表，则删除数据表；如果当前数据库中不存在相应的数<br>据表，则忽略删除语句，不再执行删除数据表的操作。</p>
<ul>
<li>举例：</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DROP TABLE dept80;</span><br></pre></td></tr></table></figure>

<ul>
<li>DROP TABLE 语句不能回滚</li>
</ul>
<h2 id="7-清空表"><a href="#7-清空表" class="headerlink" title="7.清空表"></a>7.清空表</h2><ul>
<li>TRUNCATE TABLE语句：<ul>
<li>删除表中所有的数据</li>
<li>释放表的存储空间</li>
</ul>
</li>
<li>举例：</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">TRUNCATE TABLE detail_dept;</span><br></pre></td></tr></table></figure>

<ul>
<li>TRUNCATE语句<strong>不能回滚</strong>，而使用 DELETE 语句删除数据，可以回滚</li>
<li>对比：</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">SET autocommit = FALSE;</span><br><span class="line"></span><br><span class="line">DELETE FROM emp2;</span><br><span class="line">#TRUNCATE TABLE emp2; </span><br><span class="line"></span><br><span class="line">SELECT * FROM emp2;</span><br><span class="line"></span><br><span class="line">ROLLBACK;</span><br><span class="line"></span><br><span class="line">SELECT * FROM emp2;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>阿里开发规范：</p>
<p>【参考】TRUNCATE TABLE 比 DELETE 速度快，且使用的系统和事务日志资源少，但 TRUNCATE 无事务且不触发 TRIGGER，有可能造成事故，故不建议在开发代码中使用此语句。</p>
<p>说明：TRUNCATE TABLE 在功能上与不带 WHERE 子句的 DELETE 语句相同。</p>
</blockquote>
<h2 id="8-内容拓展"><a href="#8-内容拓展" class="headerlink" title="8.内容拓展"></a>8.内容拓展</h2><h3 id="拓展1：阿里巴巴《Java开发手册》之MySQL字段命名"><a href="#拓展1：阿里巴巴《Java开发手册》之MySQL字段命名" class="headerlink" title="拓展1：阿里巴巴《Java开发手册》之MySQL字段命名"></a>拓展1：阿里巴巴《Java开发手册》之MySQL字段命名</h3><ul>
<li><p>【<code>强制</code>】表名、字段名必须使用小写字母或数字，禁止出现数字开头，禁止两个下划线中间只出现数字。数据库字段名的修改代价很大，因为无法进行预发布，所以字段名称需要慎重考虑。</p>
<ul>
<li>正例：aliyun_admin，rdc_config，level3_name</li>
<li>反例：AliyunAdmin，rdcConfig，level_3_name</li>
</ul>
</li>
<li><p>【<code>强制</code>】禁用保留字，如 desc、range、match、delayed 等，请参考 MySQL 官方保留字。</p>
</li>
<li><p>【<code>强制</code>】表必备三字段：id, gmt_create, gmt_modified。</p>
<ul>
<li>说明：其中 id 必为主键，类型为BIGINT UNSIGNED、单表时自增、步长为 1。gmt_create, gmt_modified 的类型均为 DATETIME 类型，前者现在时表示主动式创建，后者过去分词表示被动式更新</li>
</ul>
</li>
<li><p>【<code>推荐</code>】表的命名最好是遵循 “业务名称_表的作用”。</p>
<ul>
<li>正例：alipay_task 、 force_project、 trade_config</li>
</ul>
</li>
<li><p>【<code>推荐</code>】库名与应用名称尽量一致。</p>
</li>
<li><p>【参考】合适的字符存储长度，不但节约数据库表空间、节约索引存储，更重要的是提升检索速度。</p>
<ul>
<li>正例：无符号值可以避免误存负数，且扩大了表示范围。</li>
</ul>
</li>
</ul>
<table>
<thead>
<tr>
<th>对象</th>
<th>年龄区间</th>
<th>类型</th>
<th>字节</th>
<th>表示范围</th>
</tr>
</thead>
<tbody><tr>
<td>人</td>
<td>150岁之内</td>
<td>tinyint unsigned</td>
<td>1</td>
<td>无符号值：0到255</td>
</tr>
<tr>
<td>龟</td>
<td>数百岁</td>
<td>smallint unsigned</td>
<td>2</td>
<td>无符号值：0到65535</td>
</tr>
<tr>
<td>恐龙化石</td>
<td>数千万年</td>
<td>int unsigned</td>
<td>4</td>
<td>无符号值：0到约43亿</td>
</tr>
<tr>
<td>太阳</td>
<td>约50亿年</td>
<td>bigint unsigned</td>
<td>8</td>
<td>无符号值：0到约10的19次方</td>
</tr>
</tbody></table>
<h3 id="拓展2：如何理解清空表、删除表等操作需谨慎？！"><a href="#拓展2：如何理解清空表、删除表等操作需谨慎？！" class="headerlink" title="拓展2：如何理解清空表、删除表等操作需谨慎？！"></a>拓展2：如何理解清空表、删除表等操作需谨慎？！</h3><p><code>表删除</code>操作将把表的定义和表中的数据一起删除，并且MySQL在执行删除操作时，不会有任何的确认信息提示，因此执行删除操作时应当慎重。在删除表前，最好对表中的数据进行<code>备份</code>，这样当操作失误时可以对数据进行恢复，以免造成无法挽回的后果。</p>
<p>同样的，在使用<code>ALTER TABLE</code>进行表的基本修改操作时，在执行操作过程之前，也应该确保对数据进行完整的<code>备份</code>，因为数据库的改变是<code>无法撤销</code>的，如果添加了一个不需要的字段，可以将其删除；相同的，如果删除了一个需要的列，该列下面的所有数据都将会丢失。</p>
<h3 id="拓展3：MySQL8新特性—DDL的原子化"><a href="#拓展3：MySQL8新特性—DDL的原子化" class="headerlink" title="拓展3：MySQL8新特性—DDL的原子化"></a>拓展3：MySQL8新特性—DDL的原子化</h3><p>在MySQL 8.0版本中，InnoDB表的DDL支持事务完整性，即<code>DDL操作要么成功要么回滚</code>。DDL操作回滚日志写入到data dictionary数据字典表mysql.innodb_ddl_log（该表是隐藏的表，通过show tables无法看到）中，用于回滚操作。通过设置参数，可将DDL操作日志打印输出到MySQL错误日志中。</p>
<p>分别在MySQL5.7版本和MySQL8.0版本中创建数据库和数据表，结果如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">#9.测试MySQL8.0的新特性：DDL的原子化</span><br><span class="line"></span><br><span class="line">CREATE DATABASE mytest;</span><br><span class="line"></span><br><span class="line">USE mytest;</span><br><span class="line"></span><br><span class="line">CREATE TABLE book1(</span><br><span class="line">book_id INT,</span><br><span class="line">book_name VARCHAR(255)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">SHOW TABLES;</span><br></pre></td></tr></table></figure>

<p>（1）在MySQL 5.7版本中，测试步骤如下：</p>
<p>删除数据表book1和数据表book2，结果如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; DROP TABLE book1,book2;</span><br><span class="line">ERROR 1051 (42S02): Unknown table &#x27;mytest.book2&#x27;</span><br></pre></td></tr></table></figure>

<p>再次查询数据库中的数据表名称，结果如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; SHOW TABLES;</span><br><span class="line">Empty set (0.00 sec)</span><br></pre></td></tr></table></figure>

<p>从结果可以看出，虽然删除操作时报错了，但是仍然删除了数据表book1。</p>
<h2 id="第10章-创建和管理表"><a href="#第10章-创建和管理表" class="headerlink" title="第10章 创建和管理表"></a>第10章 创建和管理表</h2><h3 id="练习1"><a href="#练习1" class="headerlink" title="练习1"></a>练习1</h3><p>题目：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line">#1.创建数据库test01_office,指明字符集为utf8。并在此数据库下执行下述操作</span><br><span class="line"></span><br><span class="line">CREATE DATABASE IF NOT EXISTS test01_office CHARACTER SET &#x27;utf8&#x27;;</span><br><span class="line"></span><br><span class="line">USE test01_office</span><br><span class="line"></span><br><span class="line">#2.创建表dept01</span><br><span class="line">/*</span><br><span class="line">字段    类型</span><br><span class="line">id     INT(7)</span><br><span class="line">NAME   VARCHAR(25)</span><br><span class="line">*/</span><br><span class="line">CREATE TABLE IF NOT EXISTS dept01(</span><br><span class="line">id INT(7),</span><br><span class="line">`name` VARCHAR(25)</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">#3.将表departments中的数据插入新表dept02中</span><br><span class="line">CREATE TABLE dept02</span><br><span class="line">AS</span><br><span class="line">SELECT *</span><br><span class="line">FROM atguigudb.departments;</span><br><span class="line"></span><br><span class="line">#4.创建表emp01</span><br><span class="line">/*</span><br><span class="line">字段         类型</span><br><span class="line">id          INT(7)</span><br><span class="line">first_name  VARCHAR(25)</span><br><span class="line">last_name   VARCHAR(25)</span><br><span class="line">dept_id     INT(7)</span><br><span class="line">*/</span><br><span class="line">CREATE TABLE emp01(</span><br><span class="line">id INT(7),</span><br><span class="line">first_name VARCHAR(25),</span><br><span class="line">last_name VARCHAR(25),</span><br><span class="line">dept_id INT(7)</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">#5.将列last_name的长度增加到50</span><br><span class="line">DESC emp01;</span><br><span class="line"></span><br><span class="line">ALTER TABLE emp01</span><br><span class="line">MODIFY last_name VARCHAR(50)</span><br><span class="line"></span><br><span class="line">#6.根据表employees创建emp02</span><br><span class="line">CREATE TABLES emp02</span><br><span class="line">AS</span><br><span class="line">SELECT *</span><br><span class="line">FROM atguigudb.employees</span><br><span class="line"></span><br><span class="line">SHOW TABLES FROM test01_office;</span><br><span class="line"></span><br><span class="line">#7.删除表emp01</span><br><span class="line">DROP TABLE emp01;</span><br><span class="line"></span><br><span class="line">#8.将表emp02重命名为emp01</span><br><span class="line">#ALTER TABLE emp2 rename to emp01;</span><br><span class="line">RENAME TABLE emp02 TO emp01;</span><br><span class="line"></span><br><span class="line">#9.在表dept02和emp01中添加新列test_column,并检查所作的操作</span><br><span class="line">ALTER TABLE emp01 ADD test_column VARCHAR(10);</span><br><span class="line"></span><br><span class="line">DESC emp01;</span><br><span class="line"></span><br><span class="line">ALTER TABLE dept02 ADD test_column VARCHAR(10);</span><br><span class="line"></span><br><span class="line">DESC dept02;</span><br><span class="line"></span><br><span class="line">#10.直接删除表emp01中的列 department_id</span><br><span class="line">ALTER TABLE emp01</span><br><span class="line">DROP COLUMN department_id</span><br><span class="line"></span><br><span class="line">DESC emp01;</span><br></pre></td></tr></table></figure>



<h3 id="练习2"><a href="#练习2" class="headerlink" title="练习2"></a>练习2</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"># 1、创建数据库 test02_market</span><br><span class="line">CREATE DATABASE IF NOT EXISTS test02_market CHARACTER SET &#x27;utf8&#x27;;</span><br><span class="line"></span><br><span class="line">USE test02_market;</span><br><span class="line"></span><br><span class="line">SHOW CREATE DATABASE test02_market;</span><br><span class="line"></span><br><span class="line"># 2、创建数据表 customers</span><br><span class="line">CREATE TABLE IF NOT EXISTS customers(</span><br><span class="line">c_num INT,</span><br><span class="line">c_name VARCHAR(50),</span><br><span class="line">c_contact VARCHAR(50),</span><br><span class="line">c_city VARCHAR(50),</span><br><span class="line">c_birth DATE</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">SHOW TABLES;</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th>字段名</th>
<th>数据类型</th>
</tr>
</thead>
<tbody><tr>
<td>c_num</td>
<td>int</td>
</tr>
<tr>
<td>c_name</td>
<td>varchar(50)</td>
</tr>
<tr>
<td>c_contact</td>
<td>varchar(50)</td>
</tr>
<tr>
<td>c_city</td>
<td>varchar(50)</td>
</tr>
<tr>
<td>c_birth</td>
<td>date</td>
</tr>
</tbody></table>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"># 3、将 c_contact字段移动到c_birth字段后面</span><br><span class="line">DESC customers;</span><br><span class="line"></span><br><span class="line">ALTER TABLE customers</span><br><span class="line">MODIFY c_contact VARCHAR(50) AFTER c_birth;</span><br><span class="line"></span><br><span class="line"># 4、将c_name字段数据类型改为varchar(70)</span><br><span class="line">ALTER TABLE customers</span><br><span class="line">MODIFY c_name VARCHAR(70);</span><br><span class="line"></span><br><span class="line">DESC customers;</span><br><span class="line"></span><br><span class="line"># 5、将c_contact字段改名为c_phone</span><br><span class="line">ALTER TABLE customers</span><br><span class="line">CHANGE c_contact c_phone VARCHAR(50);</span><br><span class="line"></span><br><span class="line"># 6、增加c_gender字段到c_name后面，数据类型为char(1)</span><br><span class="line">ALTER TABLE customers</span><br><span class="line">ADD c_gender CHAR(1) AFTER c_name</span><br><span class="line"></span><br><span class="line"># 7、将表名改为customers_info</span><br><span class="line">RENAME TABLE customers</span><br><span class="line">TO customers_info;</span><br><span class="line"></span><br><span class="line">DESC customers_info;</span><br><span class="line"></span><br><span class="line"># 8、删除字段c_city</span><br><span class="line">ALTER TABLE customers_info</span><br><span class="line">DROP COLUMN c_city;</span><br></pre></td></tr></table></figure>



<h3 id="练习3"><a href="#练习3" class="headerlink" title="练习3"></a>练习3</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"># 1、创建数据库test03_company</span><br><span class="line">CREATE DATABASE IF NOT EXISTS test03_company CHARACTER SET &#x27;utf8&#x27;;</span><br><span class="line"></span><br><span class="line">USE test03_company;</span><br><span class="line"></span><br><span class="line"># 2、创建表offices</span><br><span class="line">CREATE TABLE IF NOT EXISTS offices(</span><br><span class="line">officeCode INT,</span><br><span class="line">city VARCHAR(30)</span><br><span class="line">address VARCHAR(50)</span><br><span class="line">country VARCHAR(50)</span><br><span class="line">postalCode VARCHAR(25)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">DESC offices;</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th>字段名</th>
<th>数据类型</th>
</tr>
</thead>
<tbody><tr>
<td>officeCode</td>
<td>int</td>
</tr>
<tr>
<td>city</td>
<td>varchar(30)</td>
</tr>
<tr>
<td>address</td>
<td>varchar(50)</td>
</tr>
<tr>
<td>country</td>
<td>varchar(50)</td>
</tr>
<tr>
<td>postalCode</td>
<td>varchar(25)</td>
</tr>
</tbody></table>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"># 3、创建表employees</span><br><span class="line">CREATE TABLE IF NOT EXISTS employees(</span><br><span class="line">empNum INT,</span><br><span class="line">lastName VARCHAR(50),</span><br><span class="line">firstName VARCHAR(50),</span><br><span class="line">mobile VARCHAR(25),</span><br><span class="line">`code` INT,</span><br><span class="line">jobTitle VARCHAR(50),</span><br><span class="line">birth DATE,</span><br><span class="line">note VARCHAR(255),</span><br><span class="line">sex VARCHAR(5)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">DESC employees;</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th>字段名</th>
<th>数据类型</th>
</tr>
</thead>
<tbody><tr>
<td>empNum</td>
<td>int</td>
</tr>
<tr>
<td>lastName</td>
<td>varchar(50)</td>
</tr>
<tr>
<td>firstName</td>
<td>varchar(50)</td>
</tr>
<tr>
<td>mobile</td>
<td>varchar(25)</td>
</tr>
<tr>
<td>code</td>
<td>int</td>
</tr>
<tr>
<td>jobTitle</td>
<td>varchar(50)</td>
</tr>
<tr>
<td>birth</td>
<td>date</td>
</tr>
<tr>
<td>note</td>
<td>varchar(255)</td>
</tr>
<tr>
<td>sex</td>
<td>varchar(5)</td>
</tr>
</tbody></table>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"># 4、将表employees的mobile字段修改到code字段后面</span><br><span class="line">ALTER TABLE employees</span><br><span class="line">MODIFY mobile VARCHAR(25) AFTER `code`;</span><br><span class="line"></span><br><span class="line"># 5、将表employees的birth字段改名为birthday</span><br><span class="line">ALTER TABLE employees</span><br><span class="line">CHANGE birth birthday DATE;</span><br><span class="line"></span><br><span class="line"># 6、修改sex字段，数据类型为char(1)</span><br><span class="line">ALTER TABLE employees</span><br><span class="line">MODIFY sex CHAR(1);</span><br><span class="line"></span><br><span class="line"># 7、删除字段note</span><br><span class="line">ALTER TABLE employees</span><br><span class="line">DROP COLUMN note;</span><br><span class="line"></span><br><span class="line"># 8、增加字段名favoriate_activity,数据类型为varchar(100)</span><br><span class="line">ALTER TABLE employees</span><br><span class="line">ADD favoriate_activity varchar(100);</span><br><span class="line"></span><br><span class="line"># 9、将表employees的名称修改为 employees_info</span><br><span class="line">RENAME TABLE employees</span><br><span class="line">TO employees_info;</span><br></pre></td></tr></table></figure>





<h1 id="第11章-数据处理之增删改"><a href="#第11章-数据处理之增删改" class="headerlink" title="第11章 数据处理之增删改"></a>第11章 数据处理之增删改</h1><h2 id="1-插入数据"><a href="#1-插入数据" class="headerlink" title="1.插入数据"></a>1.插入数据</h2><h3 id="1-1实际问题"><a href="#1-1实际问题" class="headerlink" title="1.1实际问题"></a>1.1实际问题</h3><p>解决方式：使用INSERT语句向表中插入数据。</p>
<h3 id="1-2方式1：VALUES的方式添加"><a href="#1-2方式1：VALUES的方式添加" class="headerlink" title="1.2方式1：VALUES的方式添加"></a>1.2方式1：VALUES的方式添加</h3><p>使用这种语法一次只能向表中插入<strong>一条</strong>数据。</p>
<p><strong>情况1：为表的所有字段按默认顺序插入数据</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br></pre></td><td class="code"><pre><span class="line">#0.储备工作</span><br><span class="line">USE atguigudb;</span><br><span class="line"></span><br><span class="line">CREATE TABLE IF NOT EXISTS emp1(</span><br><span class="line">id INT,</span><br><span class="line">`name` VARCHAR(15),</span><br><span class="line">hire_date DATE,</span><br><span class="line">salary DOUBLE(10,2)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">DESC emp1;</span><br><span class="line"></span><br><span class="line">SELECT *</span><br><span class="line">FROM emp1;</span><br><span class="line"></span><br><span class="line">#1.添加数据</span><br><span class="line"></span><br><span class="line">#方式1：一条一条的添加数据</span><br><span class="line"># a.没有指明添加的字段</span><br><span class="line">#正确的</span><br><span class="line">INSERT INTO emp1</span><br><span class="line">VALUES (1,&#x27;Tom&#x27;,&#x27;2000-12-21&#x27;,3400);  #注意：一定要按照声明的字段的先后顺序添加</span><br><span class="line">#错误的</span><br><span class="line">INSERT INTO emp1</span><br><span class="line">VALUES (2,3400,&#x27;2000-12-21&#x27;,&#x27;Jerry&#x27;);</span><br><span class="line"></span><br><span class="line"># b.指明要添加的字段(推荐)</span><br><span class="line">INSERT INTO emp1(id,hire_date,salary,`name`)</span><br><span class="line">VALUES (2,&#x27;1999-09-09&#x27;,4000,&#x27;Jerry&#x27;);</span><br><span class="line"># 说明：没有进行赋值的hire_date 的值为 null</span><br><span class="line">INSERT INTO emp1(id,salary,`name`)</span><br><span class="line">VALUES (3,4500,&#x27;shk&#x27;);</span><br><span class="line"></span><br><span class="line"># c.同时插入多条记录(推荐)</span><br><span class="line">INSERT INTO emp1(id,NAME,salary)</span><br><span class="line">VALUES</span><br><span class="line">(4,&#x27;Jim&#x27;,5000),</span><br><span class="line">(5,&#x27;张俊杰&#x27;,5500);</span><br><span class="line"></span><br><span class="line">#方式2：将查询结果插入到表中</span><br><span class="line"></span><br><span class="line">SELECT * FROM emp1;</span><br><span class="line"></span><br><span class="line">INSERT INTO empl(id,NAME,salary,hire_date)</span><br><span class="line">#查询语句</span><br><span class="line">SELECT employee_id,last_name,salary,hire_date  # 查询的字段一定要与添加到的表的字段一一对应</span><br><span class="line">FROM employees</span><br><span class="line">WHERE department_id IN (70,60);</span><br><span class="line"></span><br><span class="line">DESC emp1;</span><br><span class="line">DESC employees;</span><br><span class="line"></span><br><span class="line"># 说明：emp1表中要添加数据的字段的长度不能低于employees表中查询的字段的长度。</span><br><span class="line"># 如果emp1表中要添加数据的字段的长度低于employees表中查询的字段的长度的话，就有添加不成功的风险。</span><br><span class="line"></span><br><span class="line">#2.更新数据(或修改数据)</span><br><span class="line"># UPDATE .... SET .... WHERE ...</span><br><span class="line"># 可以实现批量修改数据的。</span><br><span class="line"></span><br><span class="line">UPDATE emp1</span><br><span class="line">SET hire_date = CURDATE()</span><br><span class="line">WHERE id = 5;</span><br><span class="line"></span><br><span class="line">SELECT * FROM emp1;</span><br><span class="line"></span><br><span class="line"># 同时修改一条数据的多个字段</span><br><span class="line">UPDATE emp1</span><br><span class="line">SET hire_date = CURDATE(),salary = 6000</span><br><span class="line">WHERE id = 4;</span><br><span class="line"></span><br><span class="line">SELECT * FROM emp1;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># 题目：将表中姓名中包含字符a的提薪20%</span><br><span class="line">UPDATE emp1</span><br><span class="line">SET salary = salary * 1.2</span><br><span class="line">WHERE NAME LIKE &#x27;%a%&#x27;;</span><br><span class="line"></span><br><span class="line"># 修改数据时，是可能存在不成功的情况的。（可能是由于约束的影响造成的）</span><br><span class="line">UPDATE employees</span><br><span class="line">SET department_id = 10000</span><br><span class="line">WHERE employee_id = 102;</span><br><span class="line"></span><br><span class="line"># 3.删除数据 DELETE FROM .... WHERE ....</span><br><span class="line">DELETE FROM emp1</span><br><span class="line">WHERE id = 1;</span><br><span class="line"></span><br><span class="line"># 在删除数据时，也有可能因为约束的影响，导致删除失败</span><br><span class="line">DELETE FROM departments</span><br><span class="line">WHERE department_id = 50;</span><br><span class="line"></span><br><span class="line"># 小结：DML操作默认情况下，执行完以后都会自动提交数据。</span><br><span class="line"># 如果希望执行完以后不自动提交数据，则需要使用 SET autocommit = FALSE.</span><br><span class="line"></span><br><span class="line"># 4.MySQL8的新特性：计算列</span><br><span class="line">USE atguigudb;</span><br><span class="line"></span><br><span class="line">CREATE TABLE test1(</span><br><span class="line">a INT,</span><br><span class="line">b INT,</span><br><span class="line">c INT GENERATED ALWAYS AS (a+b) VIRTUAL # 字段c即为计算列</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">INSERT INTO test1(a,b)</span><br><span class="line">VALUES (10,20);</span><br><span class="line"></span><br><span class="line">SELECT * FROM test1;</span><br><span class="line"></span><br><span class="line">UPDATE test1</span><br><span class="line">SET a = 100;</span><br></pre></td></tr></table></figure>



<h3 id="插入数据"><a href="#插入数据" class="headerlink" title="插入数据"></a><strong>插入数据</strong></h3><h5 id="方式1：VALUES的方式添加"><a href="#方式1：VALUES的方式添加" class="headerlink" title="方式1：VALUES的方式添加"></a><strong>方式1：VALUES的方式添加</strong></h5><p>使用这种语法一次只能向表中插入<strong>一条</strong>数据。</p>
<p><strong>情况1：为表的所有字段按默认顺序插入数据</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">INSERT INTO 表名 </span><br><span class="line">VALUES (value1,value2,....);</span><br></pre></td></tr></table></figure>

<p>值列表中需要为表的每一个字段指定值，并且值的顺序必须和数据表中字段定义时的顺序相同。</p>
<p>举例：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">INSERT INTO departments</span><br><span class="line">VALUES (70, &#x27;Pub&#x27;, 100, 1700);</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">INSERT INTO departments</span><br><span class="line">VALUES (100, &#x27;Finance&#x27;, NULL, NULL);</span><br></pre></td></tr></table></figure>

<p><strong>情况2：为表的指定字段插入数据（推荐）</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">INSERT INTO 表名(column1 [, column2, …, columnn]) </span><br><span class="line">VALUES (value1 [,value2, …, valuen]);</span><br></pre></td></tr></table></figure>

<p>为表的指定字段插入数据，就是在INSERT语句中只向部分字段中插入值，而其他字段的值为表定义时的默认值。</p>
<p>在INSERT子句中随意列出列名,但是一旦列出,VALUES中要插入的value1，…valuen需要与column1，…columnn列一一对应。如果类型不同，将无法插入，并且MySQL会产生错误。</p>
<p>举例：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">INSERT INTO departments(department_id, department_name)</span><br><span class="line">VALUES (80, &#x27;IT&#x27;);</span><br></pre></td></tr></table></figure>

<p><strong>情况3：同时插入多条记录（推荐）</strong></p>
<p>INSERT语句可以同时向数据表中插入多条记录，插入时指定多个值列表，每个值列表之间用逗号分隔开，基本语法格式如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">INSERT INTO table_name </span><br><span class="line">VALUES </span><br><span class="line">(value1 [,value2, …, valuen]), </span><br><span class="line">(value1 [,value2, …, valuen]), </span><br><span class="line">……</span><br><span class="line">(value1 [,value2, …, valuen]);</span><br></pre></td></tr></table></figure>

<p>或者</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">INSERT INTO table_name(column1 [, column2, …, columnn]) </span><br><span class="line">VALUES </span><br><span class="line">(value1 [,value2, …, valuen]), </span><br><span class="line">(value1 [,value2, …, valuen]), </span><br><span class="line">……</span><br><span class="line">(value1 [,value2, …, valuen]);</span><br></pre></td></tr></table></figure>

<p>举例：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; INSERT INTO emp(emp_id,emp_name)</span><br><span class="line">    -&gt; VALUES (1001,&#x27;shkstart&#x27;),</span><br><span class="line">    -&gt; (1002,&#x27;atguigu&#x27;),</span><br><span class="line">    -&gt; (1003,&#x27;Tom&#x27;);</span><br><span class="line">Query OK, 3 rows affected (0.00 sec)</span><br><span class="line">Records: 3 Duplicates: 0 Waings: 0</span><br></pre></td></tr></table></figure>

<p>使用INSERT同时插入多条记录时，MySQL会返回一些在执行单行插入时没有的额外信息，这些信息的含义如下：</p>
<ul>
<li>Records：表明插入的记录条数。</li>
<li>Duplicates：表明插入时被忽略的记录，原因可能是这些记录包含了重复的主键值。</li>
<li>Warnings：表明有问题的数据值，例如发生数据类型转换。</li>
</ul>
<blockquote>
<p>一个同时插入多行记录的INSERT语句等同于多个单行插入的INSERT语句，但是多行的INSERT语句在处理过程中<code>效率更高</code>。因为MySQL执行单条INSERT语句插入多行数据比使用多条INSERT语句快，所以在插入多条记录时最好选择使用单条INSERT语句的方式插入。</p>
</blockquote>
<p><strong>小结：</strong></p>
<ul>
<li><code>VALUES</code> 也可以写成 <code>VALUE</code> ，但是VALUES是标准写法。</li>
<li>字符和日期型数据应包含在单引号中。</li>
</ul>
<h5 id="1-2-方式2：将查询结果插入到表中"><a href="#1-2-方式2：将查询结果插入到表中" class="headerlink" title="1.2 方式2：将查询结果插入到表中"></a><strong>1.2</strong> <strong>方式2：将查询结果插入到表中</strong></h5><p>INSERT还可以将SELECT语句查询的结果插入到表中，此时不需要把每一条记录的值一个一个输入，只需要使用一条INSERT语句和一条SELECT语句组成的组合语句即可快速地从一个或多个表中向一个表中插入多行。</p>
<p>基本语法格式如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">INSERT INTO 目标表名 (tar_column1 [, tar_column2, …, tar_columnn]) </span><br><span class="line">SELECT (src_column1 [, src_column2, …, src_columnn]) </span><br><span class="line">FROM 源表名</span><br><span class="line">[WHERE condition]</span><br></pre></td></tr></table></figure>

<ul>
<li>在 INSERT 语句中加入子查询。</li>
<li><strong>不必书写</strong> <strong>VALUES</strong> <strong>子句。</strong></li>
<li>子查询中的值列表应与 INSERT 子句中的列名对应。</li>
</ul>
<p>举例：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">INSERT INTO emp2 </span><br><span class="line">SELECT * </span><br><span class="line">FROM employees </span><br><span class="line">WHERE department_id = 90;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">INSERT INTO sales_reps(id, name, salary, commission_pct) </span><br><span class="line">SELECT employee_id, last_name, salary, commission_pct </span><br><span class="line">FROM employees </span><br><span class="line">WHERE job_id LIKE &#x27;%REP%&#x27;;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>说明：emp2表中要添加数据的字段的长度不能低于employees表中查询的字段的长度。</p>
<p>如果emp2表中要添加数据的字段的长度低于employees表中查询的字段的长度的话，就有添加不成功的风险。</p>
</blockquote>
<h3 id="2-更新数据"><a href="#2-更新数据" class="headerlink" title="2. 更新数据"></a><strong>2.</strong> <strong>更新数据</strong></h3><ul>
<li>使用 UPDATE 语句更新数据。语法如下：</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">UPDATE table_name </span><br><span class="line">SET column1=value1, column2=value2, … , column=valuen </span><br><span class="line">[WHERE condition]</span><br></pre></td></tr></table></figure>

<ul>
<li>可以一次更新<strong>多条</strong>数据。</li>
<li>如果需要回滚数据，需要保证在DML前，进行设置：<strong>SET AUTOCOMMIT &#x3D; FALSE;</strong></li>
<li>使用 <strong>WHERE</strong> 子句指定需要更新的数据。</li>
<li>如果省略 WHERE 子句，则表中的所有数据都将被更新。</li>
</ul>
<h3 id="3-删除数据"><a href="#3-删除数据" class="headerlink" title="3. 删除数据"></a><strong>3.</strong> <strong>删除数据</strong></h3><ul>
<li>使用 DELETE 语句从表中删除数据</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DELETE FROM table_name [WHERE &lt;condition&gt;];</span><br></pre></td></tr></table></figure>

<ul>
<li>使用 WHERE 子句删除指定的记录。</li>
<li>如果省略 WHERE 子句，则表中的全部数据将被删除</li>
</ul>
<h2 id="4-MySQL8新特性：计算列"><a href="#4-MySQL8新特性：计算列" class="headerlink" title="4. MySQL8新特性：计算列"></a><strong>4. MySQL8新特性：计算列</strong></h2><p>什么叫计算列呢？简单来说就是某一列的值是通过别的列计算得来的。例如，a列值为1、b列值为2，c列不需要手动插入，定义a+b的结果为c的值，那么c就是计算列，是通过别的列计算得来的。</p>
<p>在MySQL 8.0中，CREATE TABLE 和 ALTER TABLE 中都支持增加计算列。下面以CREATE TABLE为例进行讲解。</p>
<p>举例：定义数据表tb1，然后定义字段id、字段a、字段b和字段c，其中字段c为计算列，用于计算a+b的值。 首先创建测试表tb1，语句如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE tb1( </span><br><span class="line">    id INT, </span><br><span class="line">    a INT, </span><br><span class="line">    b INT, </span><br><span class="line">    c INT GENERATED ALWAYS AS (a + b) VIRTUAL </span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>插入演示数据，语句如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">INSERT INTO tb1(a,b) VALUES (100,200);</span><br></pre></td></tr></table></figure>

<p>查询数据表tb1中的数据，结果如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; SELECT * FROM tb1;</span><br><span class="line">+------+------+------+------+</span><br><span class="line">| id   | a    | b    | c    |</span><br><span class="line">+------+------+------+------+</span><br><span class="line">| NULL |  100 |  200 |  300 |</span><br><span class="line">+------+------+------+------+</span><br></pre></td></tr></table></figure>

<p>更新数据中的数据，语句如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; UPDATE tb1 SET a = 500;</span><br><span class="line">mysql&gt; SELECT * FROM tb1;</span><br><span class="line">+------+------+------+------+</span><br><span class="line">| id   | a    | b    | c    |</span><br><span class="line">+------+------+------+------+</span><br><span class="line">| NULL |  500 |  200 |  700 |</span><br><span class="line">+------+------+------+------+</span><br></pre></td></tr></table></figure>





<h2 id="综合案例"><a href="#综合案例" class="headerlink" title="综合案例"></a>综合案例</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"># 1、创建数据库test01_library</span><br><span class="line">CREATE DATABASE IF NOT EXISTS test01_library CHARACTER SET &#x27;utf8&#x27;;</span><br><span class="line"></span><br><span class="line">USE test01_library;</span><br><span class="line"></span><br><span class="line"># 2、创建表books，表结构如下：</span><br><span class="line">CREATE TABLE IF NOT EXISTS books(</span><br><span class="line">id INT,</span><br><span class="line">`name` VARCHAR(50),</span><br><span class="line">`authors` VARCHAR(100),</span><br><span class="line">price FLOAT,</span><br><span class="line">pubdate YEAR,</span><br><span class="line">note VARCHAR(100),</span><br><span class="line">num INT</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">DESC books;</span><br><span class="line">SELECT * FROM books;</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th>字段名</th>
<th>字段说明</th>
<th>数据类型</th>
</tr>
</thead>
<tbody><tr>
<td>id</td>
<td>书编号</td>
<td>INT</td>
</tr>
<tr>
<td>name</td>
<td>书名</td>
<td>VARCHAR(50)</td>
</tr>
<tr>
<td>authors</td>
<td>作者</td>
<td>VARCHAR(100)</td>
</tr>
<tr>
<td>price</td>
<td>价格</td>
<td>FLOAT</td>
</tr>
<tr>
<td>pubdate</td>
<td>出版日期</td>
<td>YEAR</td>
</tr>
<tr>
<td>note</td>
<td>说明</td>
<td>VARCHAR(100)</td>
</tr>
<tr>
<td>num</td>
<td>库存</td>
<td>INT</td>
</tr>
</tbody></table>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"># 3、向books表中插入记录</span><br><span class="line"># 1) 不指定字段名称，插入第一条记录</span><br><span class="line">INSERT INTO books</span><br><span class="line">VALUES(1,&#x27;Tal of AAA&#x27;,&#x27;Dickes&#x27;,23,&#x27;1995&#x27;,&#x27;novel&#x27;,11);</span><br><span class="line"># 2) 指定所有字段名称，插入第二记录</span><br><span class="line">INSERT INTO books(id,name,authors,price,pubdate,note,num)</span><br><span class="line">VALUES(2,&#x27;EmmaT&#x27;,&#x27;Jane lura&#x27;,35,&#x27;1993&#x27;,&#x27;joke&#x27;,22);</span><br><span class="line"># 3) 同时插入多条记录（剩下的所有记录)</span><br><span class="line">INSERT INTO books(id,name,authors,price,pubdate,note,num)</span><br><span class="line">VALUES</span><br><span class="line">(3,&#x27;Story of Jane&#x27;,&#x27;Jane Tim&#x27;,40,&#x27;2001&#x27;,&#x27;novel&#x27;,0),</span><br><span class="line">(4,&#x27;Lovey Day&#x27;,&#x27;George Byron&#x27;,20,&#x27;2005&#x27;,&#x27;novel&#x27;,30),</span><br><span class="line">(5,&#x27;Old land&#x27;,&#x27;Honore Blade&#x27;,30,&#x27;2010&#x27;,&#x27;law&#x27;,0),</span><br><span class="line">(6,&#x27;The Battle&#x27;,&#x27;Upton Sara&#x27;,30,1999,&#x27;medicine&#x27;,40),</span><br><span class="line">(7,&#x27;Rose Hood&#x27;,&#x27;Richard haggard&#x27;,28,2008,&#x27;cartoon&#x27;,28);</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th>id</th>
<th>name</th>
<th>authors</th>
<th>price</th>
<th>pubdate</th>
<th>note</th>
<th>num</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td>Tal of AAA</td>
<td>Dickes</td>
<td>23</td>
<td>1995</td>
<td>novel</td>
<td>11</td>
</tr>
<tr>
<td>2</td>
<td>EmmaT</td>
<td>Jane lura</td>
<td>35</td>
<td>1993</td>
<td>joke</td>
<td>22</td>
</tr>
<tr>
<td>3</td>
<td>Story of Jane</td>
<td>Jane Tim</td>
<td>40</td>
<td>2001</td>
<td>novel</td>
<td>0</td>
</tr>
<tr>
<td>4</td>
<td>Lovey Day</td>
<td>George Byron</td>
<td>20</td>
<td>2005</td>
<td>novel</td>
<td>30</td>
</tr>
<tr>
<td>5</td>
<td>Old land</td>
<td>Honore Blade</td>
<td>30</td>
<td>2010</td>
<td>law</td>
<td>0</td>
</tr>
<tr>
<td>6</td>
<td>The Battle</td>
<td>Upton Sara</td>
<td>30</td>
<td>1999</td>
<td>medicine</td>
<td>40</td>
</tr>
<tr>
<td>7</td>
<td>Rose Hood</td>
<td>Richard haggard</td>
<td>28</td>
<td>2008</td>
<td>cartoon</td>
<td>28</td>
</tr>
</tbody></table>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br></pre></td><td class="code"><pre><span class="line"># 4、将小说类型（novel）的书的价格都增加5。</span><br><span class="line">UPDATE books</span><br><span class="line">SET price = price + 5</span><br><span class="line">WHERE note = &#x27;novel&#x27;;</span><br><span class="line"></span><br><span class="line"># 5、将名称为EmmaT的书的价格改为40，并将说明改为drama。</span><br><span class="line">UPDATE books</span><br><span class="line">SET price = 40,note = &#x27;drama&#x27;;</span><br><span class="line">WHERE name = &#x27;EmmaT&#x27;;</span><br><span class="line"></span><br><span class="line"># 6、删除库存为0的记录。</span><br><span class="line">DELETE FROM books</span><br><span class="line">WHERE num = 0;</span><br><span class="line"></span><br><span class="line"># 7、统计书名中包含a字母的书</span><br><span class="line">SELECT name</span><br><span class="line">FROM books</span><br><span class="line">WHERE name LIKE &#x27;%a%&#x27;;</span><br><span class="line"></span><br><span class="line"># 8、统计书名中包含a字母的书的数量和库存总量</span><br><span class="line">SELECT COUNT(*),SUM(num)</span><br><span class="line">FROM books</span><br><span class="line">WHERE name LIKE &#x27;%a%&#x27;;</span><br><span class="line"></span><br><span class="line"># 9、找出&quot;novel&quot;类型的书，按照价格降序排列</span><br><span class="line">SELECT name,note,price</span><br><span class="line">FROM books</span><br><span class="line">WHERE note = &#x27;novel&#x27;</span><br><span class="line">ORDER BY price DESC;</span><br><span class="line"></span><br><span class="line"># 10、查询图书信息，按照库存量降序排列，如果库存量相同的按照note升序排列</span><br><span class="line">SELECT *</span><br><span class="line">FROM books</span><br><span class="line">ORDER BY num DESC,note ASC;</span><br><span class="line"></span><br><span class="line"># 11、按照note分类统计书的数量</span><br><span class="line">SELECT note,COUNT(*)</span><br><span class="line">FROM books</span><br><span class="line">GROUP BY note;</span><br><span class="line"></span><br><span class="line"># 12、按照note分类统计书的库存量，显示库存量超过30本的</span><br><span class="line">SELECT note,SUM(num)</span><br><span class="line">FROM books</span><br><span class="line">GROUP BY note</span><br><span class="line">HAVING SUM(num) &gt; 30;</span><br><span class="line"></span><br><span class="line"># 13、查询所有图书，每页显示5本，显示第二页</span><br><span class="line">SELECT *</span><br><span class="line">FROM books</span><br><span class="line">LIMIT 5,5;</span><br><span class="line"></span><br><span class="line"># 14、按照note分类统计书的库存量，显示库存量最多的</span><br><span class="line">SELECT note,SUM(num) sum_num</span><br><span class="line">FROM books</span><br><span class="line">GROUP BY note</span><br><span class="line">ORDER BY sum_num DESC</span><br><span class="line">LIMIT 0,1;</span><br><span class="line"></span><br><span class="line"># 15、查询书名达到10个字符的书，不包括里面的空格</span><br><span class="line">SELECT CHAR_LENGTH(REPLACE(NAME,&#x27; &#x27;,&#x27;&#x27;))</span><br><span class="line">FROM books;</span><br><span class="line"></span><br><span class="line">SELECT NAME</span><br><span class="line">FROM books</span><br><span class="line">WHERE CHAR_LENGTH(REPLACE(NAME,&#x27; &#x27;,&#x27;&#x27;)) &gt;= 10;</span><br><span class="line"></span><br><span class="line"># 16、查询书名和类型，其中note值为novel显示小说，law显示法律，medicine显示医药，cartoon显示卡通，joke显示笑话</span><br><span class="line"></span><br><span class="line">SELECT name &quot;书名&quot;,note,CASE note WHEN &#x27;novel&#x27; THEN &#x27;小说&#x27;</span><br><span class="line">                                 WHEN &#x27;law&#x27; THEN &#x27;法律&#x27;</span><br><span class="line">                                 WHEN &#x27;medicine&#x27; THEN &#x27;医药&#x27;</span><br><span class="line">                                 WHEN &#x27;cartoon&#x27; THEN &#x27;卡通&#x27;</span><br><span class="line">                                 WHEN &#x27;joke&#x27; THEN &#x27;笑话&#x27;</span><br><span class="line">                                 ELSE &#x27;其他&#x27;</span><br><span class="line">                                 END &quot;类型&quot;</span><br><span class="line">FROM books;</span><br><span class="line"></span><br><span class="line"># 17、查询书名、库存，其中num值超过30本的，显示滞销，大于0并低于10的，显示畅销，为0的显示需要无货</span><br><span class="line">SELECT name AS &quot;书名&quot;,num AS &quot;库存&quot;, CASE WHEN num &gt; 30 THEN &#x27;滞销&#x27;</span><br><span class="line">                                        WHEN num &gt; 0 AND num &lt; 10 THEN &#x27;畅销&#x27;</span><br><span class="line">                                        WHEN num = 0 THEN &#x27;无货&#x27;</span><br><span class="line">                                        END &quot;显示状态&quot;</span><br><span class="line">FROM books;</span><br><span class="line"></span><br><span class="line"># 18、统计每一种note的库存量，并合计总量</span><br><span class="line">SELECT IFNULL(note,&#x27;合计库存总量&#x27;) AS note,SUM(num)</span><br><span class="line">FROM books</span><br><span class="line">GROUP BY note WITH ROLLUP;</span><br><span class="line"></span><br><span class="line"># 19、统计每一种note的数量，并合计总量</span><br><span class="line">SELECT IFNULL(note,&#x27;合计总量&#x27;) AS note,COUNT(*)</span><br><span class="line">FROM books</span><br><span class="line">GROUP BY note WITH ROLLUP;</span><br><span class="line"></span><br><span class="line"># 20、统计库存量前三名的图书</span><br><span class="line">SELECT *</span><br><span class="line">FROM books</span><br><span class="line">ORDER BY num DESC</span><br><span class="line">LIMIT 0,3;</span><br><span class="line"></span><br><span class="line"># 21、找出最早出版的一本书</span><br><span class="line">SELECT *</span><br><span class="line">FROM books</span><br><span class="line">ORDER BY pubdate ASC</span><br><span class="line">LIMIT 0,1;</span><br><span class="line"></span><br><span class="line"># 22、找出novel中价格最高的一本书</span><br><span class="line">SELECT *</span><br><span class="line">FROM books</span><br><span class="line">WHERE note = &#x27;novel&#x27;</span><br><span class="line">ORDER BY price DESC</span><br><span class="line">LIMIT 0,1;</span><br><span class="line"></span><br><span class="line"># 23、找出书名中字数最多的一本书，不含空格</span><br><span class="line">SELECT *</span><br><span class="line">FROM books</span><br><span class="line">ORDER BY CHAR_LENGTH(REPLACE(NAME,&#x27; &#x27;,&#x27;&#x27;)) DESC</span><br><span class="line">LIMIT 0,1;</span><br></pre></td></tr></table></figure>





<h1 id="第11章-数据处理之增删改-1"><a href="#第11章-数据处理之增删改-1" class="headerlink" title="第11章 数据处理之增删改"></a>第11章 数据处理之增删改</h1><h3 id="练习1-1"><a href="#练习1-1" class="headerlink" title="练习1"></a>练习1</h3><p>题目：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br></pre></td><td class="code"><pre><span class="line"># 1.创建数据库dbtest11</span><br><span class="line">CREATE DATABASE IF NOT EXISTS dbtest11 CHARACTER SET &#x27;utf8&#x27;;</span><br><span class="line"></span><br><span class="line"># 2.运行以下脚本创建表my_employees</span><br><span class="line">USE dbtest11;</span><br><span class="line">CREATE TABLE my_employees(</span><br><span class="line">    id INT(10),</span><br><span class="line">    first_name VARCHARy(10),</span><br><span class="line">    last_name VARCHAR(10),</span><br><span class="line">    userid VARCHAR(10),</span><br><span class="line">    salary DOUBLE(10,2)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">CREATE TABLE users(</span><br><span class="line">    id INT,</span><br><span class="line">    userid VARCHAR(10),</span><br><span class="line">    department_id INT</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"># 3.显示表my_employees的结构</span><br><span class="line">DESC my_employees;</span><br><span class="line"></span><br><span class="line"># 4.向my_employees表中插入下列数据</span><br><span class="line">ID  FIRST_NAME  LAST_NAME  USERID    SALARY</span><br><span class="line">1   patel       Ralph      Rpatel    895</span><br><span class="line">2   Dancs       Betty      Bdancs    860</span><br><span class="line">3   Biri        Ben        Bbiri     1100</span><br><span class="line">4   Newman      Chad       Cnewman   750</span><br><span class="line">5   Ropeburn    Audrey     Aropebur  1550</span><br><span class="line"></span><br><span class="line"># 方式一：</span><br><span class="line">INSERT INTO my_employees(ID,FIRST_NAME,LAST_NAME,USERID,SALARY)</span><br><span class="line">VALUES</span><br><span class="line">(1,&#x27;patel&#x27;,&#x27;Ralph&#x27;,&#x27;Rpatel&#x27;,895),</span><br><span class="line">(2,&#x27;Dancs&#x27;,&#x27;Betty&#x27;,&#x27;Bdancs&#x27;,860),</span><br><span class="line">(3,&#x27;Biri&#x27;,&#x27;Ben&#x27;,&#x27;Bbiri&#x27;,1100),</span><br><span class="line">(4,&#x27;Newman&#x27;,&#x27;Chad&#x27;,&#x27;Cnewman&#x27;,750),</span><br><span class="line">(5,&#x27;Ropeburn&#x27;,&#x27;Audrey&#x27;,&#x27;Aropebur&#x27;,1550);</span><br><span class="line"></span><br><span class="line"># 方式二：</span><br><span class="line">INSERT INTO my_employees</span><br><span class="line">SELECT 1,&#x27;patel&#x27;,&#x27;Ralph&#x27;,&#x27;Rpatel&#x27;,895 UNION ALL</span><br><span class="line">SELECT 2,&#x27;Dancs&#x27;,&#x27;Betty&#x27;,&#x27;Bdancs&#x27;,860 UNION ALL</span><br><span class="line">SELECT 3,&#x27;Biri&#x27;,&#x27;Ben&#x27;,&#x27;Bbiri&#x27;,1100 UNION ALL</span><br><span class="line">SELECT 4,&#x27;Newman&#x27;,&#x27;Chad&#x27;,&#x27;Cnewman&#x27;,750 UNION ALL</span><br><span class="line">SELECT 5,&#x27;Ropeburn&#x27;,&#x27;Audrey&#x27;,&#x27;Aropebur&#x27;,1550;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">SELECT * FROM my_employees;</span><br><span class="line"></span><br><span class="line"># 5.向users表中插入数据</span><br><span class="line">1  Rpatel    10</span><br><span class="line">2  Bdancs    10</span><br><span class="line">3  Bbiri     20</span><br><span class="line">4  Cnewman   30</span><br><span class="line">5  Aropebur  40</span><br><span class="line"></span><br><span class="line">INSERT INTO users VALUES</span><br><span class="line">(1,Rpatel,10),</span><br><span class="line">(2,Bdancs,10),</span><br><span class="line">(3,Bbiri,20),</span><br><span class="line">(4,Cnewman,30),</span><br><span class="line">(5,Aropebur,40);</span><br><span class="line"></span><br><span class="line">SELECT * FROM users;</span><br><span class="line"></span><br><span class="line"># 6.将3号员工的last_name修改为&quot;drelxer&quot;</span><br><span class="line">UPDATE my_employees</span><br><span class="line">SET last_name = &#x27;drelxer&#x27;</span><br><span class="line">WHERE id = 3;</span><br><span class="line"></span><br><span class="line"># 7.将所有工资少于900的员工的工资修改为1000</span><br><span class="line">UPDATE my_employees</span><br><span class="line">SET salary = 1000</span><br><span class="line">WHERE salary &lt; 900;</span><br><span class="line"></span><br><span class="line"># 8.将userid为Bbiri的user表和my_employees表的记录全部删除</span><br><span class="line"># 方式1：</span><br><span class="line">DELETE FROM my_employees</span><br><span class="line">WHERE userid = &#x27;Bbiri&#x27;;</span><br><span class="line">DELETE FROM users</span><br><span class="line">WHERE userid = &#x27;Bbiri&#x27;;</span><br><span class="line"></span><br><span class="line"># 方式2：</span><br><span class="line">DELETE m,u</span><br><span class="line">FROM my_employees m</span><br><span class="line">JOIN users u</span><br><span class="line">ON m.userid = u.userid</span><br><span class="line">WHERE u.userid=&#x27;Bbiri&#x27;</span><br><span class="line"></span><br><span class="line">SELECT * FROM my_employees;</span><br><span class="line">SELECT * FROM users;</span><br><span class="line"></span><br><span class="line"># 9.删除my_employees、users表所有数据</span><br><span class="line">DELETE FROM my_employees;</span><br><span class="line">DELETE FROM users;</span><br><span class="line"></span><br><span class="line"># 10.检查所作的修正</span><br><span class="line">SELECT * FROM my_employees;</span><br><span class="line">SELECT * FROM users;</span><br><span class="line"></span><br><span class="line"># 11.清空表my_employees</span><br><span class="line">TRUNCATE TABLE my_employees;</span><br></pre></td></tr></table></figure>



<h3 id="练习2-1"><a href="#练习2-1" class="headerlink" title="练习2"></a>练习2</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"># 1.使用现有数据库dbtest11</span><br><span class="line">USE dbtest11;</span><br><span class="line"></span><br><span class="line"># 2.创建表格pet</span><br><span class="line">CREATE TABLE pet(</span><br><span class="line">name VARCHAR(20),</span><br><span class="line">owner VARCHAR(20),</span><br><span class="line">species VARCHAR(20),</span><br><span class="line">sex CHAR(1),</span><br><span class="line">birth YEAR,</span><br><span class="line">death YEAR</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">DESC pet;</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th>字段名</th>
<th>字段说明</th>
<th>数据类型</th>
</tr>
</thead>
<tbody><tr>
<td>name</td>
<td>宠物名称</td>
<td>VARCHAR(20)</td>
</tr>
<tr>
<td>owner</td>
<td>宠物主人</td>
<td>VARCHAR(20)</td>
</tr>
<tr>
<td>species</td>
<td>种类</td>
<td>VARCHAR(20)</td>
</tr>
<tr>
<td>sex</td>
<td>性别</td>
<td>CHAR(1)</td>
</tr>
<tr>
<td>birth</td>
<td>出生日期</td>
<td>YEAR</td>
</tr>
<tr>
<td>death</td>
<td>死亡日期</td>
<td>YEAR</td>
</tr>
</tbody></table>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"># 3.添加记录</span><br><span class="line">INSERT INTO pet VALUES</span><br><span class="line">(&#x27;Fluffy&#x27;,&#x27;harold&#x27;,&#x27;Cat&#x27;,&#x27;f&#x27;,&#x27;2003&#x27;,&#x27;2010&#x27;),</span><br><span class="line">(&#x27;Claws&#x27;,&#x27;gwen&#x27;,&#x27;Cat&#x27;,&#x27;m&#x27;,&#x27;2004&#x27;,NULL),</span><br><span class="line">(&#x27;Buffy&#x27;,NULL,&#x27;Dog&#x27;,&#x27;f&#x27;,&#x27;2009&#x27;,NULL),</span><br><span class="line">(&#x27;Fang&#x27;,&#x27;benny&#x27;,&#x27;Dog&#x27;,&#x27;m&#x27;,&#x27;2000&#x27;,NULL),</span><br><span class="line">(&#x27;bowser&#x27;,&#x27;diane&#x27;,&#x27;Dog&#x27;,&#x27;m&#x27;,&#x27;2003&#x27;,&#x27;2009&#x27;),</span><br><span class="line">(&#x27;Chirpy&#x27;,NULL,&#x27;Bird&#x27;,&#x27;f&#x27;,&#x27;2008&#x27;,NULL)</span><br><span class="line"></span><br><span class="line">SELECT * FROM pet;</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th>name</th>
<th>owner</th>
<th>species</th>
<th>sex</th>
<th>birth</th>
<th>death</th>
</tr>
</thead>
<tbody><tr>
<td>Fluffy</td>
<td>harold</td>
<td>Cat</td>
<td>f</td>
<td>2003</td>
<td>2010</td>
</tr>
<tr>
<td>Claws</td>
<td>gwen</td>
<td>Cat</td>
<td>m</td>
<td>2004</td>
<td></td>
</tr>
<tr>
<td>Buffy</td>
<td></td>
<td>Dog</td>
<td>f</td>
<td>2009</td>
<td></td>
</tr>
<tr>
<td>Fang</td>
<td>benny</td>
<td>Dog</td>
<td>m</td>
<td>2000</td>
<td></td>
</tr>
<tr>
<td>bowser</td>
<td>diane</td>
<td>Dog</td>
<td>m</td>
<td>2003</td>
<td>2009</td>
</tr>
<tr>
<td>Chirpy</td>
<td></td>
<td>Bird</td>
<td>f</td>
<td>2008</td>
<td></td>
</tr>
</tbody></table>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"># 4.添加字段：主人的生日owner_birth DATE类型。</span><br><span class="line">ALTER TABLE pet</span><br><span class="line">ADD owner_birth DATE;</span><br><span class="line"></span><br><span class="line"># 5.将名称为Claws的猫的主人改为kevin</span><br><span class="line">UPDATE pet</span><br><span class="line">SET owner = &#x27;kevin&#x27;</span><br><span class="line">WHERE name = &#x27;Claws&#x27; AND species = &#x27;Cat&#x27;;</span><br><span class="line"></span><br><span class="line"># 6.将没有死的狗的主人改为duck</span><br><span class="line">UPDATE pet</span><br><span class="line">SET owner = &#x27;duck&#x27;</span><br><span class="line">WHERE death IS NULL AND species = &#x27;Dog&#x27;;</span><br><span class="line"></span><br><span class="line"># 7.查询没有主人的宠物的名字;</span><br><span class="line">SELECT name</span><br><span class="line">FROM pet</span><br><span class="line">WHERE OWNER IS NULL;</span><br><span class="line"></span><br><span class="line"># 8.查询已经死了的cat的姓名，主人，以及去世时间;</span><br><span class="line">SELECT name,owner,death</span><br><span class="line">FROM pet</span><br><span class="line">WHERE death IS NOT NULL;</span><br><span class="line"></span><br><span class="line"># 9.删除已经死亡的狗</span><br><span class="line">DELETE FROM pet</span><br><span class="line">WHERE death IS NOT NULL</span><br><span class="line">AND species = &#x27;Dog&#x27;;</span><br><span class="line"></span><br><span class="line"># 10.查询所有宠物信息</span><br><span class="line">SELECT *</span><br><span class="line">FROM pet;</span><br></pre></td></tr></table></figure>



<h3 id="练习3-1"><a href="#练习3-1" class="headerlink" title="练习3"></a>练习3</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"># 1.使用已有的数据库dbtest11</span><br><span class="line">USE dbtest11;</span><br><span class="line"></span><br><span class="line"># 2.创建表employee，并添加记录</span><br><span class="line">CREATE TABLE employee(</span><br><span class="line">id INT,</span><br><span class="line">name VARCHAR(15),</span><br><span class="line">sex CHAR(1),</span><br><span class="line">tel VARCHAR(25),</span><br><span class="line">addr VARCHAR(35),</span><br><span class="line">salary DOUBLE(10,2)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">INSERT INTO employee(id,name,sex,tel,addr,salary)VALUES</span><br><span class="line">(10001,&#x27;张一一&#x27;,&#x27;男&#x27;,&#x27;13456789000&#x27;,&#x27;山东青岛&#x27;,1001.58),</span><br><span class="line">(10002,&#x27;刘小红&#x27;,&#x27;女&#x27;,&#x27;13454319000&#x27;,&#x27;河北保定&#x27;,1201.21),</span><br><span class="line">(10003,&#x27;李四&#x27;,&#x27;男&#x27;,&#x27;0751-1234567&#x27;,&#x27;广东佛山&#x27;,1004.11),</span><br><span class="line">(10004,&#x27;刘小强&#x27;,&#x27;男&#x27;,&#x27;0755-5555555&#x27;,&#x27;广东深圳&#x27;,1501.23),</span><br><span class="line">(10005,&#x27;王艳&#x27;,&#x27;男&#x27;,&#x27;020-1232133&#x27;,&#x27;广东广州&#x27;,1405.16);</span><br><span class="line"></span><br><span class="line">SELECT * FROM employee;</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th>id</th>
<th>name</th>
<th>sex</th>
<th>tel</th>
<th>addr</th>
<th>salary</th>
</tr>
</thead>
<tbody><tr>
<td>10001</td>
<td>张一一</td>
<td>男</td>
<td>13456789000</td>
<td>山东青岛</td>
<td>1001.58</td>
</tr>
<tr>
<td>10002</td>
<td>刘小红</td>
<td>女</td>
<td>13454319000</td>
<td>河北保定</td>
<td>1201.21</td>
</tr>
<tr>
<td>10003</td>
<td>李四</td>
<td>男</td>
<td>0751-1234567</td>
<td>广东佛山</td>
<td>1004.11</td>
</tr>
<tr>
<td>10004</td>
<td>刘小强</td>
<td>男</td>
<td>0755-5555555</td>
<td>广东深圳</td>
<td>1501.23</td>
</tr>
<tr>
<td>10005</td>
<td>王艳</td>
<td>女</td>
<td>020-1232133</td>
<td>广东广州</td>
<td>1405.16</td>
</tr>
</tbody></table>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"># 3.查询出薪资在1200~1300之间的员工信息。</span><br><span class="line">SELECT *</span><br><span class="line">FROM employee</span><br><span class="line">WHERE salary BETWEEN 1200 AND 1300;</span><br><span class="line"></span><br><span class="line"># 4.查询出姓“刘”的员工的工号，姓名，家庭住址。</span><br><span class="line">SELECT id,name,addr</span><br><span class="line">FROM employee</span><br><span class="line">WHERE name LIKE &#x27;刘%&#x27;;</span><br><span class="line"></span><br><span class="line"># 5.将“李四”的家庭住址改为“广东韶关”</span><br><span class="line">UPDATE employee</span><br><span class="line">SET addr = &#x27;广东韶关&#x27;</span><br><span class="line">WHERE name = &#x27;李四&#x27;;</span><br><span class="line"></span><br><span class="line"># 6.查询出名字中带“小”的员工</span><br><span class="line">SELECT *</span><br><span class="line">FROM employee</span><br><span class="line">WHERE name LIKE &#x27;%小%&#x27;;</span><br></pre></td></tr></table></figure>





<h1 id="第12章-MySQL数据类型精讲"><a href="#第12章-MySQL数据类型精讲" class="headerlink" title="第12章 MySQL数据类型精讲"></a>第12章 MySQL数据类型精讲</h1><h2 id="1-MySQL中的数据类型"><a href="#1-MySQL中的数据类型" class="headerlink" title="1.MySQL中的数据类型"></a>1.MySQL中的数据类型</h2><table>
<thead>
<tr>
<th>类型</th>
<th>类型举例</th>
</tr>
</thead>
<tbody><tr>
<td>整数类型</td>
<td>TINYINT、SMALLINT、MEDIUMINT、INT(或INTEGER)、BIGINT</td>
</tr>
<tr>
<td>浮点类型</td>
<td>FLOAT、DOUBLE</td>
</tr>
<tr>
<td>定点数类型</td>
<td>DECIMAL</td>
</tr>
<tr>
<td>位类型</td>
<td>BIT</td>
</tr>
<tr>
<td>日期时间类型</td>
<td>YEAR、TIME、DATE、DATETIME、TIMESTAMP</td>
</tr>
<tr>
<td>文本字符串类型</td>
<td>CHAR、VARCHAR、TINYTEXT、TEXT、MEDIUMTEXT、LONGTEXT</td>
</tr>
<tr>
<td>枚举类型</td>
<td>ENUM</td>
</tr>
<tr>
<td>集合类型</td>
<td>SET</td>
</tr>
<tr>
<td>二进制字符串类型</td>
<td>BINARY、VARBINARY、TINYBLOB、BLOB、MEDIUMBLOB、LONGBLOB</td>
</tr>
<tr>
<td>JSON类型</td>
<td>JSON对象、JSON数组</td>
</tr>
<tr>
<td>空间数据类型</td>
<td>单值类型：GEOMETRY、POINT、LINESTRING、POLYGON;<br/>集合类型：MULTIPOINT、MULTILINESTRING、MULTIPOLYGON、GEOMETRYCOLLECTION</td>
</tr>
</tbody></table>
<p>常见数据类型的属性，如下：</p>
<table>
<thead>
<tr>
<th>MySQL关键字</th>
<th>含义</th>
</tr>
</thead>
<tbody><tr>
<td>NULL</td>
<td>数据列可包含NULL值</td>
</tr>
<tr>
<td>NOT NULL</td>
<td>数据列不允许包含NULL值</td>
</tr>
<tr>
<td>DEFAULT</td>
<td>默认值</td>
</tr>
<tr>
<td>PRIMARY KEY</td>
<td>主键</td>
</tr>
<tr>
<td>AUTO_INCREMENT</td>
<td>自动递增，适用于整数类型</td>
</tr>
<tr>
<td>UNSIGNED</td>
<td>无符号</td>
</tr>
<tr>
<td>CHARACTER SET name</td>
<td>指定一个字符集</td>
</tr>
</tbody></table>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"># 关于属性：character set name</span><br><span class="line"></span><br><span class="line">SHOW VARIABLES LIKE &#x27;character_%&#x27;;</span><br><span class="line"></span><br><span class="line"># 创建数据库时指名字符集</span><br><span class="line">CREATE DATABASE IF NOT EXISTS dbtest12 CHARACTER SET &#x27;utf8&#x27;;</span><br><span class="line"></span><br><span class="line">SHOW CREATE DATABASE dbtest12;</span><br><span class="line"></span><br><span class="line"># 创建表的时候，指名表的字符集</span><br><span class="line">CREATE TABLE temp (</span><br><span class="line">id INT</span><br><span class="line">) CHARACTER SET &#x27;utf8&#x27;;</span><br><span class="line"></span><br><span class="line">SHOW CREATE TABLE temp;</span><br><span class="line"></span><br><span class="line"># 创建表，指名表中的字段时，可以指定字段的字符集</span><br><span class="line">CREATE TABLE temp1(</span><br><span class="line">id INT,</span><br><span class="line">NAME VARCHAR(15) CHARACTER SET &#x27;gbk&#x27;</span><br><span class="line">);</span><br><span class="line">SHOW CREATE TABLE temp1;</span><br></pre></td></tr></table></figure>



<h2 id="2-整数类型"><a href="#2-整数类型" class="headerlink" title="2.整数类型"></a>2.整数类型</h2><h3 id="2-1-类型介绍"><a href="#2-1-类型介绍" class="headerlink" title="2.1 类型介绍"></a>2.1 类型介绍</h3><p>整数类型一共有5种，包括TINYINT、SMALLINT、MEDIUMINT、INT（INTEGER）和BIGINT。</p>
<p>它们的区别如下表所示：</p>
<table>
<thead>
<tr>
<th>整数类型</th>
<th>字节</th>
<th>有符号数取值范围</th>
<th>无符号数取值范围</th>
</tr>
</thead>
<tbody><tr>
<td>TINYINT</td>
<td>1</td>
<td>-128~127</td>
<td>0~255</td>
</tr>
<tr>
<td>SMALLINT</td>
<td>2</td>
<td>-32768~32767</td>
<td>0~65535</td>
</tr>
<tr>
<td>MEDIUMINT</td>
<td>3</td>
<td>-8388608~8388607</td>
<td>0~16777215</td>
</tr>
<tr>
<td>INT、INTEGER</td>
<td>4</td>
<td>-2147483648~2147483647</td>
<td>0~4294967295</td>
</tr>
<tr>
<td>BIGINT</td>
<td>8</td>
<td>-9223372036854775808~9223372036854775807</td>
<td>0~18446744073709551615</td>
</tr>
</tbody></table>
<blockquote>
<p>无符号指的是无负数的意思。</p>
</blockquote>
<h3 id="2-2-可选属性"><a href="#2-2-可选属性" class="headerlink" title="2.2 可选属性"></a>2.2 可选属性</h3><p>整数类型的可选属性有三个：</p>
<h4 id="2-2-1-M"><a href="#2-2-1-M" class="headerlink" title="2.2.1 M"></a>2.2.1 M</h4><p><code>M</code>：表示显示宽度，M的取值范围是(0，255)。例如，int(5)：当数据宽度小于5位的时候在数字前面需要用字符填满宽度。该项功能需要配合“<code>ZEROFILL</code>”使用，表示用“0”填满宽度，否则指定显示宽度无效。</p>
<p>如果设置了显示宽度，那么插入的数据宽度超过显示宽度限制，会不会截断或插入失败?</p>
<p>答案：不会对插入的数据有任何影响，还是按照类型的实际宽度进行保存，即<code>显示宽度与类型可以存储的值范围无关</code>。<strong>从MySQL 8.0.17开始，整数数据类型不推荐使用显示宽度属性。</strong></p>
<p>整型数据类型可以在定义表结构时指定所需要的显示宽度，如果不指定，则系统为每一种类型指定默认的宽度值。</p>
<p>举例：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE test_int1 ( x TINYINT, y SMALLINT, z MEDIUMINT, m INT, n BIGINT );</span><br></pre></td></tr></table></figure>

<p>查看表结构（MySQL5.7中显式如下，MySQL8中不再显式范围）</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; desc test_int1;</span><br><span class="line">+-------+--------------+------+-----+---------+-------+</span><br><span class="line">| Field | Type         | Null | Key | Default | Extra |</span><br><span class="line">+-------+--------------+------+-----+---------+-------+</span><br><span class="line">| x     | tinyint(4)   | YES  |     | NULL    |       |</span><br><span class="line">| y     | smallint(6)  | YES  |     | NULL    |       |</span><br><span class="line">| z     | mediumint(9) | YES  |     | NULL    |       |</span><br><span class="line">| m     | int(11)      | YES  |     | NULL    |       |</span><br><span class="line">| n     | bigint(20)   | YES  |     | NULL    |       |</span><br><span class="line">+-------+--------------+------+-----+---------+-------+</span><br><span class="line">5 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<p>TINYINT有符号数和无符号数的取值范围分别为-128<del>127和0</del>255，由于负号占了一个数字位，因此TINYINT默认的显示宽度为4。同理，其他整数类型的默认显示宽度与其有符号数的最小值的宽度相同。</p>
<p>举例：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE test_int2(</span><br><span class="line">f1 INT,</span><br><span class="line">f2 INT(5),</span><br><span class="line">f3 INT(5) ZEROFILL</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">DESC test_int2;</span><br><span class="line"></span><br><span class="line">INSERT INTO test_int2(f1,f2,f3)</span><br><span class="line">VALUES(1,123,123);</span><br><span class="line"></span><br><span class="line">INSERT INTO test_int2(f1,f2)</span><br><span class="line">VALUES(123456, 123456);</span><br><span class="line"></span><br><span class="line">INSERT INTO test_int2(f1,f2,f3)</span><br><span class="line">VALUES(123456, 123456, 123456);</span><br><span class="line"></span><br><span class="line">mysql&gt; SELECT * FROM test_int2;</span><br><span class="line">+--------+--------+--------+</span><br><span class="line">| f1     | f2     | f3     |</span><br><span class="line">+--------+--------+--------+</span><br><span class="line">|      1 |    123 |  00123 |</span><br><span class="line">| 123456 | 123456 |   NULL |</span><br><span class="line">| 123456 | 123456 | 123456 |</span><br><span class="line">+--------+--------+--------+</span><br><span class="line">3 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>



<h3 id="2-2-2-UNSIGNED"><a href="#2-2-2-UNSIGNED" class="headerlink" title="2.2.2 UNSIGNED"></a>2.2.2 UNSIGNED</h3><p><code>UNSIGNED</code>：无符号类型（非负），所有的整数类型都有一个可选的属性UNSIGNED（无符号属性），无符号整数类型的最小取值为0。所以，如果需要在MySQL数据库中保存非负整数值时，可以将整数类型设置为无符号类型。</p>
<p>int类型默认显示宽度为int(11)，无符号int类型默认显示宽度为int(10)。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE test_int3(</span><br><span class="line">f1 INT UNSIGNED</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">mysql&gt; DESC test_int3;</span><br><span class="line">+-------+------------------+------+-----+---------+-------+</span><br><span class="line">| Field | Type             | Null | Key | Default | Extra |</span><br><span class="line">+-------+------------------+------+-----+---------+-------+</span><br><span class="line">| f1    | int(10) unsigned | YES  |     | NULL    |       |</span><br><span class="line">+-------+------------------+------+-----+---------+-------+</span><br><span class="line">1 row in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">INSERT INTO test_int3</span><br><span class="line">VALUES (2412321);</span><br><span class="line"></span><br><span class="line"># ERROR 1264 (22003): Out of range value for column &#x27;f1&#x27; at row 1</span><br><span class="line">INSERT INTO test_int3</span><br><span class="line">VALUES (4294967296);</span><br></pre></td></tr></table></figure>









<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"># 2.整型数据类型</span><br><span class="line">USE dbtest12;</span><br><span class="line"></span><br><span class="line">CREATE TABLE test_int1(</span><br><span class="line">f1 TINYINT,</span><br><span class="line">f2 SMALLINT,</span><br><span class="line">f3 MEDIUMINT,</span><br><span class="line">f4 INTEGER,</span><br><span class="line">f5 BIGINT</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">DESC test_int1;</span><br><span class="line"></span><br><span class="line">INSERT INTO test_int1(f1)</span><br><span class="line">VALUES(12), (-12), (-128), (127);</span><br><span class="line"></span><br><span class="line">SELECT * FROM test_int1;</span><br><span class="line"></span><br><span class="line"># Out of range value for column &#x27;f1&#x27; at row 1</span><br><span class="line">INSERT INTO test_int1(f1)</span><br><span class="line">VALUES(128);</span><br><span class="line"></span><br><span class="line">CREATE TABLE test_int2(</span><br><span class="line">f1 INT,</span><br><span class="line">f2 INT(5),</span><br><span class="line">f3 INT(5) ZEROFILL  #显示宽度为5。当insert的值不足5位时，使用0填充。当使用ZEROFILL时，自动会添加UNSIGNED</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">INSERT INTO test_int2(f1,f2)</span><br><span class="line">VALUES(123,123),(123456,123456);</span><br><span class="line"></span><br><span class="line">mysql&gt; SELECT * FROM test_int2;</span><br><span class="line">+--------+--------+------+</span><br><span class="line">| f1     | f2     | f3   |</span><br><span class="line">+--------+--------+------+</span><br><span class="line">|    123 |    123 | NULL |</span><br><span class="line">| 123456 | 123456 | NULL |</span><br><span class="line">+--------+--------+------+</span><br><span class="line">2 rows in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">INSERT INTO test_int2(f3)</span><br><span class="line">VALUES(123),(123456);</span><br><span class="line"></span><br><span class="line">mysql&gt; SELECT * FROM test_int2;</span><br><span class="line">+--------+--------+--------+</span><br><span class="line">| f1     | f2     | f3     |</span><br><span class="line">+--------+--------+--------+</span><br><span class="line">|    123 |    123 |   NULL |</span><br><span class="line">| 123456 | 123456 |   NULL |</span><br><span class="line">|   NULL |   NULL |  00123 |</span><br><span class="line">|   NULL |   NULL | 123456 |</span><br><span class="line">+--------+--------+--------+</span><br><span class="line">4 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>



<h3 id="2-2-3-ZEROFILL"><a href="#2-2-3-ZEROFILL" class="headerlink" title="2.2.3 ZEROFILL"></a>2.2.3 ZEROFILL</h3><p><code>ZEROFILL</code>：0填充，（如果某列是ZEROFILL，那么MySQL会自动为当前列添加UNSIGNED属性），如果指定了ZEROFILL只是表示不够M位时，用0在左边填充，如果超过M位，只要不超过数据存储范围即可。</p>
<p>原来，在int(M)中，M的值跟int(M)所占多少存储空间并无任何关系。int(3)、int(4)、int(8)在磁盘上都是占用4 bytes的存储空间。也就是说，<strong>int(M)，必须和UNSIGNED ZEROFILL一起使用才有意义。</strong>如果整数值超过M位，就按照实际位数存储。只是无须再用字符0进行填充。</p>
<h3 id="2-3-适用场景"><a href="#2-3-适用场景" class="headerlink" title="2.3 适用场景"></a>2.3 适用场景</h3><p><code>TINYINT</code>：一般用于枚举数据，比如系统设定取值范围很小且固定的场景。</p>
<p><code>SMALLINT</code>：可以用于较小范围的统计数据，比如统计工厂的固定资产库存数量等。</p>
<p><code>MEDIUMINT</code>：用于较大整数的计算，比如车站每日的客流量等。</p>
<p><code>BIGINT</code>：只有当你处理特别巨大的整数时才会用到。比如双十一的交易量、大型门户网站点击量、证券公司衍生产品持仓等。</p>
<h3 id="2-4-如何选择？"><a href="#2-4-如何选择？" class="headerlink" title="2.4 如何选择？"></a>2.4 如何选择？</h3><p>在评估用哪种整数类型的时候，你需要考虑<code>存储空间</code>和<code>可靠性</code>的平衡问题：一方面，用占用字节数少的整数类型可以节省存储空间；另一方面，要是为了节省存储空间，使用的整数类型取值范围太小，一旦遇到超出取值范围的情况，就可能引起<code>系统错误</code>，影响可靠性。</p>
<p>举个例子，商品编号采用的数据类型是INT。原因就在于，客户门店中流通的商品种类较多，而且，每天都有旧商品下架，新商品上架，这样不断迭代，日积月累。</p>
<p>如果使用 SMALLINT 类型，虽然占用字节数比INT类型的整数少，但是却不能保证数据不会超出范围65535。相反，使用INT，就能确保有足够大的取值范围，不用担心数据超出范围影响可靠性的问题。</p>
<p>你要注意的是，在实际工作中，<strong>系统故障产生的成本远远超过增加几个字段存储空间所产生的成本</strong>。因此，<br>我建议你首先确保数据不会超过取值范围，在这个前提之下，再去考虑如何节省存储空间。</p>
<h2 id="3-浮点类型"><a href="#3-浮点类型" class="headerlink" title="3.浮点类型"></a>3.浮点类型</h2><h3 id="3-1-类型介绍"><a href="#3-1-类型介绍" class="headerlink" title="3.1 类型介绍"></a>3.1 类型介绍</h3><p>浮点数和定点数类型的特点是可以<code>处理小数</code>，你可以把整数看成小数的一个特例。因此，浮点数和定点数的使用场景，比整数大多了。MySQL支持的浮点数类型，分别是FLOAT、DOUBLE、REAL。</p>
<ul>
<li>FLOAT表示单精度浮点数；</li>
<li>DOUBLE表示双精度浮点数；</li>
</ul>
<table>
<thead>
<tr>
<th>类型</th>
<th>有符号数取值范围</th>
<th>无符号数取值范围</th>
<th>占用字节数</th>
</tr>
</thead>
<tbody><tr>
<td>FLOAT</td>
<td>(-3.402823466E+38, -1.175494351E-38), 0,(1.175494351 E-38, 3.402823466351 E+38)</td>
<td>0, (1.175494351 E-38, 3.402823466 E+38)</td>
<td>4</td>
</tr>
<tr>
<td>DOUBLE</td>
<td>(-1.7976931348623157E+308, -2.2250738585072014E-308), 0,(2.2250738585072014E-308,1.7976931348623157E+308)</td>
<td>0, (2.2250738585072014E-308,1.7976931348623157E+308)</td>
<td>8</td>
</tr>
</tbody></table>
<ul>
<li>REAL默认就是DOUBLE。如果你把SQL模式设定为启用“<code>REAL_ASLFLOAT</code>”,那么，MySQL就认为REAL是FLOAT。如果要启用“REAL_AS_FLOAT”，可以通过以下 SQL语句实现：</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SET sql_mode = &quot;REAL_AS_FLOAT&quot;;</span><br></pre></td></tr></table></figure>

<p><strong>问题1：</strong>FLOAT和DOUBLE这两种数据类型的区别是啥呢？</p>
<p>FLOAT 占用字节数少，取值范围小；DOUBLE占用字节数多，取值范围也大。</p>
<p><strong>问题2：</strong>为什么浮点数类型的无符号数取值范围，只相当于有符号数取值范围的一半，也就是只相当于有符号数取值范围大于等于零的部分呢？</p>
<p>MySQL存储浮点数的格式为：<code>符号（S）</code>、<code>尾数（M）</code>和<code>阶码（E）</code>。因此，无论有没有符号，MySQL的浮点数都会存储表示符号的部分。因此，所谓的无符号数取值范围，其实就是有符号数取值范围大于等于零的部分。</p>
<h3 id="3-2数据精度说明"><a href="#3-2数据精度说明" class="headerlink" title="3.2数据精度说明"></a>3.2数据精度说明</h3><p>对于浮点类型，在MySQL中单精度值使用4个字节，双精度值使用8个字节。</p>
<ul>
<li><p>MySQL允许使用<code>非标准语法</code>（其他数据库未必支持，因此如果涉及到数据迁移，则最好不要这么用）：<code>FLOAT（M,D）</code>或<code>DOUBLE（M,D）</code>。这里，M称为<code>精度</code>，D称为<code>标度</code>。（M,D）中M&#x3D;整数位+小数位，D&#x3D;小数位。D&lt;&#x3D;M&lt;&#x3D;255, 0&lt;&#x3D;D&lt;&#x3D;30。</p>
<p>例如，定义为FLOAT（5,2）的一个列可以显示为-999.99~999.99。如果超过这个范围会报错。</p>
</li>
<li><p>FLOAT和DOUBLE类型在不指定（M，D)时，默认会按照实际的精度（由实际的硬件和操作系统决定）来显示。</p>
</li>
<li><p>说明：浮点类型，也可以加<code>UNSIGNED</code>，但是不会改变数据范围，例如：FLOAT（3,2)UNSIGNED仍然只能表示0~9.99的范围。</p>
</li>
<li><p>不管是否显式设置了精度（M,D)，这里MySQL的处理方案如下：</p>
<ul>
<li>如果存储时，整数部分超出了范围，MySQL就会报错，不允许存这样的值</li>
<li>如果存储时，小数点部分若超出范围，就分以下情况：<ul>
<li>若四舍五入后，整数部分没有超出范围，则只警告，但能成功操作并四舍五入删除多余的小数位后保</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>查询结果是1.0999999999999999。看到了吗？虽然误差很小，但确实有误差。你也可以尝试把数据类型改成FLOAT，然后运行求和查询，得到的是，1.0999999940395355。显然，误差更大了。</p>
<p>那么，为什么会存在这样的误差呢？问题还是出在MySQL对浮点类型数据的存储方式上。</p>
<p>MySQL用4个字节存储FLOAT类型数据，用8个字节来存储DOUBLE类型数据。无论哪个，都是采用二进制的方式来进行存储的。比如9.625，用二进制来表达，就是1001.101，或者表达成1.001101×2A3。如果尾数不是0或5（比如9.624），你就无法用一个二进制数来精确表达。进而，就只好在取值允许的范围内进行四舍五入。</p>
<p>在编程中，如果用到浮点数，要特别注意误差问题，<strong>因为浮点数是不准确的，所以我们要避免使用“&#x3D;”来判断两个数是否相等。</strong>同时，在一些对精确度要求较高的项目中，干万不要使用浮点数，不然会导致结果错误，甚至是造成不可挽回的损失。那么，MySQL有没有精准的数据类型呢？当然有，这就是定点数类型：<code>DECIMAL</code>。</p>
<h2 id="4-定点数类型"><a href="#4-定点数类型" class="headerlink" title="4.定点数类型"></a>4.定点数类型</h2><h3 id="4-1类型介绍"><a href="#4-1类型介绍" class="headerlink" title="4.1类型介绍"></a>4.1类型介绍</h3><ul>
<li>MySQL中的定点数类型只有DECIMAL一种类型。</li>
</ul>
<table>
<thead>
<tr>
<th>数据类型</th>
<th>字节数</th>
<th>含义</th>
</tr>
</thead>
<tbody><tr>
<td>DECIMAL(M,D),DEC,NUMERIC</td>
<td>M+2字节</td>
<td>有效范围由M和D决定</td>
</tr>
</tbody></table>
<p>使用DECIMAL（M，D）的方式表示高精度小数。其中，M被称为精度，D被称为标度。0&lt;&#x3D;M&lt;&#x3D;65，0&lt;&#x3D;D&lt;&#x3D;30，D&lt;M。例如，定义DECIMAL（5,2）的类型，表示该列取值范围是-999.99~999.99。</p>
<ul>
<li><strong>DECIMAL（M,D）的最大取值范围与DOUBLE类型一样</strong>，但是有效的数据范围是由M和D决定的。DECIMAL的存储空间并不是固定的，由精度值M决定，总共占用的存储空间为M+2个字节。也就是说，在一些对精度要求不高的场景下，比起占用同样字节长度的定点数，浮点数表达的数值范围可以更大一些。</li>
<li>定点数在MySQL内部是以<code>字符串</code>的形式进行存储，这就决定了它一定是精准的。</li>
<li>当DECIMAL类型不指定精度和标度时，其默认为DECIMAL(10,0）。当数据的精度超出了定点数类型的精度范围时，则MySQL同样会进行四舍五入处理。</li>
<li><strong>浮点数 vs 定点数</strong><ul>
<li>浮点数相对于定点数的优点是在长度一定的情况下，浮点类型取值范围大，但是不精准，适用于需要取值范围大，又可以容忍微小误差的科学计算场景（比如计算化学、分子建模、流体动力学等）</li>
<li>定点数类型取值范围相对小，但是精准，没有误差，适合于对精度要求极高的场景（比如涉及金额计算的场景）</li>
</ul>
</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">#4.定点数类型</span><br><span class="line">CREATE TABLE test_decimal1(</span><br><span class="line">f1 DECIMAL,</span><br><span class="line">f2 DECIMAL(5,2)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">DESC test_decimal1;</span><br><span class="line">+-------+---------------+------+-----+---------+-------+</span><br><span class="line">| Field | Type          | Null | Key | Default | Extra |</span><br><span class="line">+-------+---------------+------+-----+---------+-------+</span><br><span class="line">| f1    | decimal(10,0) | YES  |     | NULL    |       |</span><br><span class="line">| f2    | decimal(5,2)  | YES  |     | NULL    |       |</span><br><span class="line">+-------+---------------+------+-----+---------+-------+</span><br></pre></td></tr></table></figure>



<h3 id="4-2-开发中经验"><a href="#4-2-开发中经验" class="headerlink" title="4.2 开发中经验"></a>4.2 开发中经验</h3><blockquote>
<p>“由于DECIMAL数据类型的精准性，在我们的项目中，除了极少数（比如商品编号）用到整数类型外，其他的数值都用的是DECIMAL，原因就是这个项目所处的零售行业，要求精准，一分钱也不能差。”——来自某项目经理</p>
</blockquote>
<h2 id="5-位类型：BIT"><a href="#5-位类型：BIT" class="headerlink" title="5.位类型：BIT"></a>5.位类型：BIT</h2><p>BIT类型中存储的是二进制值，类似010110。</p>
<table>
<thead>
<tr>
<th>二进制字符串类型</th>
<th>长度</th>
<th>长度范围</th>
<th>占用空间</th>
</tr>
</thead>
<tbody><tr>
<td>BIT(M)</td>
<td>M</td>
<td>1 &lt;&#x3D; M &lt;&#x3D; 64</td>
<td>约为（M+7）&#x2F;8个字节</td>
</tr>
</tbody></table>
<p>BIT类型，如果没有指定(M)，默认是1位。这个1位，表示只能存1位的二进制值。这里(M)是表示二进制的位数，位数最小值为1，最大值为64。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE test_bit1(</span><br><span class="line">f1 BIT,</span><br><span class="line">f2 BIT(5),</span><br><span class="line">f3 BIT(64)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">mysql&gt; DESC test_bit1;</span><br><span class="line">+-------+---------+------+-----+---------+-------+</span><br><span class="line">| Field | Type    | Null | Key | Default | Extra |</span><br><span class="line">+-------+---------+------+-----+---------+-------+</span><br><span class="line">| f1    | bit(1)  | YES  |     | NULL    |       |</span><br><span class="line">| f2    | bit(5)  | YES  |     | NULL    |       |</span><br><span class="line">| f3    | bit(64) | YES  |     | NULL    |       |</span><br><span class="line">+-------+---------+------+-----+---------+-------+</span><br><span class="line"></span><br><span class="line">INSERT INTO test_bit1(f1)</span><br><span class="line">VALUES(0),(1);</span><br><span class="line"></span><br><span class="line">SELECT *</span><br><span class="line">FROM test_bit1;</span><br><span class="line"></span><br><span class="line"># ERROR 1406 (22001): Data too long for column &#x27;f1&#x27; at row 1</span><br><span class="line">INSERT INTO test_bit1(f1)</span><br><span class="line">VALUES(2);</span><br><span class="line"></span><br><span class="line">INSERT INTO test_bit1(f2)</span><br><span class="line">VALUES(31);</span><br><span class="line"></span><br><span class="line"># ERROR 1406 (22001): Data too long for column &#x27;f1&#x27; at row 1</span><br><span class="line">INSERT INTO test_bit1(f2)</span><br><span class="line">VALUES(32);</span><br></pre></td></tr></table></figure>

<p>注意：在向BIT类型的字段中插入数据时，一定要确保插入的数据在BIT类型支持的范围内。</p>
<p>使用SELECT命令查询位字段时，可以用<code>BIN()</code>或<code>HEX()</code>函数进行读取。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"># BIN() 2进制，HEX() 16进制</span><br><span class="line">SELECT BIN(f1),BIN(f2),HEX(f1),HEX(f2)</span><br><span class="line">FROM test_bit1;</span><br><span class="line">+---------+---------+---------+---------+</span><br><span class="line">| BIN(f1) | BIN(f2) | HEX(f1) | HEX(f2) |</span><br><span class="line">+---------+---------+---------+---------+</span><br><span class="line">| 0       | NULL    | 0       | NULL    |</span><br><span class="line">| 1       | NULL    | 1       | NULL    |</span><br><span class="line">| NULL    | 11111   | NULL    | 1F      |</span><br><span class="line">+---------+---------+---------+---------+</span><br><span class="line"></span><br><span class="line"># 此时+0以后，可以以十进制的方式显示数据</span><br><span class="line">SELECT f1 + 0, f2 + 0</span><br><span class="line">FROM test_bit1;</span><br><span class="line">+--------+--------+</span><br><span class="line">| f1 + 0 | f2 + 0 |</span><br><span class="line">+--------+--------+</span><br><span class="line">|      0 |   NULL |</span><br><span class="line">|      1 |   NULL |</span><br><span class="line">|   NULL |     31 |</span><br><span class="line">+--------+--------+</span><br></pre></td></tr></table></figure>



<h2 id="6-日期与时间类型"><a href="#6-日期与时间类型" class="headerlink" title="6.日期与时间类型"></a>6.日期与时间类型</h2><p>日期与时间是重要的信息，在我们的系统中，几乎所有的数据表都用得到。原因是客户需要知道数据的时间标<br>签，从而进行数据查询、统计和处理。</p>
<p>MySQL有多种表示日期和时间的数据类型，不同的版本可能有所差异，MySQL8.0版本支持的日期和时间类型主要<br>有：YEAR类型、TIME类型、DATE类型、DATETIME类型和TIMESTAMP类型。</p>
<ul>
<li><code>YEAR</code> 类型通常用来表示年</li>
<li><code>DATE</code> 类型通常用来表示年、月、日</li>
<li><code>TIME</code> 类型通常用来表示时、分、秒</li>
<li><code>DATETIME</code> 类型通常用来表示年、月、日、时、分、秒</li>
<li><code>TIMESTAMP</code> 类型通常用来表示带时区的年、月、日、时、分、秒</li>
</ul>
<table>
<thead>
<tr>
<th>类型</th>
<th>名称</th>
<th>字节</th>
<th>日期格式</th>
<th>最小值</th>
<th>最大值</th>
</tr>
</thead>
<tbody><tr>
<td>YEAR</td>
<td>年</td>
<td>1</td>
<td>YYYY或YY</td>
<td>1901</td>
<td>2155</td>
</tr>
<tr>
<td>TIME</td>
<td>时间</td>
<td>3</td>
<td>HH:MM:SS</td>
<td>-838:59:59</td>
<td>838:59:59</td>
</tr>
<tr>
<td>DATE</td>
<td>日期</td>
<td>3</td>
<td>YYYY-MM-DD</td>
<td>1000-01-01</td>
<td>9999-12-03</td>
</tr>
<tr>
<td>DATETIME</td>
<td>日期时间</td>
<td>8</td>
<td>YYYY-MM-DD HH:MM:SS</td>
<td>1000-01-01 00:00:00</td>
<td>9999-12-31 23:59:59</td>
</tr>
<tr>
<td>TIMESTAMP</td>
<td>日期时间</td>
<td>4</td>
<td>YYYY-MM-DD HH:MM:SS</td>
<td>1970-01-01 00:00:00 UTC</td>
<td>2038-01-19 03:14:07 UTC</td>
</tr>
</tbody></table>
<p>可以看到，不同数据类型表示的时间内容不同、取值范围不同，而且占用的字节数也不一样，你要根据实际需要灵活选取。</p>
<p>为什么时间类型TIME的取值范围不是-23:59:59~23:59:59呢？原因是MySQL设计的TIME类型，不光表示一天之内的时间，而且可以用来表示一个时间间隔，这个时间间隔可以超过24小时。</p>
<h2 id="6-1-YEAR类型"><a href="#6-1-YEAR类型" class="headerlink" title="6.1 YEAR类型"></a>6.1 YEAR类型</h2><p>YEAR类型用来表示年份，在所有的日期时间类型中所占用的存储空间最小，只需要<code>1个字节</code>的存储空间。</p>
<p>在MySQL中，YEAR有以下几种存储格式：</p>
<ul>
<li>以4位字符串或数字格式表示YEAR类型，其格式为YYYY，最小值为1901，最大值为2155。</li>
<li>以2位字符串格式表示YEAR类型，最小值为00，最大值为99。<ul>
<li>当取值为01到69时，表示2001到2069；</li>
<li>当取值为70到99时，表示1970到1999；</li>
<li>当取值整数的0或00添加的话，那么是0000年；</li>
<li>当取值是日期&#x2F;字符串的’0’添加的话，是2000年。</li>
</ul>
</li>
</ul>
<p><strong>从MySQL5.5.27开始，2位格式的YEAR已经不推荐使用。</strong>YEAR默认格式就是“YYYY”，没必要写成YEAR(4)，从MySQL8.0.19开始，不推荐使用指定显示宽度的YEAR（4）数据类型。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"># 6.1 YEAR类型</span><br><span class="line">CREATE TABLE test_year(</span><br><span class="line">f1 YEAR,</span><br><span class="line">f2 YEAR(4)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">DESC test_year;</span><br><span class="line">+-------+---------+------+-----+---------+-------+</span><br><span class="line">| Field | Type    | Null | Key | Default | Extra |</span><br><span class="line">+-------+---------+------+-----+---------+-------+</span><br><span class="line">| f1    | year(4) | YES  |     | NULL    |       |</span><br><span class="line">| f2    | year(4) | YES  |     | NULL    |       |</span><br><span class="line">+-------+---------+------+-----+---------+-------+</span><br><span class="line"></span><br><span class="line">INSERT INTO test_year(f1)</span><br><span class="line">VALUES(&#x27;2021&#x27;),(2022);</span><br><span class="line"></span><br><span class="line">SELECT * FROM test_year;</span><br><span class="line">+------+------+</span><br><span class="line">| f1   | f2   |</span><br><span class="line">+------+------+</span><br><span class="line">| 2021 | NULL |</span><br><span class="line">| 2022 | NULL |</span><br><span class="line">+------+------+</span><br><span class="line"></span><br><span class="line">INSERT INTO test_year(f1)</span><br><span class="line">VALUES(&#x27;2155&#x27;);</span><br><span class="line"></span><br><span class="line"># ERROR 1264 (22003): Out of range value for column &#x27;f1&#x27; at row 1</span><br><span class="line">INSERT INTO test_year(f1)</span><br><span class="line">VALUES(&#x27;2156&#x27;);</span><br></pre></td></tr></table></figure>



<h3 id="6-2-DATE类型"><a href="#6-2-DATE类型" class="headerlink" title="6.2 DATE类型"></a>6.2 DATE类型</h3><p>DATE类型表示日期，没有时间部分，格式为 <code>YYYY-MM-DD</code> ，其中，YYYY表示年份，MM表示月份，DD表示日期。需要 <code>3个字节</code> 的存储空间。在向DATE类型的字段插入数据时，同样需要满足一定的格式条件。</p>
<ul>
<li>以 <code>YYYY-MM-DD</code> 格式或者 <code>YYYYMMDD</code> 格式表示的字符串日期，其最小取值为1000-01-01，最大取值为9999-12-03。YYYYMMDD格式会被转化为YYYY-MM-DD格式。</li>
<li>以 <code>YY-MM-DD</code> 格式或者 <code>YYMMDD</code> 格式表示的字符串日期，此格式中，年份为两位数值或字符串满足YEAR类型的格式条件为：当年份取值为00到69时，会被转化为2000到2069；当年份取值为70到99时，会被转化为1970到1999。</li>
<li>使用 <code>CURRENT_DATE()</code> 或者 <code>NOW()</code> 函数，会插入当前系统的日期。</li>
</ul>
<p><strong>举例：</strong></p>
<p>创建数据表，表中只包含一个DATE类型的字段f1。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">#6.2 DATE类型</span><br><span class="line">CREATE TABLE test_date1(</span><br><span class="line">f1 DATE</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">DESC test_date1;</span><br><span class="line"></span><br><span class="line"># 插入数据</span><br><span class="line">INSERT INTO test_date1</span><br><span class="line">VALUES (&#x27;2020-10-01&#x27;),(&#x27;20201001&#x27;),(20201001);</span><br><span class="line"></span><br><span class="line">INSERT INTO test_date1</span><br><span class="line">VALUES (&#x27;00-01-01&#x27;),(&#x27;000101&#x27;),(&#x27;69-10-01&#x27;),(&#x27;691001&#x27;), (&#x27;70-01-01&#x27;),(&#x27;700101&#x27;),(&#x27;99-01-01&#x27;),(&#x27;990101&#x27;);</span><br><span class="line"></span><br><span class="line">INSERT INTO test_date1</span><br><span class="line">VALUES (000301), (690301), (700301), (990301);  #存在隐式转换</span><br><span class="line"></span><br><span class="line">INSERT INTO test_date1</span><br><span class="line">VALUES (CURDATE()),(CURRENT_DATE()),(NOW());</span><br><span class="line"></span><br><span class="line">SELECT *</span><br><span class="line">FROM test_date1;</span><br></pre></td></tr></table></figure>



<h3 id="6-3-TIME类型"><a href="#6-3-TIME类型" class="headerlink" title="6.3 TIME类型"></a>6.3 TIME类型</h3><p>TIME类型用来表示时间，不包含日期部分。在MySQL中，需要 <code>3个字节</code> 的存储空间来存储TIME类型的数据，可以使用“HH:MM:SS”格式来表示TIME类型，其中，HH表示小时，MM表示分钟，SS表示秒。</p>
<p>在MySQL中，向TIME类型的字段插入数据时，也可以使用几种不同的格式。</p>
<p>（1）可以使用带有冒号的字符串，比如’<code>D HH:MM:SS</code>‘、’<code>HH:MM:SS</code>‘、’<code>HH:MM</code>‘、’<code>D HH:MM</code>‘、’<code>D HH</code>‘或’<code>SS</code>‘格式，都能被正确地插入TIME类型的字段中。其中D表示天，其最小值为0，最大值为34。如果使用带有D格式的字符串插入TIME类型的字段时，D会被转化为小时，计算格式为D*24+HH。当使用带有冒号并且不带D的字符串表示时间时，表示当天的时间，比如1210表示12:10:00，而不是00:12:10。</p>
<p>（2）可以使用不带有冒号的字符串或者数字，格式为’<code>HHMMSS</code>‘或者<code>HHMMSS</code>。如果插入一个不合法的字符串或者数字，MySQL在存储数据时，会将其自动转化为00:00:00进行存储。比如1210，MySQL会将最右边的两位解析成秒，表示00:12:10，而不是12:10:00。</p>
<p>（3）使用 <code>CURRENT_TIME()</code> 或者 <code>NOW()</code>，会插入当前系统的时间。</p>
<p><strong>举例：</strong></p>
<p>创建数据表，表中包含一个TIME类型的字段f1。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">#6.3 TIME类型</span><br><span class="line">CREATE TABLE test_time1(</span><br><span class="line">f1 TIME</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">DESC test_time1;</span><br><span class="line"></span><br><span class="line">INSERT INTO test_time1</span><br><span class="line">VALUES(&#x27;2 12:30:29&#x27;),(&#x27;12:35:29&#x27;),(&#x27;12:40&#x27;),(&#x27;2 12:40&#x27;),(&#x27;1 05&#x27;),(&#x27;45&#x27;);</span><br><span class="line"></span><br><span class="line">INSERT INTO test_time1</span><br><span class="line">VALUES (&#x27;123520&#x27;),(124011),(1210);</span><br><span class="line"></span><br><span class="line">INSERT INTO test_time1</span><br><span class="line">VALUES (NOW()),(CURRENT_TIME);</span><br><span class="line"></span><br><span class="line">SELECT * FROM test_time1;</span><br></pre></td></tr></table></figure>





<h3 id="6-4-DATETIME类型"><a href="#6-4-DATETIME类型" class="headerlink" title="6.4 DATETIME类型"></a>6.4 DATETIME类型</h3><p>DATETIME类型在所有的日期时间类型中占用的存储空间最大，总共需要8个字节的存储空间。在格式上为DATE类型和TIME类型的组合，可以表示为 <code>YYYY-MM-DD HH:MM:SS</code> ，其中YYYY表示年份，MM表示月份，DD表示日期，HH表示小时，MM表示分钟，SS表示秒。</p>
<p>在向DATETIME类型的字段插入数据时，同样需要满足一定的格式条件。</p>
<ul>
<li>以 <code>YYYY-MM-DD HH:MM:SS</code> 格式或者 <code>YYYYMMDDHHMMSS</code> 格式的字符串插入DATETIME类型的字段时，最小值为1000-01-0100:00:00，最大值为9999-12-03 23:59:59。<ul>
<li>以YYYYMMDDHHMMSS格式的数字插入DATETIME类型的字段时，会被转化为YYYY-MM-DD HH:MM:SS格式。</li>
</ul>
</li>
<li>以 <code>YY-MM-DD HH:MM:SS</code> 格式或者 <code>YYMMDDHHMMSS</code> 格式的字符串插入DATETIME类型的字段时，两位数的年份规则符合YEAR类型的规则，00到69表示2000到2069；70到99表示1970到1999。</li>
<li>使用函数 <code>CURRENT_TIMESTAMP()</code> 和 <code>NOW()</code> ，可以向DATETIME类型的字段插入系统的当前日期和时间。</li>
</ul>
<p><strong>举例：</strong></p>
<p>创建数据表，表中包含一个DATETIME类型的字段dt。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">#6.4 DATETIME类型</span><br><span class="line">CREATE TABLE test_datetime1(</span><br><span class="line">dt DATETIME</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"># 插入数据</span><br><span class="line">INSERT INTO test_datetime1</span><br><span class="line">VALUES (&#x27;2021-01-01 06:50:30&#x27;),(&#x27;20210101065030&#x27;);</span><br><span class="line"></span><br><span class="line">INSERT INTO test_datetime1</span><br><span class="line">VALUES (&#x27;99-01-01 00:00:00&#x27;),(&#x27;990101000000&#x27;),(&#x27;20-01-01 00:00:00&#x27;),(&#x27;200101000000&#x27;);</span><br><span class="line"></span><br><span class="line">INSERT INTO test_datetime1</span><br><span class="line">VALUES (20200101000000),(200101000000),(19990101000000),(990101000000);</span><br><span class="line"></span><br><span class="line">INSERT INTO test_datetime1</span><br><span class="line">VALUES (CURRENT_TIMESTAMP()),(NOW());</span><br><span class="line"></span><br><span class="line">SELECT * FROM test_datetsime1;</span><br></pre></td></tr></table></figure>



<h3 id="6-5-TIMESTAMP类型"><a href="#6-5-TIMESTAMP类型" class="headerlink" title="6.5 TIMESTAMP类型"></a>6.5 TIMESTAMP类型</h3><p>TIMESTAMP类型也可以表示日期时间，其显示格式与DATETIME类型相同，都是 <code>YYYY-MM-DD HH:MM:SS</code>，需要4个字节的存储空间。但是TIMESTAMP存储的时间范围比DATETIME要小很多，只能存储“1970-01-01 00:00:01 UTC”到“2038-01-19 03:14:07 UTC”之间的时间。其中，UTC表示世界统一时间，也叫作世界标准时间。</p>
<ul>
<li><strong>存储数据的时候需要对当前时间所在的时区进行转换，查询数据的时候再将时间转换回当前的时区。因此，使用TIMESTAMP存储的同一个时间值，在不同的时区查询时会显示不同的时间。</strong></li>
</ul>
<p>向TIMESTAMP类型的字段插入数据时，当插入的数据格式满足YY-MM-DD HH:MM:SS和YYMMDDHHMMSS时，两位数值的年份同样符合YEAR类型的规则条件，只不过表示的时间范围要小很多。</p>
<p>如果向TIMESTAMP类型的字段插入的时间超出了TIMESTAMP类型的范围，则MySQL会抛出错误信息。</p>
<p><strong>举例：</strong></p>
<p>创建数据表，表中包含一个TIMESTAMP类型的字段ts。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">#6.5 TIMESTAMP类型</span><br><span class="line">CREATE TABLE test_timestamp1(</span><br><span class="line">ts TIMESTAMP</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">INSERT INTO test timestamp1</span><br><span class="line">VALUES (&#x27;1999-01-01 03:04:50&#x27;), (&#x27;19990101030405&#x27;), (&#x27;99-01-01 03:04:05&#x27;), (&#x27;990101030405&#x27;);</span><br><span class="line"></span><br><span class="line">INSERT INTO test_timestamp1</span><br><span class="line">VALUES (&#x27;2020@01@01@00@00@00&#x27;), (&#x27;20@01@01@00@00@00&#x27;);</span><br><span class="line"></span><br><span class="line">INSERT INTO test_timestamp1</span><br><span class="line">VALUES (CURRENT_TIMESTAMP()),(NOW());</span><br><span class="line"></span><br><span class="line">#Incorrect datetime value</span><br><span class="line">INSERT INTO test_timestamp1</span><br><span class="line">VALUES (&#x27;2038-01-20 03:14:07&#x27;);</span><br><span class="line"></span><br><span class="line">SELECT *</span><br><span class="line">FROM test_timestamp1</span><br></pre></td></tr></table></figure>

<p><strong>TIMESTAMP和DATETIME的区别：</strong></p>
<ul>
<li>TIMESTAMP存储空间比较小，表示的日期时间范围也比较小</li>
<li>底层存储方式不同，TIMESTAMP底层存储的是毫秒值，距离1970-1-1 0:0:0 0毫秒的毫秒值。</li>
<li>两个日期比较大小或日期计算时，TIMESTAMP更方便、更快。</li>
<li>TIMESTAMP和时区有关。TIMESTAMP会根据用户的时区不同，显示不同的结果。而DATETIME则只能反映出插入时当地的时区，其他时区的人查看数据必然会有误差的。</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"># 对比DATETIME 和 TIMESTAMP</span><br><span class="line">CREATE TABLE temp_time (</span><br><span class="line">d1 DATETIME,</span><br><span class="line">d2 TIMESTAMP</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">INSERT INTO temp_time VALUES(&#x27;2021-9-2 14:45:52&#x27;,&#x27;2021-9-2 14:45:52&#x27;);</span><br><span class="line"></span><br><span class="line">INSERT INTO temp_time VALUES(NOW(),NOW());</span><br><span class="line"></span><br><span class="line">SELECT *</span><br><span class="line">FROM temp_time;</span><br><span class="line"></span><br><span class="line">#修改当前的时区</span><br><span class="line">SET time_zone = &#x27;+9:00&#x27;;</span><br><span class="line"></span><br><span class="line">SELECT *</span><br><span class="line">FROM temp_time;</span><br></pre></td></tr></table></figure>



<h3 id="6-6-开发中经验"><a href="#6-6-开发中经验" class="headerlink" title="6.6 开发中经验"></a>6.6 开发中经验</h3><p>用得最多的日期时间类型，就是 <code>DATETIME</code>。虽然MySQL也支持YEAR（年）、TIME（时间）、DATE（日期），以及 TIMESTAMP 类型，但是在实际项目中，尽量用 DATETIME 类型。因为这个数据类型包括了完整的日期和时间信息，取值范围也最大，使用起来比较方便。毕竟，如果日期时间信息分散在好几个字段，很不容易记，而且查询的时候，SQL语句也会更加复杂。</p>
<p>此外，一般存注册时间、商品发布时间等，不建议使用DATETIME存储，而是使用 <code>时间戳</code> ，因为DATETIME虽然直观，但不便于计算。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># 获取时间戳</span><br><span class="line">mysql&gt; SELECT UNIX_TIMESTAMP();</span><br><span class="line">+------------------+</span><br><span class="line">| UNIX_TIMESTAMP() |</span><br><span class="line">+------------------+</span><br><span class="line">|       1669873810 |</span><br><span class="line">+------------------+</span><br><span class="line">1 row in set (0.00 sec)</span><br></pre></td></tr></table></figure>



<h2 id="7-文本字符串类型"><a href="#7-文本字符串类型" class="headerlink" title="7.文本字符串类型"></a>7.文本字符串类型</h2><p>在实际的项目中，我们还经常遇到一种数据，就是字符串数据。</p>
<p>MySQL中，文本字符串总体上分为<code>CHAR</code>、<code>VARCHAR</code>、<code>TINYTEXT</code>、<code>TEXT</code>、<code>MEDIUMTEXT</code>、<code>LONGTEXT</code>、<code>ENUM</code>、<code>SET</code>等类型。</p>
<table>
<thead>
<tr>
<th>文本字符串类型</th>
<th>值的长度</th>
<th>长度范围</th>
<th>占用的存储空间</th>
</tr>
</thead>
<tbody><tr>
<td>CHAR(M)</td>
<td>M</td>
<td>0 &lt;&#x3D; M &lt;&#x3D; 255</td>
<td>M个字节</td>
</tr>
<tr>
<td>VARCHAR(M)</td>
<td>M</td>
<td>0 &lt;&#x3D; M &lt;&#x3D; 65535</td>
<td>M+1个字节</td>
</tr>
<tr>
<td>TINYTEXT</td>
<td>L</td>
<td>0 &lt;&#x3D; L &lt;&#x3D; 255</td>
<td>L+2个字节</td>
</tr>
<tr>
<td>TEXT</td>
<td>L</td>
<td>0 &lt;&#x3D; L &lt;&#x3D; 65535</td>
<td>L+2个字节</td>
</tr>
<tr>
<td>MEDIUMTEXT</td>
<td>L</td>
<td>0 &lt;&#x3D; L &lt;&#x3D; 16777215</td>
<td>L+3个字节</td>
</tr>
<tr>
<td>LONGTEXT</td>
<td>L</td>
<td>0 &lt;&#x3D; L &lt;&#x3D; 4294967295</td>
<td>L+4个字节</td>
</tr>
<tr>
<td>ENUM</td>
<td>L</td>
<td>1 &lt;&#x3D; L &lt;&#x3D; 65535</td>
<td>1或2个字节</td>
</tr>
<tr>
<td>SET</td>
<td>L</td>
<td>0 &lt;&#x3D; L &lt;&#x3D; 64</td>
<td>1,2,3,4或8个字节</td>
</tr>
</tbody></table>
<h3 id="7-1-CHAR与VARCHAR类型"><a href="#7-1-CHAR与VARCHAR类型" class="headerlink" title="7.1 CHAR与VARCHAR类型"></a>7.1 CHAR与VARCHAR类型</h3><p>CHAR和VARCHAR类型都可以存储比较短的字符串。</p>
<table>
<thead>
<tr>
<th>字符串(文本)类型</th>
<th>特点</th>
<th>长度</th>
<th>长度范围</th>
<th>占用的存储空间</th>
</tr>
</thead>
<tbody><tr>
<td>CHAR(M)</td>
<td>固定长度</td>
<td>M</td>
<td>0 &lt;&#x3D; M &lt;&#x3D; 255</td>
<td>M个字节</td>
</tr>
<tr>
<td>VARCHAR(M)</td>
<td>可变长度</td>
<td>M</td>
<td>0 &lt;&#x3D; M &lt;&#x3D; 65535</td>
<td>(实际长度+1)个字节</td>
</tr>
</tbody></table>
<p><strong>CHAR类型：</strong></p>
<ul>
<li>CHAR(M)类型一般需要预先定义字符串长度。如果不指定(M)，则表示长度默认是1个字符。</li>
<li>如果保存时，数据的实际长度比CHAR类型声明的长度小，则会在<code>右侧填充</code>空格以达到指定的长度。当MySQL检索CHAR类型的数据时，CHAR类型的字段会去除尾部的空格。</li>
<li>定义CHAR类型字段时，声明的字段长度即为CHAR类型字段成占的存储空间的字节数。</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">#7.1CHAR类型</span><br><span class="line">CREATE TABLE test_char1(</span><br><span class="line">c1 CHAR,</span><br><span class="line">c2 CHAR(5)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">DESC test char1;</span><br><span class="line"></span><br><span class="line">INSERT INTO test_char1(c1)</span><br><span class="line">VALUES(&#x27;a&#x27;);</span><br><span class="line"></span><br><span class="line">#Data too long for column &#x27;c1&#x27; at row 1</span><br><span class="line">INSERT INTO test_char1(c1)</span><br><span class="line">VALUES(&#x27;ab&#x27;);</span><br><span class="line"></span><br><span class="line">INSERT INTO test_char1(c2)</span><br><span class="line">VALUES(&#x27;ab&#x27;);</span><br><span class="line"></span><br><span class="line">SELECT * FROM test_char1;</span><br><span class="line"></span><br><span class="line">SELECT CONCAT(c2,&#x27;***&#x27;)</span><br><span class="line">FROM test_char1;</span><br><span class="line"></span><br><span class="line">INSERT INTO test_char1(c2)</span><br><span class="line">VALUES(&#x27;ab   &#x27;);</span><br><span class="line"></span><br><span class="line">SELECT CHAR_LENGTH(c2)</span><br><span class="line">FROM test char1;</span><br></pre></td></tr></table></figure>

<p><strong>VARCHAR类型：</strong></p>
<ul>
<li>VARCHAR(M)定义时，<code>必须指定</code>长度M，否则报错。</li>
<li>MySQL4.0版本以下，varchar(20)：指的是20字节，如果存放UTF8汉字时，只能存6个（每个汉字3字节）；MySQL5.0版本以上，varchar(20)：指的是20字符。</li>
<li>检索VARCHAR类型的字段数据时，会保留数据尾部的格。VARCHAR类型的字段所占用的存储空间为字符串实际长度加1个字节。</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">#7.2 VARCHAR类型</span><br><span class="line">CREATE TABLE test_varchar1(</span><br><span class="line">NAME VARCHAR  #错误</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">#Column length too big for column &#x27;name&#x27; (max = 21845); use BLOB or TEXT instead</span><br><span class="line">CREATE TABLE test_varchar2(</span><br><span class="line">NAME VARCHAR(65535)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">CREATE TABLE test_varchar3(</span><br><span class="line">NAME VARCHAR(5)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">INSERT INTO test_varchar3</span><br><span class="line">VALUES(&#x27;尚硅谷&#x27;),(&#x27;尚硅谷教育&#x27;);</span><br><span class="line"></span><br><span class="line">#Data too long for column &#x27;NAME&#x27; at row 1</span><br><span class="line">INSERT INTO test_varchar3</span><br><span class="line">VALUES(&#x27;尚硅谷IT教育&#x27;);</span><br></pre></td></tr></table></figure>

<p><strong>哪些情况使用 CHAR 或 VARCHAR 更好</strong></p>
<table>
<thead>
<tr>
<th>类型</th>
<th>特点</th>
<th>空间上</th>
<th>时间上</th>
<th>适用场景</th>
</tr>
</thead>
<tbody><tr>
<td>CHAR(M)</td>
<td>固定长度</td>
<td>浪费存储空间</td>
<td>效率高</td>
<td>存储不大，速度要求高</td>
</tr>
<tr>
<td>VARCHAR(M)</td>
<td>可变长度</td>
<td>节省存储空间</td>
<td>效率低</td>
<td>非CHAR的情况</td>
</tr>
</tbody></table>
<p>情况1：存储很短的信息。比如门牌号码101，201……这样很短的信息应该用char,因为varchar还要占个byte用于存储信息长度，本来打算节约存储的，结果得不偿失。</p>
<p>情况2：固定长度的。比如使用uuid作为主键，那用char应该更合适。因为他固定长度，varchar动态根据长度的特性就消失了，而且还要占个长度信息。</p>
<p>情况3：十分频繁改变的column。因为varchar每次存储都要有额外的计算，得到长度等工作，如果一个非常频繁改变的，那就要有很多的精力用于计算，而这些对于char来说是不需要的。</p>
<p>情况4：具体存储引擎中的情况：</p>
<ul>
<li><code>MyISAM</code> 数据存储引擎和数据列：MyISAM数据表，最好使用固定长度(CHAR)的数据列代替可变长度(VARCHAR)的数据列。这样使得整个表静态化，从而使 <code>数据检索更快</code>，用空间换时间。</li>
<li><code>MEMORY</code> 存储引擎和数据列：MEMORY数据表目前都使用固定长度的数据行存储，因此无论使用CHAR或VARCHAR列都没有关系，两者都是作为CHAR类型处理的。</li>
<li><code>InnoDB</code> 存储引擎，建议使用VARCHAR类型。因为对于InnoDB数据表，内部的行存储格式并没有区分固定长度和可变长度列（所有数据行都使用指向数据列值的头指针），而且<strong>主要影响性能的因素是数据行使用的存储总量</strong>，由于char平均占用的空间多于varchar，所以除了简短并且固定长度的，其他考虑varchar。这样节省空间，对磁盘1&#x2F;0和数据存储总量比较好。</li>
</ul>
<h3 id="7-2-TEXT类型"><a href="#7-2-TEXT类型" class="headerlink" title="7.2 TEXT类型"></a>7.2 TEXT类型</h3><p>在MySQL中，TEXT用来保存文本类型的字符串，总共包含4种类型，分别为TINYTEXT、TEXT、MEDIUMTEXT 和 LONGTEXT类型。</p>
<p>在向TEXT类型的字段保存和查询数据时，系统自动按照实际长度存储，不需要预先定义长度。这一点和VARCHAR类型相同。</p>
<p>每种TEXT类型保存的数据长度和所占用的存储空间不同，如下：</p>
<table>
<thead>
<tr>
<th>文本字符串类型</th>
<th>特点</th>
<th>长度</th>
<th>长度范围</th>
<th>占用的存储空间</th>
</tr>
</thead>
<tbody><tr>
<td>TINYTEXT</td>
<td>小文本、可变长度</td>
<td>L</td>
<td>0 &lt;&#x3D; L &lt;&#x3D; 255</td>
<td>L+2个字节</td>
</tr>
<tr>
<td>TEXT</td>
<td>文本、可变长度</td>
<td>L</td>
<td>0 &lt;&#x3D; L &lt;&#x3D; 65535</td>
<td>L+2个字节</td>
</tr>
<tr>
<td>MEDIUMTEXT</td>
<td>中等文本、可变长度</td>
<td>L</td>
<td>0 &lt;&#x3D; L &lt;&#x3D; 16777215</td>
<td>L+3个字节</td>
</tr>
<tr>
<td>LONGTEXT</td>
<td>大文本、可变长度</td>
<td>L</td>
<td>0 &lt;&#x3D; L &lt;&#x3D; 4294967295（相当于4GB）</td>
<td>L+4个字节</td>
</tr>
</tbody></table>
<p><strong>由于实际存储的长度不确定，MySQL 不允许 TEXT 类型的字段做主键。</strong>遇到这种情况，你只能采用CHAR(M)，或者VARCHAR(M)。</p>
<p><strong>举例：</strong></p>
<p>创建数据表：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE test_text(</span><br><span class="line">tx TEXT</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">INSERT INTO test_text</span><br><span class="line">VALUES(&#x27;atguigu   &#x27;);</span><br><span class="line"></span><br><span class="line">SELECT CHAR_LENGTH(t×)</span><br><span class="line">FROM test_text;  #10</span><br></pre></td></tr></table></figure>

<p>说明在保存和查询数据时，并没有删除TEXT类型的数据尾部的空格。</p>
<p><strong>开发中经验：</strong></p>
<p>TEXT文本类型，可以存比较大的文本段，搜索速度稍慢，因此如果不是特别大的内容，建议使用CHAR，VARCHAR来代替。还有TEXT类型不用加默认值，加了也没用。而且text和blob类型的数据删除后容易导致“空洞”，使得文件碎片比较多，所以频繁使用的表不建议包含TEXT类型字段，建议单独分出去，单独用一个表。</p>
<h2 id="8-ENUM类型"><a href="#8-ENUM类型" class="headerlink" title="8.ENUM类型"></a>8.ENUM类型</h2><p>ENUM类型也叫作枚举类型，ENUM类型的取值范围需要在定义字段时进行指定。设置字段值时，ENUM类型只允许从成员中选取单个值，不能一次选取多个值。</p>
<p>其所需要的存储空间由定义ENUM类型时指定的成员个数决定。</p>
<table>
<thead>
<tr>
<th>文本字符串类型</th>
<th>长度</th>
<th>长度范围</th>
<th>占用的存储空间</th>
</tr>
</thead>
<tbody><tr>
<td>ENUM</td>
<td>L</td>
<td>1 &lt;&#x3D; L &lt;&#x3D; 65535</td>
<td>1或2个字节</td>
</tr>
</tbody></table>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"># 8. ENUM类型</span><br><span class="line">CREATE TABLE test_enum(</span><br><span class="line">season ENUM(&#x27;春&#x27;,&#x27;夏&#x27;,&#x27;秋&#x27;,&#x27;冬&#x27;,&#x27;unknow&#x27;)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">INSERT INTO test_enum</span><br><span class="line">VALUES(&#x27;春&#x27;),(&#x27;秋&#x27;);</span><br><span class="line"></span><br><span class="line">SELECT * FROM test_enum;</span><br><span class="line"></span><br><span class="line">#Data truncated for column &#x27;season&#x27; at row 1</span><br><span class="line">INSERT INTO test_enum</span><br><span class="line">VALUES(&#x27;春,秋&#x27;);</span><br><span class="line"></span><br><span class="line">#Data truncated for column &#x27;season&#x27; at row 1</span><br><span class="line">INSERT INTO test_enum</span><br><span class="line">VALUES(&#x27;人&#x27;);</span><br><span class="line"></span><br><span class="line">INSERT INTO test_enum</span><br><span class="line">VALUES(&#x27;unknow&#x27;);</span><br><span class="line"></span><br><span class="line">#忽略大小写的</span><br><span class="line">INSERT INTO test_enum</span><br><span class="line">VALUES(&#x27;UNKNOW&#x27;);</span><br><span class="line"></span><br><span class="line">INSERT INTO test_enum</span><br><span class="line">VALUES(&#x27;UNKNOW&#x27;);</span><br><span class="line"></span><br><span class="line">#可以使用索引进行枚举元素的调用</span><br><span class="line">INSERT INTO test_enum</span><br><span class="line">VALUES(1),(&#x27;3&#x27;);</span><br><span class="line"></span><br><span class="line">#没有限制非空的情况下，可以添加null值</span><br><span class="line">INSERT INTO test_enum</span><br><span class="line">VALUES(NULL);</span><br></pre></td></tr></table></figure>



<h2 id="9-SET类型"><a href="#9-SET类型" class="headerlink" title="9.SET类型"></a>9.SET类型</h2><p>SET表示一个字符串对象，可以包含0个或多个成员，但成员个数的上限为 <code>64</code>。设置字段值时，可以取取值范围内的0个或多个值。</p>
<p>当SET类型包含的成员个数不同时，其所占用的存储空间也是不同的，具体如下：</p>
<table>
<thead>
<tr>
<th>成员个数范围（L表示实际成员个数）</th>
<th>占用的存储空间</th>
</tr>
</thead>
<tbody><tr>
<td>1 &lt;&#x3D; L &lt;&#x3D; 8</td>
<td>1个字节</td>
</tr>
<tr>
<td>9 &lt;&#x3D; L &lt;&#x3D; 16</td>
<td>2个字节</td>
</tr>
<tr>
<td>17 &lt;&#x3D; L &lt;&#x3D; 24</td>
<td>3个字节</td>
</tr>
<tr>
<td>25 &lt;&#x3D; L &lt;&#x3D; 32</td>
<td>4个字节</td>
</tr>
<tr>
<td>33 &lt;&#x3D; L &lt;&#x3D; 64</td>
<td>8个字节</td>
</tr>
</tbody></table>
<p>SET类型在存储数据时成员个数越多，其占用的存储空间越大。注意：SET类型在选取成员时，可以一次选择多个成员，这一点与ENUM类型不同。</p>
<p>举例：</p>
<p>创建表：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE test_set(</span><br><span class="line">s SET (&#x27;A&#x27;, &#x27;B&#x27;, &#x27;C&#x27;)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>向表中插入数据：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">INSERT INTO test_set (s) VALUES (&#x27;A&#x27;),(&#x27;A,B&#x27;);</span><br><span class="line"></span><br><span class="line">#插入重复的SET类型成员时，MySQL会自动删除重复的成员</span><br><span class="line">INSERT INTO test_set (s) VALUES (&#x27;A,B,C,A&#x27;);</span><br><span class="line"></span><br><span class="line">#向SET类型的字段插入SET成员中不存在的值时，MySQL会抛出错误。</span><br><span class="line">INSERT INTO test_set (s) VALUES (&#x27;A,B,C,D&#x27;);</span><br><span class="line"></span><br><span class="line">SELECT *</span><br><span class="line">FROM test_set;</span><br></pre></td></tr></table></figure>

<p>举例：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE temp_mul(</span><br><span class="line">gender ENUM(&#x27;男&#x27;,&#x27;女&#x27;),</span><br><span class="line">hobby SET(&#x27;吃饭&#x27;,&#x27;睡觉&#x27;,&#x27;打豆豆&#x27;,&#x27;写代码&#x27;)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">INSERT INTO temp_mul</span><br><span class="line">VALUES(&#x27;男&#x27;,&#x27;睡觉,打豆豆&#x27;);</span><br><span class="line"></span><br><span class="line">SELECT *</span><br><span class="line">FROM temp_mul;</span><br><span class="line"></span><br><span class="line">#Data truncated for column &#x27;gender&#x27; at row 1</span><br><span class="line">INSERT INTO temp_mul</span><br><span class="line">VAIUES(&#x27;男,女&#x27;,&#x27;睡觉,打豆豆&#x27;);</span><br></pre></td></tr></table></figure>



<h2 id="10-二进制字符串类型"><a href="#10-二进制字符串类型" class="headerlink" title="10.二进制字符串类型"></a>10.二进制字符串类型</h2><p>MySQL中的二进制字符串类型主要存储一些二进制数据，比如可以存储图片、音频和视频等二进制数据。</p>
<p>MySQL中支持的二进制字符串类型主要包括BINARY、VARBINARY、TINYBLOB、BLOB、MEDIUMBLOB 和 LONGBLOB 类型。</p>
<p><strong>BINARY与VARBINARY类型</strong></p>
<p>BINARY和VARBINARY类似于CHAR和VARCHAR,只是它们存储的是二进制字符串。</p>
<p>BINARY(M)为固定长度的二进制字符串，M表示最多能存储的字节数，取值范围是0~255个字符。如果未指定(M)，表示只能存储 <code>1个字节</code>。例如BINARY(8)，表示最多能存储8个字节，如果字段值不足(M)个字节，将在右边填充’\0’以补齐指定长度。</p>
<p>VARBINARY(M)为可变长度的二进制字符串，M表示最多能存储的字节数，总字节数不能超过行的字节长度限制65535，另外还要考虑额外字节开销，VARBINARY类型的数据除了存储数据本身外，还需要1或2个字节来存储数据的字节数。VARBINARY类型 <code>必须指定(M)</code>，否则报错。</p>
<table>
<thead>
<tr>
<th>二进制字符串类型</th>
<th>特点</th>
<th>值的长度</th>
<th>占用空间</th>
</tr>
</thead>
<tbody><tr>
<td>BINARY(M)</td>
<td>固定长度</td>
<td>M  (0 &lt;&#x3D; M &lt;&#x3D; 255)</td>
<td>M个字节</td>
</tr>
<tr>
<td>VARBINARY(M)</td>
<td>可变长度</td>
<td>M  (0 &lt;&#x3D; M &lt;&#x3D; 65535)</td>
<td>M+1个字节</td>
</tr>
</tbody></table>
<p>举例：</p>
<p>创建表：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">#10.1 BINARY 与 VARBINARY 类型</span><br><span class="line">CREATE TABLE test_binary1(</span><br><span class="line">f1 BINARY,</span><br><span class="line">f2 BINARY(3),</span><br><span class="line">#f3 VARBINARY,</span><br><span class="line">f4 VARBINARY(10)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">DESC test_binary1;</span><br><span class="line"></span><br><span class="line">INSERT INTO test_binary1(f1,f2)</span><br><span class="line">VALUES(&#x27;a&#x27;,&#x27;abc&#x27;);</span><br><span class="line"></span><br><span class="line">SELECT * FROM test_binary1;</span><br><span class="line"></span><br><span class="line">#Data too long for column &#x27;fl&#x27; at row 1</span><br><span class="line">INSERT INTO test_binary1(f1)</span><br><span class="line">VALUES(&#x27;ab&#x27;);</span><br><span class="line"></span><br><span class="line">INSERT INTO test_binary1(f2,f4)</span><br><span class="line">VALUES(&#x27;ab&#x27;,&#x27;ab&#x27;);</span><br><span class="line"></span><br><span class="line">SELECT LENGTH(f2),LENGTH(f4)</span><br><span class="line">FROM test_binary1;</span><br></pre></td></tr></table></figure>



<h3 id="BLOB类型"><a href="#BLOB类型" class="headerlink" title="BLOB类型"></a>BLOB类型</h3><p>BLOB是一个 <code>二进制大对象</code> ，可以容纳可变数量的数据。</p>
<p>MySQL中的BLOB类型包括TINYBLOB、BLOB、MEDIUMBLOB和LONGBLOB 4种类型，它们可容纳值的最大长度不同。可以存储一个二进制的大对象，比如 <code>图片</code>、<code>音频</code> 和 <code>视频</code> 等。</p>
<p>需要注意的是，在实际工作中，往往不会在MySQL数据库中使用BLOB类型存储大对象数据，通常会将图片、音频和视频文件存储到 <code>服务器的磁盘上</code>，并将图片、音频和视频的访问路径存储到MySQL中。</p>
<table>
<thead>
<tr>
<th>二进制字符串类型</th>
<th>值的长度</th>
<th>长度范围</th>
<th>占用空间</th>
</tr>
</thead>
<tbody><tr>
<td>TINYBLOB</td>
<td>L</td>
<td>0 &lt;&#x3D; L &lt;&#x3D; 255</td>
<td>L+1个字节</td>
</tr>
<tr>
<td>BLOB</td>
<td>L</td>
<td>0 &lt;&#x3D; L &lt;&#x3D; 65535（相当于64KB）</td>
<td>L+2个字节</td>
</tr>
<tr>
<td>MEDIUMBLOB</td>
<td>L</td>
<td>0 &lt;&#x3D; L &lt;&#x3D; 16777215（相当于16MB）</td>
<td>L+3个字节</td>
</tr>
<tr>
<td>LONGBLOB</td>
<td>L</td>
<td>0 &lt;&#x3D; L &lt;&#x3D; 4294967295（相当于4GB）</td>
<td>L+4个字节</td>
</tr>
</tbody></table>
<p>举例：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">#10.2 Blob类型</span><br><span class="line">CREATE TABLE test_blob1(</span><br><span class="line">id INT,</span><br><span class="line">img MEDIUMBLOB</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">INSERT INTO test_blob1(id)</span><br><span class="line">VALUES (1001);</span><br><span class="line"></span><br><span class="line"># SQLyog图形化手动插入图片</span><br><span class="line">SELECT *</span><br><span class="line">FROM test_blob1;</span><br></pre></td></tr></table></figure>

<p><strong>TEXT和BLOB的使用注意事项：</strong></p>
<p>在使用text和blob字段类型时要注意以下几点，以便更好的发挥数据库的性能。</p>
<p>① BLOB和TEXT值也会引起自己的一些问题，特别是执行了大量的删除或更新操作的时候。删除这种值会在数据表中留下很大的”空洞”，以后填入这些“<code>空洞</code>”的记录可能长度不同。为了提高性能，建议定期使用 OPTIMIZE TABLE 功能对这类表进行<code>碎片整理</code>。</p>
<p>② 如果需要对大文本字段进行模糊查询，MySQL提供了<code>前缀索引</code>。但是仍然要在不必要的时候避免检索大型的BLOB或TEXT值。例如，SELECT * 查询就不是很好的想法，除非你能够确定作为约束条件的WHERE子句只会找到所需要的数据行。否则，你可能毫无目的地在网络上传输大量的值。</p>
<p>③ 把BLOB或TEXT列 <code>分离到单独的表</code> 中。在某些环境中，如果把这些数据列移动到第二张数据表中，可以让你把原数据表中的数据列转换为固定长度的数据行格式，那么它就是有意义的。这会 <code>减少主表中的碎片</code>，使你得到固定长度数据行的性能优势。它还使你在主数据表上运行SELECT * 查询的时候不会通过网络传输大量的BLOB或TEXT值。</p>
<h2 id="11-JSON类型"><a href="#11-JSON类型" class="headerlink" title="11. JSON类型"></a>11. JSON类型</h2><p>JSON（JavaScript Object Notation）是一种轻量级的 <code>数据交换格式</code>。简洁和清晰的层次结构使得 JSON 成为理想的数据交换语言。它易于人阅读和编写，同时也易于机器解析和生成，并有效地提升网络传输效率。JSON 可以将 JavaScript 对象中表示的一组数据转换为字符串，然后就可以在网络或者程序之间轻松地传递这个字符串，并在需要的时候将它还原为各编程语言所支持的数据格式。</p>
<p>在MySQL 5.7中，就已经支持JSON数据类型。在MySQL 8.x版本中，JSON类型提供了可以进行自动验证的 JSON文档和优化的存储结构，使得在MySQL中存储和读取JSON类型的数据更加方便和高效。</p>
<p>创建数据表，表中包含一个 JSON类型的字段 js。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE test_json(</span><br><span class="line">js json</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>向表中插入JSON数据。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">INSERT INTO test_json (js)</span><br><span class="line">VALUES (&#x27;&#123;&quot;name&quot;:&quot;songhk&quot;, &quot;age&quot;:18, &quot;address&quot;:&#123;&quot;province&quot;:&quot;beijing&quot;, &quot;city&quot;:&quot;beijing&quot;&#125;&#125;&#x27;);</span><br></pre></td></tr></table></figure>

<p>查询t19表中的数据。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SELECT *</span><br><span class="line">FROM test_json;</span><br></pre></td></tr></table></figure>

<p>当需要检索JSON类型的字段中数据的某个具体值时，可以使用“-&gt;”和“-&gt;&gt;”符号。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SELECT js -&gt; &#x27;$.name&#x27; AS NAME,js -&gt; &#x27;$.age&#x27; AS age ,js –&gt; &#x27;$.address.province&#x27; AS province, js -&gt; &#x27;$.address.city&#x27; AS city</span><br><span class="line">FROM test_json;</span><br></pre></td></tr></table></figure>

<p>通过“-&gt;”和“-&gt;&gt;”符号，从JSON字段中正确查询出了指定的JSON数据的值。</p>
<h2 id="12-空间类型"><a href="#12-空间类型" class="headerlink" title="12.空间类型"></a>12.空间类型</h2><p>MySQL空间类型扩展支持地理特征的生成、存储和分析。这里的地理特征表示世界上具有位置的任何东西，可以是一个实体，例如一座山；可以是空间，例如一座办公楼；也可以是一个可定义的位置，例如一个十字路口等等。MySQL中使用 <code>Geometry (几何)</code> 来表示所有地理特征。Geometry指一个点或点的集合，代表世界上任何具有位置的事物。</p>
<p>MySQL的空间数据类型 (Spatial Data Type) 对应于OpenGIS类，包括单值类型：GEOMETRY、POINT、LINESTRING、POLYGON以及集合类型：MULTIPOINT、MULTILINESTRING、MULTIPOLYGON、GEOMETRYCOLLECTION。</p>
<ul>
<li>Geometry是所有空间集合类型的基类，其他类型如POINT、LINESTRING、POLYGON都是Geometry的子类。<ul>
<li>Point，顾名思义就是点，有一个坐标值。例如POINT(121.213342 31.234532)，POINT(30 10)，坐标值支持DECIMAL类型，经度 (longitude) 在前，维度 (latitude) 在后，用空格分隔。</li>
<li>Linestring，线，由一系列点连接而成。如果线从头至尾没有交叉，那就是简单的（simple）；如果起点和终点重叠，那就是封闭的（closed）。例如LINESTRING(30 10,10 30,40 40),点与点之间用逗号分隔，一个点中的经纬度用空格分隔，与POINT格式一致。</li>
<li>Polygon，多边形。可以是一个实心平面形，即没有内部边界，也可以有空洞，类似纽扣。最简单的就是只有一个外边界的情况，例如POLYGON((0 0,10 0,10 10,0 10))。</li>
</ul>
</li>
</ul>
<p>下面展示几种常见的几何图形元素：</p>
<ul>
<li>MultiPoint、MultiLineString、MultiPolygon、GeometryCollection这4种类型都是集合类，是多个Point、LineString或Polygon组合而成。</li>
</ul>
<p>下面展示的是多个同类或异类几何图形元素的组合：</p>
<h2 id="13-小结及选择建议"><a href="#13-小结及选择建议" class="headerlink" title="13.小结及选择建议"></a>13.小结及选择建议</h2><p>在定义数据类型时，如果确定是 <code>整数</code>，就用 <code>INT</code>；如果是 <code>小数</code>，一定用定点数类型 <code>DECIMAL</code>；如果是日期与时间，就用<code>DATETIME</code>。</p>
<p>这样做的好处是，首先确保你的系统不会因为数据类型定义出错。不过，凡事都是有两面的，可靠性好，并不意味着高效。比如，TEXT虽然使用方便，但是效率不如CHAR(M)和VARCHAR(M)。</p>
<p>关于字符串的选择，建议参考如下阿里巴巴的《Java开发手册》规范：</p>
<p><strong>阿里巴巴《Java开发手册》之MySQL数据库：</strong></p>
<ul>
<li>任何字段如果为非负数，必须是 UNSIGNED</li>
<li>【<code>强制</code>】小数类型为DECIMAL，禁止使用 FLOAT 和 DOUBLE。<ul>
<li>说明：在存储的时候，FLOAT 和 DOUBLE 都存在精度损失的问题，很可能在比较值的时候，得到不正确的结果。如果存储的数据范围超过 DECIMAL 的范围，建议将数据拆成整数和小数并分开存储。</li>
</ul>
</li>
<li>【<code>强制</code>】如果存储的字符串长度几乎相等，使用 CHAR 定长字符串类型。</li>
<li>【<code>强制</code>】VARCHAR 是可变长字符串，不预先分配存储空间，长度不要超过 5000。如果存储长度大于此值，定义字段类型为 TEXT，独立出来一张表，用主键来对应，避免影响其它字段索引效率。</li>
</ul>
<h1 id="第13章-约束"><a href="#第13章-约束" class="headerlink" title="第13章 约束"></a>第13章 约束</h1><h2 id="1-约束-constraint-概述"><a href="#1-约束-constraint-概述" class="headerlink" title="1.约束(constraint)概述"></a>1.约束(constraint)概述</h2><h3 id="1-1-为什么需要约束"><a href="#1-1-为什么需要约束" class="headerlink" title="1.1 为什么需要约束"></a>1.1 为什么需要约束</h3><p>数据完整性（Data Integrity）是指数据的精确性（Accuracy）和可靠性（Reliability）。它是防止数据库中存在不符合语义规定的数据和防止因错误信息的输入输出造成无效操作或错误信息而提出的。</p>
<p>为了保证数据的完整性，SQL规范以约束的方式对<strong>表数据进行额外的条件限制</strong>。从以下四个方面考虑：</p>
<ul>
<li><code>实体完整性（Entity Integrity）</code>：例如，同一个表中，不能存在两条完全相同无法区分的记录</li>
<li><code>域完整性（Domain Integrity）</code>：例如：年龄范围0-120,性别范围“男&#x2F;女”</li>
<li><code>引用完整性（Referential Integrity）</code>：例如：员工所在部门，在部门表中要能找到这个部门</li>
<li><code>用户自定义完整性（User-defined Integrity）</code>：例如：用户名唯一、密码不能为空等，本部门经理的工资不得高于本部门职工的平均工资的5倍。</li>
</ul>
<h3 id="1-2-什么是约束"><a href="#1-2-什么是约束" class="headerlink" title="1.2 什么是约束"></a>1.2 什么是约束</h3><p>约束是表级的强制规定。</p>
<p>可以在<strong>创建表时规定约束（通过CREATE TABLE语句）</strong>，或者在<strong>表创建之后通过 ALTER TABLE 语句规定约束</strong>。</p>
<h3 id="1-3-约束的分类"><a href="#1-3-约束的分类" class="headerlink" title="1.3 约束的分类"></a>1.3 约束的分类</h3><ul>
<li><strong>根据约束数据列的限制</strong>，约束可分为：<ul>
<li><strong>单列约束</strong>：每个约束只约束一列</li>
<li><strong>多列约束</strong>：每个约束可约束多列数据</li>
</ul>
</li>
<li><strong>根据约束的作用范围</strong>，约束可分为：<ul>
<li><strong>列级约束</strong>：只能作用在一个列上，跟在列的定义后面</li>
<li><strong>表级约束</strong>：可以作用在多个列上，不与列一起，而是单独定义</li>
</ul>
</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">			位置			 支持的约束类型				是否可以起约束名</span><br><span class="line">列级约束：	列的后面		语法都支持，但外锭没有效果	   不可以</span><br><span class="line">表级约束：	所有列的下面	   默认和非空不支持，其他支持	  可以(主键没有效果)</span><br></pre></td></tr></table></figure>

<ul>
<li><strong>根据约束起的作用</strong>，约束可分为：<ul>
<li><strong>NOT NULL 非空约束，规定某个字段不能为空</strong></li>
<li><strong>UNIQUE 唯一约束，规定某个字段在整个表中是唯一的</strong></li>
</ul>
</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line">/*</span><br><span class="line">1. 基础知识</span><br><span class="line">1.1 为什么需要约束？为了保证数据的完整</span><br><span class="line"></span><br><span class="line">1.2 什么叫约束？对表中字段的限制。</span><br><span class="line"></span><br><span class="line">1.3 约束的分类：</span><br><span class="line"></span><br><span class="line">角度1：约束的字段的个数</span><br><span class="line">单列约束 vs 多列约束</span><br><span class="line"></span><br><span class="line">角度2：约束的作用范围</span><br><span class="line"></span><br><span class="line">列级约束：将此约束声明在对应字段的后面</span><br><span class="line">表级约束：在表中所有字段都声明完，在所有字段的后面声明的约束</span><br><span class="line"></span><br><span class="line">角度3：约束的作用(或功能)</span><br><span class="line">① not null  (非空约束)</span><br><span class="line">② unique  (唯一性约束)</span><br><span class="line">③ primary key  (主键约束)</span><br><span class="line">④ foreign key  (外键约束)</span><br><span class="line">⑤ check  (检查约束)</span><br><span class="line">⑥ default  (默认值约束)</span><br><span class="line">*/</span><br><span class="line">#1.4 如何添加/删除约束?</span><br><span class="line"></span><br><span class="line">CREATE TABLE 时添加约束</span><br><span class="line">ALTER TABLE 时增加约束、删除约束</span><br><span class="line"></span><br><span class="line">#2.如何查看表中的约束</span><br><span class="line">SELECT * FROM information_schema.table_constraints</span><br><span class="line">WHERE table_name = &#x27;employees&#x27;;</span><br><span class="line"></span><br><span class="line">CREATE DATABASE dbtest13;</span><br><span class="line">USE dbtest13;</span><br><span class="line"></span><br><span class="line">#3. not null (非空约束)</span><br><span class="line">#3.1 在CREATE TABLE时添加约束</span><br><span class="line"></span><br><span class="line">CREATE TABLE test1 (</span><br><span class="line">id INT NOT NULL,</span><br><span class="line">last_name VARCHAR(15) NOT NULL,</span><br><span class="line">email VARCHAR(25),</span><br><span class="line">salary DECIMAL(10,2)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">DESC test1;</span><br><span class="line"></span><br><span class="line">INSERT INTO test1(id,last_name,email,salary)</span><br><span class="line">VALUES(1,&#x27;Tom&#x27;,&#x27;tom@126.com&#x27;,3400);</span><br><span class="line"></span><br><span class="line">#错误：Column &#x27;last_name&#x27; cannot be null</span><br><span class="line">INSERT INTO test1(id,last_name,email,salary)</span><br><span class="line">VALUES(2,NULL,&#x27;toml0126.com&#x27;,3400);</span><br><span class="line"></span><br><span class="line">#错误：Column &#x27;id&#x27; cannot be null</span><br><span class="line">INSERT INTO test1(id,last_name,email,salary)</span><br><span class="line">VALUES(NULL,&#x27;Jerry&#x27;,&#x27;jerry0126.com&#x27;,3400);</span><br><span class="line"></span><br><span class="line">INSERT INTO test1(id,email)</span><br><span class="line">VALUES(2,&#x27;abc@126.com&#x27;);</span><br><span class="line"></span><br><span class="line">UPDATE test1</span><br><span class="line">SET last_name = NULL</span><br><span class="line">WHERE id = 1;</span><br><span class="line"></span><br><span class="line">UPDATE test1</span><br><span class="line">SET email = &#x27;tom@126.com&#x27;</span><br><span class="line">WHERE id = 1;</span><br><span class="line"></span><br><span class="line">#3.2 在ALTER TABLE时添加约束</span><br><span class="line">SELECT * FROM test1;</span><br><span class="line"></span><br><span class="line">DESC test1;</span><br><span class="line"></span><br><span class="line">ALTER TABLE test1</span><br><span class="line">MODIFY email VARCHAR(25) NOT NULL;</span><br><span class="line"></span><br><span class="line">#3.3 在ALTERTABLE时删除约束</span><br><span class="line">ALTER TABLE test1</span><br><span class="line">MODIFY email VARCHAR(25) NULL;</span><br></pre></td></tr></table></figure>



<h2 id="2-非空约束"><a href="#2-非空约束" class="headerlink" title="2.非空约束"></a>2.非空约束</h2><h3 id="2-1-作用"><a href="#2-1-作用" class="headerlink" title="2.1 作用"></a>2.1 作用</h3><p>限定某个字段&#x2F;某列的值不允许为空</p>
<h3 id="2-2-关键字"><a href="#2-2-关键字" class="headerlink" title="2.2 关键字"></a>2.2 关键字</h3><p>NOT NULL</p>
<h3 id="2-3-特点"><a href="#2-3-特点" class="headerlink" title="2.3 特点"></a>2.3 特点</h3><ul>
<li>默认，所有的类型的值都可以是NULL，包括INT、FLOAT等数据类型</li>
<li>非空约束只能出现在表对象的列上，只能某个列单独限定非空，不能组合非空</li>
<li>一个表可以有很多列都分别限定了非空</li>
<li>空字符串”不等于NULL，0也不等于NULL</li>
</ul>
<h3 id="2-4添加非空约束"><a href="#2-4添加非空约束" class="headerlink" title="2.4添加非空约束"></a>2.4添加非空约束</h3><p>（1）建表时</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE 表名称(</span><br><span class="line">    字段名 数据类型,</span><br><span class="line">    字段名 数据类型 NOT NULL,</span><br><span class="line">    字段名 数据类型 NOT NULL</span><br><span class="line">);</span><br></pre></td></tr></table></figure>





<h2 id="3-唯一性约束"><a href="#3-唯一性约束" class="headerlink" title="3.唯一性约束"></a>3.唯一性约束</h2><h3 id="3-1-作用"><a href="#3-1-作用" class="headerlink" title="3.1 作用"></a>3.1 作用</h3><p>用来限制某个字段&#x2F;某列的值不能重复。</p>
<h3 id="3-2-关键字"><a href="#3-2-关键字" class="headerlink" title="3.2 关键字"></a>3.2 关键字</h3><p>UNIQUE</p>
<h3 id="3-3-特点"><a href="#3-3-特点" class="headerlink" title="3.3 特点"></a>3.3 特点</h3><ul>
<li>同一个表可以有多个唯一约束。</li>
<li>唯一约束可以是某一个列的值唯一，也可以多个列组合的值唯一。</li>
<li>唯一性约束允许列值为空。</li>
<li>在创建唯一约束的时候，如果不给唯一约束命名，就默认和列名相同。</li>
<li><strong>MySQL会给唯一约束的列上默认创建一个唯一索引。</strong></li>
</ul>
<h3 id="3-4-添加唯一约束"><a href="#3-4-添加唯一约束" class="headerlink" title="3.4 添加唯一约束"></a>3.4 添加唯一约束</h3><p>（1）建表时</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br></pre></td><td class="code"><pre><span class="line">#4.unique（唯一性约束）</span><br><span class="line"></span><br><span class="line">#4.1 在CREATE TABLE时添加约束</span><br><span class="line">CREATE TABLE test2(</span><br><span class="line">id INT UNIQUE,  #列级约束</span><br><span class="line">last_name VARCHAR(15),</span><br><span class="line">email VARCHAR(25) UNIQUE,</span><br><span class="line">salary DECIMAL(10,2),</span><br><span class="line">#表级约束</span><br><span class="line">CONSTRAINT uk_test2_email UNIQUE(email)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">DESC test2;</span><br><span class="line"></span><br><span class="line">SELECT * FROM information_schema.table_constraints</span><br><span class="line">WHERE table_name = &#x27;test2&#x27;;</span><br><span class="line"></span><br><span class="line">#在创建唯一约束的时候，如果不给唯一约束命名，就默认和列名相同。</span><br><span class="line"></span><br><span class="line">INSERT INTO test2(id,last_name,email,salary)</span><br><span class="line">VALUES(1,&#x27;Tom&#x27;,&#x27;tom@126.com&#x27;,4500);</span><br><span class="line"></span><br><span class="line">#错误：Duplicate entry &#x27;1&#x27; for key &#x27;test2.id&#x27;</span><br><span class="line">INSERT INTO test2(id,last_name,email,salary)</span><br><span class="line">VALUES(1,&#x27;Tom1&#x27;,&#x27;toml0126.com&#x27;,4600);</span><br><span class="line"></span><br><span class="line">#错误：Duplicate entry &#x27;tom@126.com&#x27; for key &#x27;test2.uk_test2_email&#x27;</span><br><span class="line">INSERT INTO test2(id,last_name,email,salary)</span><br><span class="line">VALUES(2,&#x27;Tom1&#x27;,&#x27;tom@126.com&#x27;,4600);</span><br><span class="line"></span><br><span class="line">#可以向声明为unique的字段上添加null值。而且可以多次添加null</span><br><span class="line">INSERT INTO test2(id,last_name,email,salary)</span><br><span class="line">VALUES(2,&#x27;Tom1&#x27;,NULL,4600);</span><br><span class="line"></span><br><span class="line">INSERT INTO test2(id,last_name,email,salary)</span><br><span class="line">VALUES(3,&#x27;Tom2&#x27;,NULL,4600);</span><br><span class="line"></span><br><span class="line">SELECT * FROM test2;</span><br><span class="line"></span><br><span class="line">#4.2 在ALTERTABLE时添加约束</span><br><span class="line"></span><br><span class="line">DESC test2;</span><br><span class="line"></span><br><span class="line">UPDATE test2</span><br><span class="line">SET salary = 5000</span><br><span class="line">WHERE id = 3;</span><br><span class="line"></span><br><span class="line">ALTER TABLE test2</span><br><span class="line">ADD CONSTRAINT uk_test2_sal UNIQUE(salary);</span><br><span class="line"></span><br><span class="line">ALTER TABLE test2</span><br><span class="line">MODIFY last_name VARCHAR(15) UNIQUE;</span><br><span class="line"></span><br><span class="line">#4.3 复合的唯一性约束</span><br><span class="line">CREATE TABLE USER(</span><br><span class="line">id INT,</span><br><span class="line">`name` VARCHAR(15),</span><br><span class="line">`password` VARCHAR(25),</span><br><span class="line">#表级约束</span><br><span class="line">CONSTRAINT uk_user_name_pwd UNIQUE(`name`,`password`)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">INSERT INTO USER</span><br><span class="line">VALUES(1,&#x27;Tom&#x27;,&#x27;abc&#x27;);</span><br><span class="line">#可以成功的：</span><br><span class="line">INSERT INTO USER</span><br><span class="line">VALUES(1,&#x27;Tom1&#x27;,&#x27;abc&#x27;);</span><br><span class="line"></span><br><span class="line">SELECT *</span><br><span class="line">FROM USER;</span><br><span class="line"></span><br><span class="line">#案例：复合的唯一性约束的案例</span><br><span class="line">#学生表</span><br><span class="line">CREATE TABLE student(</span><br><span class="line">sid INT,  #学号</span><br><span class="line">sname VARCHAR(20),  #姓名</span><br><span class="line">tel CHAR(11) UNIQUE KEY,  #电话</span><br><span class="line">cardid CHAR(18) UNIQUE KEY  #身份证号</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">#课程表</span><br><span class="line">CREATE TABLE course(</span><br><span class="line">cid INT,  #课程编号</span><br><span class="line">cname VARCHAR(20)  #课程名称</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">#选课表</span><br><span class="line">CREATE TABLE student_course(</span><br><span class="line">id INT,</span><br><span class="line">sid INT,  #学号</span><br><span class="line">cid INT,  #课程编号</span><br><span class="line">score INT,</span><br><span class="line">UNIQUE KEY(sid,cid)  #复合唯一</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">INSERT INTO student VALUES(1,&#x27;张三&#x27;,&#x27;13710011002&#x27;,&#x27;101223199012015623&#x27;);  #成功</span><br><span class="line">INSERT INTO student VALUES(2,&#x27;李四&#x27;,&#x27;13710011003&#x27;,&#x27;101223199012015624&#x27;);  #成功</span><br><span class="line">INSERT INTO course VALUES(1001,&#x27;Java&#x27;),(1002,&#x27;MySQL&#x27;);  #成功</span><br><span class="line"></span><br><span class="line">SELECT * FROM student;</span><br><span class="line"></span><br><span class="line">SELECT * FROM course;</span><br><span class="line"></span><br><span class="line">TNSERT INTO student_course VALUES</span><br><span class="line">(1, 1, 1001, 89),</span><br><span class="line">(2, 1, 1002, 90),</span><br><span class="line">(3, 2, 1001, 88),</span><br><span class="line">(4, 2, 1002, 56);  #成功</span><br><span class="line"></span><br><span class="line">SELECT * FROM student_course;</span><br><span class="line"></span><br><span class="line">#错误：Duplicate entry &#x27;2-1002&#x27; for key &#x27;student_course.sid&#x27;</span><br><span class="line">INSERT INTO student_course VALUES</span><br><span class="line">(5,2,1002,67);</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>（2）建表后指定唯一键约束</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#字段列表中如果是一个字段，表示该列的值唯一。如果是两个或更多个字段，那么复合唯一，即多个字段的组合是唯一的</span><br><span class="line">#方式1：</span><br><span class="line">alter table 表名称 add unique key(字段列表);</span><br><span class="line">#方式2：</span><br><span class="line">alter table 表名称 modify 字段名 字段类型 unique;</span><br></pre></td></tr></table></figure>



<h3 id="3-5-删除唯一约束"><a href="#3-5-删除唯一约束" class="headerlink" title="3.5 删除唯一约束"></a>3.5 删除唯一约束</h3><ul>
<li>添加唯一性约束的列上也会自动创建唯一索引。</li>
<li>删除唯一约束只能通过删除唯一索引的方式删除。</li>
<li>删除时需要指定唯一索引名，唯一索引名就和唯一约束名一样。</li>
<li>如果创建唯一约束时未指定名称，如果是单列，就默认和列名相同；如果是组合列，那么默认和()中排在第一个的列名相同。也可以自定义唯一性约束名。</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM information_schema.table_constraints WHERE table_name = &#x27;表名&#x27;；  #查看都有哪些约束</span><br><span class="line"></span><br><span class="line">ALTER TABLE USER</span><br><span class="line">DROP INDEX uk_name_pwd;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>注意：可以通过 <code>show index from 表名称;</code> 查看表的索引</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">#4.4 删除唯一性约束</span><br><span class="line">-- 添加唯一性约束的列上也会自动创建唯一索引。</span><br><span class="line">-- 删除唯一约束只能通过删除唯一索引的方式删除。</span><br><span class="line">-- 删除时需要指定唯一索引名，唯一索引名就和唯一约束名一样。</span><br><span class="line">-- 如果创建唯一约束时未指定名称，如果是单列，就默认和列名相同；如果是组合列，那么默认和()中排在第一个的列名相同。也可以自定义唯一性约束名。</span><br><span class="line"></span><br><span class="line">SELECT * FROM information_schema.table_constraints</span><br><span class="line">WHERE table_name = &#x27;student_course&#x27;;</span><br><span class="line"></span><br><span class="line">SELECT * FROM information_schema.table_constraints</span><br><span class="line">WHERE table_name = &#x27;test2&#x27;;</span><br><span class="line"></span><br><span class="line">DESC test2;</span><br><span class="line"></span><br><span class="line">#如何删除唯一性索引</span><br><span class="line">ALTER TABLE test2</span><br><span class="line">DROP INDEX last_name;</span><br><span class="line"></span><br><span class="line">ALTER TABLE test2</span><br><span class="line">DROP INDEX uk_test2_sal;</span><br></pre></td></tr></table></figure>





<h2 id="4-PRIMARY-KEY约束"><a href="#4-PRIMARY-KEY约束" class="headerlink" title="4.PRIMARY KEY约束"></a>4.PRIMARY KEY约束</h2><h3 id="4-1-作用"><a href="#4-1-作用" class="headerlink" title="4.1 作用"></a>4.1 作用</h3><p>用来唯一标识表中的一行记录。</p>
<h3 id="4-2-关键字"><a href="#4-2-关键字" class="headerlink" title="4.2 关键字"></a>4.2 关键字</h3><p>primary key</p>
<h3 id="4-3-特点"><a href="#4-3-特点" class="headerlink" title="4.3 特点"></a>4.3 特点</h3><ul>
<li>主键约束相当于<strong>唯一约束+非空约束的组合</strong>，主键约束列不允许重复，也不允许出现空值。</li>
<li>一个表最多只能有一个主键约束，建立主键约束可以在列级别创建，也可以在表级别上创建。</li>
<li>主键约束对应着表中的一列或者多列（复合主键）</li>
<li>如果是多列组合的复合主键约束，那么这些列都不允许为空值，并且组合的值不允许重复。</li>
<li><strong>MySQL的主键名总是PRIMARY</strong>，就算自己命名了主键约束名也没用。</li>
<li>当创建主键约束时，系统默认会在所在的列或列组合上建立对应的<strong>主键索引</strong>（能够根据主键查询的，就根据主键查询，效率更高）。如果删除主键约束了，主键约束对应的索引就自动删除了。</li>
<li>需要注意的一点是，不要修改主键字段的值。因为主键是数据记录的唯一标识，如果修改了主键的值，就有可能会破坏数据的完整性。</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line">#5. primary key（主键约束）</span><br><span class="line">#5.1 在CREATE TABLE时添加约束</span><br><span class="line"></span><br><span class="line">#一个表中最多只能有一个主键约束。</span><br><span class="line">#错误：Multiple primary key defined</span><br><span class="line">CREATE TABLE test3(</span><br><span class="line">id INT PRIMARY KEY,  #列级约束</span><br><span class="line">last_name VARCHAR(15) PRIMARY KEY,</span><br><span class="line">salary DECIMAL(10,2),</span><br><span class="line">email VARCHAR(25)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">#主键约束特征：非空且唯一，用于唯一的标识表中的一条记录。</span><br><span class="line">CREATE TABLE test4(</span><br><span class="line">id INT PRIMARY KEY,  #列级约束</span><br><span class="line">last_name VARCHAR(15),</span><br><span class="line">salary DECIMAL(10,2),</span><br><span class="line">email VARCHAR(25)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">#MySQL的主键名总是PRIMARY，就算自己命名了主键约束名也没用。</span><br><span class="line">CREATE TABLE test5(</span><br><span class="line">id INT,</span><br><span class="line">last_name VARCHAR(15),</span><br><span class="line">salary DECIMAL(10,2),</span><br><span class="line">email VARCHAR(25)</span><br><span class="line">#表级约束</span><br><span class="line">CONSTRAINT pk_test5_id PRIMARY KEY(id)  #没有必要起名字</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">SELECT * FROM information_schema.table_constraints</span><br><span class="line">WHERE table_name = &#x27;test5&#x27;;</span><br><span class="line"></span><br><span class="line">INSERT INTO test4(id,last_name,salary,email)</span><br><span class="line">VALUES(1,&#x27;Tom&#x27;,4500,&#x27;tom@126.com&#x27;);</span><br><span class="line"></span><br><span class="line">#错误：Duplicate entry &#x27;1&#x27; for key &#x27;test4.PRIMARY&#x27;</span><br><span class="line">INSERT INTO test4 (id,last_name,salary,email)</span><br><span class="line">VALUES(1,&#x27;Tom&#x27;,4500,&#x27;tom@126.com&#x27;);</span><br><span class="line"></span><br><span class="line">#错误：Column &#x27;id&#x27; cannot be null</span><br><span class="line">INSERT INTO test4 (id,last_name,salary,email)</span><br><span class="line">VALUES (NULL,&#x27;Tom&#x27;,4500,&#x27;tom@126.com&#x27;);</span><br><span class="line"></span><br><span class="line">SELECT * FROM test4;</span><br><span class="line"></span><br><span class="line">CREATE TABLE user1(</span><br><span class="line">id INT,</span><br><span class="line">`NAME` VARCHAR(15),</span><br><span class="line">`PASSWORD` VARCHAR(25),</span><br><span class="line">PRIMARY KEY (`NAME`,`PASSWORD`)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">#如果是多列组合的复合主键约束，那么这些列都不允许为空值，并且组合的值不允许重复。</span><br><span class="line">INSERT INTO user1</span><br><span class="line">VALUES(1,&#x27;Tom&#x27;,&#x27;abc&#x27;);</span><br><span class="line"></span><br><span class="line">INSERT INTO user1</span><br><span class="line">VALUES(1,&#x27;Tom1&#x27;,&#x27;abc&#x27;);</span><br><span class="line"></span><br><span class="line">#错误：Column &#x27;name&#x27; cannot be null</span><br><span class="line">INSERT INTO user1</span><br><span class="line">VALUES(1,NULL,&#x27;abc&#x27;);</span><br><span class="line"></span><br><span class="line">SELECT * FROM user1;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#4.2 在ALTER TABLE时添加约束</span><br><span class="line">CREATE TABLE test6(</span><br><span class="line">id INT,</span><br><span class="line">last_name VARCHAR(15),</span><br><span class="line">salary DECIMAL(10,2),</span><br><span class="line">email VARCHAR(25)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">DESC test6;</span><br><span class="line"></span><br><span class="line">ALTER TABLE test6</span><br><span class="line">ADD PRIMARY KEY (id);</span><br><span class="line"></span><br><span class="line">#4.3 如何删除主键约束(在实际开发中，不会去删除表中的主键约束！)</span><br><span class="line">ALTER TABLE test6</span><br><span class="line">DROP PRIMARY KEY (id);</span><br></pre></td></tr></table></figure>



<h3 id="4-6-删除主键约束"><a href="#4-6-删除主键约束" class="headerlink" title="4.6 删除主键约束"></a>4.6 删除主键约束</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">alter table 表名称 drop primary key;</span><br><span class="line"></span><br><span class="line">#举例：</span><br><span class="line">ALTER TABLE student DROP PRIMARY KEY;</span><br><span class="line">ALTER TABLE emp5 DROP PRIMARY KEY;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>说明：删除主键约束，不需要指定主键名，因为一个表只有一个主键，删除主键约束后，非空还存在。</p>
</blockquote>
<h2 id="5-自增列：AUTO-INCREMENT"><a href="#5-自增列：AUTO-INCREMENT" class="headerlink" title="5.自增列：AUTO_INCREMENT"></a>5.自增列：AUTO_INCREMENT</h2><h3 id="5-1-作用"><a href="#5-1-作用" class="headerlink" title="5.1 作用"></a>5.1 作用</h3><p>某个字段的值自增</p>
<h3 id="5-2-关键字"><a href="#5-2-关键字" class="headerlink" title="5.2 关键字"></a>5.2 关键字</h3><p>auto_increment</p>
<h3 id="5-3-特点和要求"><a href="#5-3-特点和要求" class="headerlink" title="5.3 特点和要求"></a>5.3 特点和要求</h3><p>（1）一个表最多只能有一个自增长列</p>
<p>（2）当需要产生唯一标识符或顺序值时，可设置自增长</p>
<p>（3）自增长列约束的列必须是键列（主键列，唯一键列）</p>
<p>（4）自增约束的列的数据类型必须是整数类型</p>
<p>（5）如果自增列指定了 0 和 null，会在当前最大值的基础上自增；如果自增列手动指定了具体值，直接赋值为具<br>体值。</p>
<p>错误演示：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">create table employee(</span><br><span class="line">eid int auto_increment,</span><br><span class="line">ename varchar(20)</span><br><span class="line">);</span><br><span class="line"># ERROR 1075 (42000): Incorrect table definition; there can be only one auto column and it must be defined as a key</span><br><span class="line"></span><br><span class="line">create table employee(</span><br><span class="line">eid int primary key,</span><br><span class="line">ename varchar(20) unique key auto_increment</span><br><span class="line">);</span><br><span class="line"># ERROR 1063 (42000): Incorrect column specifier for column &#x27;ename&#x27;  因为ename不是整数类型</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">#6. 自增长列：AUTO_INCREMENT</span><br><span class="line">#6.1 在CREATE TABLE时添加</span><br><span class="line">CREATE TABLE test7(</span><br><span class="line">id INT PRIMARY KEY AUTO_INCREMENT,</span><br><span class="line">last_name VARCHAR(15)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">##开发中，一旦主键作用的字段上声明有AUTO_INCREMENT，则我们在添加数据时，就不要给主键对应的字段去赋值了。</span><br><span class="line">INSERT INTO test7(last_name)</span><br><span class="line">VALUES(&#x27;Tom&#x27;);</span><br><span class="line"></span><br><span class="line">SELECT * FROM test7;</span><br><span class="line"></span><br><span class="line">#当我们向主键（含AUTO_INCREMENT）的字段上添加 0 或 null时，实际上会自动的往上添加指定的字段的数值</span><br><span class="line">INSERT INTO test7(id,last_name)</span><br><span class="line">VALUES(0,&#x27;Tom&#x27;);</span><br><span class="line"></span><br><span class="line">INSERT INTO test7(id,last_name)</span><br><span class="line">VALUES(NULL,&#x27;Tom&#x27;);</span><br><span class="line"></span><br><span class="line">INSERT INTO test7(id,last_name)</span><br><span class="line">VALUES(10,&#x27;Tom&#x27;);</span><br><span class="line"></span><br><span class="line">INSERT INTO test7(id,last_name)</span><br><span class="line">VALUES(-10,&#x27;Tom&#x27;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#6.2 在 ALTER TABLE 时添加</span><br><span class="line">CREATE TABLE test8(</span><br><span class="line">id INT PRIMARY KEY ,</span><br><span class="line">last_name VARCHAR(15)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">DESC test8;</span><br><span class="line"></span><br><span class="line">ALTER TABLE test8</span><br><span class="line">MODIFY id INT AUTO_INCREMENT;</span><br><span class="line"></span><br><span class="line">#6.3 在 ALTER TABLE 时删除</span><br><span class="line">ALTER TABLE test8</span><br><span class="line">MODIFY id INT;</span><br></pre></td></tr></table></figure>



<h3 id="5-6MySQL8-0新特性-自增变量的持久化"><a href="#5-6MySQL8-0新特性-自增变量的持久化" class="headerlink" title="5.6MySQL8.0新特性-自增变量的持久化"></a>5.6MySQL8.0新特性-自增变量的持久化</h3><p>在MySQL 8.0之前，自增主键AUTO_INCREMENT的值如果大于max(primary key)+1,在MySQL重启后，会重置AUTO_INCREMENT&#x3D;max(primary key)+1,这种现象在某些情况下会导致业务主键冲突或者其他难以发现的问题。下面通过案例来对比不同的版本中自增变量是否持久化。</p>
<p>在MySQL 5.7版本中，测试步骤如下：</p>
<p>创建的数据表中包含自增主键的id字段，语句如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line">#6.4 MySQL8.0新特性-自增变量的持久化</span><br><span class="line">#在MySQL 5.7中演示</span><br><span class="line">CREATE DATABASE dbtest13;</span><br><span class="line"></span><br><span class="line">USE dbtest13;</span><br><span class="line"></span><br><span class="line">ICREATE TABLE test9(</span><br><span class="line">id INT PRIMARY KEY AUTO_INCREMENT</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">INSERT INTO test9</span><br><span class="line">VALUES(0),(0),(0),(0);</span><br><span class="line"></span><br><span class="line">SELECT * FROM test9;</span><br><span class="line"></span><br><span class="line">DELETE FROM test9</span><br><span class="line">WHERE id = 4;</span><br><span class="line"></span><br><span class="line">INSERT INTO test9</span><br><span class="line">VALUES(0);</span><br><span class="line"></span><br><span class="line">DELETE FROM test9</span><br><span class="line">WHERE id = 5;</span><br><span class="line"></span><br><span class="line">#重启服务器</span><br><span class="line">SELECT * FROM test9;</span><br><span class="line"></span><br><span class="line">INSERT INTO test9</span><br><span class="line">VALUES (0) ;</span><br><span class="line"></span><br><span class="line">SELECT * FROM test9;</span><br><span class="line"></span><br><span class="line">#在MySQL 8.0中演示</span><br><span class="line">CREATE DATABASE dbtest13;</span><br><span class="line"></span><br><span class="line">USE dbtest13;</span><br><span class="line"></span><br><span class="line">ICREATE TABLE test9(</span><br><span class="line">id INT PRIMARY KEY AUTO_INCREMENT</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">INSERT INTO test9</span><br><span class="line">VALUES(0),(0),(0),(0);</span><br><span class="line"></span><br><span class="line">SELECT * FROM test9;</span><br><span class="line"></span><br><span class="line">DELETE FROM test9</span><br><span class="line">WHERE id = 4;</span><br><span class="line"></span><br><span class="line">INSERT INTO test9</span><br><span class="line">VALUES(0);</span><br><span class="line"></span><br><span class="line">DELETE FROM test9</span><br><span class="line">WHERE id = 5;</span><br><span class="line"></span><br><span class="line">#重启服务器</span><br><span class="line">SELECT * FROM test9;</span><br><span class="line"></span><br><span class="line">INSERT INTO test9</span><br><span class="line">VALUES (0) ;</span><br><span class="line"></span><br><span class="line">SELECT * FROM test9;</span><br></pre></td></tr></table></figure>

<p>从结果可以看出，自增变量已经持久化了。</p>
<p>MySQL 8.0将自增主键的计数器持久化到<code>重做日志</code>中。每次计数器发生改变，都会将其写入重做日志中。如果数据库重启，InnoDB会根据重做日志中的信息来初始化计数器的内存值。</p>
<h2 id="6-FOREIGN-KEY约束"><a href="#6-FOREIGN-KEY约束" class="headerlink" title="6.FOREIGN KEY约束"></a>6.FOREIGN KEY约束</h2><h3 id="6-1-作用"><a href="#6-1-作用" class="headerlink" title="6.1 作用"></a>6.1 作用</h3><p>限定某个表的某个字段的引用完整性。</p>
<p>比如：员工表的员工所在部门的选择，必须在部门表能找到对应的部分。</p>
<h3 id="6-2-关键字"><a href="#6-2-关键字" class="headerlink" title="6.2 关键字"></a>6.2 关键字</h3><p>FOREIGN KEY</p>
<h3 id="6-3-主表和从表-x2F-父表和子表"><a href="#6-3-主表和从表-x2F-父表和子表" class="headerlink" title="6.3 主表和从表&#x2F;父表和子表"></a>6.3 主表和从表&#x2F;父表和子表</h3><p>主表（父表）：被引用的表，被参考的表</p>
<p>从表（子表）：引用别人的表，参考别人的表</p>
<p>例如：员工表的员工所在部门这个字段的值要参考部门表：部门表是主表，员工表是从表。</p>
<p>例如：学生表、课程表、选课表：选课表的学生和课程要分别参考学生表和课程表，学生表和课程表是主表，选<br>课表是从表。</p>
<h3 id="6-4特点"><a href="#6-4特点" class="headerlink" title="6.4特点"></a>6.4特点</h3><p>（1）从表的外键列，必须引用&#x2F;参考主表的键主键或唯一约束的列</p>
<p>​	为什么？因为被依赖&#x2F;被参考的值必须是唯一的</p>
<p>（2）在创建外键约束时，如果不给外键约束命名，<strong>默认名不是列名，而是自动产生一个外键名</strong>（例如student_ibfk_1;)，也可以指定外键约束名。</p>
<p>（3）创建（CREATE）表时就指定外键约束的话，先创建主表，再创建从表</p>
<p>（4）删表时，先删从表（或先删除外键约束），再删除主表</p>
<p>（5）当主表的记录被从表参照时，主表的记录将不允许删除，如果要删除数据，需要先删除从表中依赖该记录的数据，然后才可以删除主表的数据</p>
<p>（6）在“从表”中指定外键约束，并且一个表可以建立多个外键约束</p>
<p>（7）从表的外键列与主表被参照的列名字可以不相同，但是数据类型必须一样，逻辑意义一致。如果类型不一样，创建子表时，就会出现错误“ERROR 1005(HY000):Can’t create table’database.tablename’(errno:150)”。</p>
<p>​	例如：都是表示部门编号，都是int类型。</p>
<p>（8）<strong>当创建外键约束时，系统默认会在所在的列上建立对应的普通索引</strong>。但是索引名是列名，不是外键的约束名。（根据外键查询效率很高）</p>
<p>（9）删除外键约束后，必须<code>手动</code>删除对应的索引</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line">#7.foreign key（外键约束）</span><br><span class="line">#7.1 在CREATE TABLE时添加</span><br><span class="line">#主表和从表；父表和子表</span><br><span class="line"># ①先创建主表</span><br><span class="line">CREATE TABLE dept1(</span><br><span class="line">dept_id TNT,</span><br><span class="line">dept_name VARCHAR(15)</span><br><span class="line">);</span><br><span class="line"># ②再创建从表</span><br><span class="line">CREATE TABLE emp1(</span><br><span class="line">emp_id INT PRIMARY KEY AUTO_INCREMENT,</span><br><span class="line">emp_name VARCHAR (15),</span><br><span class="line">department_id INT,</span><br><span class="line">#表级约束</span><br><span class="line">CONSTRAINT fk_emp1_dept_id FOREIGN KEY (department_id) REFERENCES dept1(dept_id)</span><br><span class="line">);</span><br><span class="line">#上述操作报错，因为主表中的dept_id上没有主键约束或唯一性约束。</span><br><span class="line"># ③添加</span><br><span class="line">ALTER TABLE dept1</span><br><span class="line">ADD PRIMARY KEY (dept_id);</span><br><span class="line"></span><br><span class="line">DESC dept1;</span><br><span class="line"></span><br><span class="line"># ④再创建从表</span><br><span class="line">CREATE TABLE emp1(</span><br><span class="line">emp_id INT PRIMARY KEY AUTO_INCREMENT,</span><br><span class="line">emp_name VARCHAR (15),</span><br><span class="line">department_id INT,</span><br><span class="line">#表级约束</span><br><span class="line">CONSTRAINT fk_emp1_dept_id FOREIGN KEY (department_id) REFERENCES dept1(dept_id)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">DESC emp1;</span><br><span class="line"></span><br><span class="line">SELECT * FROM information_schema.table_constraints</span><br><span class="line">WHERE table_name = &#x27;emp1&#x27;;</span><br><span class="line"></span><br><span class="line">#7.2 演示外键的效果</span><br><span class="line">#添加失败</span><br><span class="line">INSERT INTO emp1</span><br><span class="line">VALUES (1001,&#x27;Tom&#x27;,10);</span><br><span class="line"></span><br><span class="line">INSERT INTO dept1</span><br><span class="line">VALUES(10,&#x27;IT&#x27;);</span><br><span class="line"></span><br><span class="line">#在主表dept1中添加了10号部门以后，我们就可以在从表中添加10号部门的员工</span><br><span class="line">INSERT INTO emp1</span><br><span class="line">VALUES(1001,&#x27;Tom&#x27;,10);</span><br><span class="line"></span><br><span class="line">#删除失败</span><br><span class="line">DELETE FROM dept1</span><br><span class="line">WHERE dept_id = 10;</span><br><span class="line"></span><br><span class="line">#更新失败</span><br><span class="line">UPDATE dept1</span><br><span class="line">SET dept_id = 20</span><br><span class="line">WHERE dept_id = 10;</span><br><span class="line"></span><br><span class="line">#7.3 在 ALTER TABLE 时添加外键约束</span><br><span class="line">CREATE TABLE dept2(</span><br><span class="line">dept_id INT PRIMARY KEY,</span><br><span class="line">dept_name VARCHAR(15)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">CREATE TABLE emp2(</span><br><span class="line">emp_id INT PRIMARY KEY AUTO_INCREMENT,</span><br><span class="line">emp_name VARCHAR(15),</span><br><span class="line">department_id INT</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">ALTER TABLE emp2</span><br><span class="line">ADD CONSTRAINT fk_emp2_dept_id FOREIGN KEY(department_id) REFERENCES dept2(dept_id);</span><br><span class="line"></span><br><span class="line">SELECT * FROM information_schema.table_constraints</span><br><span class="line">WHERE table_name = &#x27;emp2&#x27;;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>总结：约束关系是针对双方的</p>
<ul>
<li>添加了外键约束后，主表的修改和删除数据受约束</li>
<li>添加了外键约束后，从表的添加和修改数据受约束</li>
<li>在从表上建立外键，要求主表必须存在</li>
<li>删除主表时，要求从表从表先删除，或将从表中外键引用该主表的关系先删除</li>
</ul>
<h3 id="6-7-约束等级"><a href="#6-7-约束等级" class="headerlink" title="6.7 约束等级"></a>6.7 约束等级</h3><ul>
<li><code>Cascade方式</code>：在父表上update&#x2F;delete记录时，同步update&#x2F;delete掉子表的匹配记录</li>
<li><code>Set null方式</code>：在父表上update&#x2F;delete记录时，将子表上匹配记录的列设为null,但是要注意子表的外键列不能为not null</li>
<li><code>No action方式</code>：如果子表中匹配的记录，则不允许对父表对应候选键进行update&#x2F;delete操作</li>
<li><code>Restrict方式</code>：同no action,都是立即检查外键约束</li>
<li><code>Set default方式</code>（在可视化工具SQLyog中可能显示空白）：父表有变更时，子表将外键列设置成一个默认的值，但Innodb不能识别</li>
</ul>
<p>如果没有指定等级，就相当于Restrict方式。</p>
<p>对于外键约束，最好是采用：<code>ON UPDATE CASCADE ON DELETE RESTRICT</code> 的方式。</p>
<p>(1) 演示1：on update cascade on delete set null</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">create table dept(</span><br><span class="line">    did int primary key,  #部门编号</span><br><span class="line">    dname varchar(50)  #部门名称</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">create table emp(</span><br><span class="line">    eid int primary key,  #员工编号</span><br><span class="line">    ename varchar(5),  #员工姓名</span><br><span class="line">    deptid int,  #员工所在的部门</span><br><span class="line">    foreign key (deptid) references dept(did) on update cascade on delete set null</span><br><span class="line">    #把修改操作设置为级联修改等级，把删除操作设置为set null等级</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">insert into dept values(1001,&#x27;教学部&#x27;);</span><br><span class="line">insert into dept values(1002,&#x27;则务部&#x27;);</span><br><span class="line">insert into dept values(1003,&#x27;咨询部&#x27;);</span><br><span class="line"></span><br><span class="line">INSERT INTO emp VALUES(1,&#x27;张三&#x27;,1001);  #在添加这条记录时，要求部门表有1001部门</span><br><span class="line">INSERT INTO emp VALUES(2,&#x27;李四&#x27;,1001);</span><br><span class="line">INSERT INTO emp VALUES(3,&#x27;王五&#x27;,1002);</span><br><span class="line"></span><br><span class="line">SELECT * FROM dept;</span><br><span class="line"></span><br><span class="line">SELECT * FROM emp;</span><br><span class="line"></span><br><span class="line">UPDATE dept</span><br><span class="line">SET did = 1004</span><br><span class="line">WHERE did = 1002;</span><br><span class="line"></span><br><span class="line">DELETE FROM dept</span><br><span class="line">WHERE did = 1004;</span><br><span class="line"></span><br><span class="line">SELECT * FROM dept;</span><br><span class="line"></span><br><span class="line">SELECT * FROM emp;</span><br></pre></td></tr></table></figure>



<h3 id="6-8删除外键约束"><a href="#6-8删除外键约束" class="headerlink" title="6.8删除外键约束"></a>6.8删除外键约束</h3><p>流程如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">（1）第一步先查看约束名和删除外键约束</span><br><span class="line">SELECT * FROM information_schema.table_constraints WHERE table_name = &#x27;表名称&#x27;;  #查看某个表的约束名</span><br><span class="line"></span><br><span class="line">ALTER TABLE 从表名 DROP FOREIGN KEY 外键约束名;</span><br><span class="line"></span><br><span class="line">（2）第二步查看索引名和删除索引。（注意，只能手动删除）</span><br><span class="line">SHOW INDEX FROM 表名称;  #查看某个表的索引名</span><br><span class="line"></span><br><span class="line">ALTER TABLE 从表名 DROP INDEX 索引名;</span><br></pre></td></tr></table></figure>

<p>举例：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">#7.5删除外键约束</span><br><span class="line">#一个表中可以声明有多个外键约束</span><br><span class="line">USE atguigudb;</span><br><span class="line">SELECT * FROM information_schema.table_constraints</span><br><span class="line">WHERE table_name = &#x27;employees&#x27;;</span><br><span class="line"></span><br><span class="line">USE dbtest13;</span><br><span class="line"></span><br><span class="line">SELECT * FROM information_schema.table_constraints</span><br><span class="line">WHERE table_name = &#x27;emp1&#x27;;</span><br><span class="line"></span><br><span class="line">#删除外键约束</span><br><span class="line">ALTER TABLE emp1</span><br><span class="line">DROP FOREIGN KEY fk_emp1_dept_id;</span><br><span class="line"></span><br><span class="line">#再手动的删除外键约束对应的普通索引</span><br><span class="line">SHOW INDEX FROM emp1;</span><br><span class="line"></span><br><span class="line">ALTER TABLE emp1</span><br><span class="line">DROP INDEX fk_emp1_dept_id;</span><br></pre></td></tr></table></figure>



<h3 id="6-9-开发场景"><a href="#6-9-开发场景" class="headerlink" title="6.9 开发场景"></a>6.9 开发场景</h3><p><strong>问题1：如果两个表之间有关系（一对一、一对多），比如：员工表和部门表（一对多），它们之间是否一定要建外键约束？</strong></p>
<p>答：不是的</p>
<p><strong>问题2：建和不建外键约束有什么区别？</strong></p>
<p>答：建外键约束，你的操作（创建表、删除表、添加、修改、删除）会受到限制，从语法层面受到限制。例如：在员工表中不可能添加一个员工信息，它的部门的值在部门表中找不到。</p>
<p>不建外键约束，你的操作（创建表、删除表、添加、修改、删除）不受限制，要保证数据的<code>引用完整性</code>，只能依<code>靠程序员的自觉</code>，或者是<code>在Java程序中进行限定</code>。例如：在员工表中，可以添加一个员工的信息，它的部门指定为一个完全不存在的部门。</p>
<p><strong>问题3：那么建和不建外键约束和查询有没有关系？</strong></p>
<p>答：没有</p>
<blockquote>
<p>在MySQL里，外键约束是有成本的，需要消耗系统资源。对于大并发的SQL操作，有可能会不适合。比如大型网站的中央数据库，可能会<code>因为外键约束的系统开销而变得非常慢</code>。所以，MySQL允许你不使用系统自带的外键约束，在<code>应用层面</code>完成检查数据一致性的逻辑。也就是说，即使你不用外键约束，也要想办法通过应用层面的附加逻辑，来实现外键约束的功能，确保数据的一致性。</p>
</blockquote>
<h3 id="6-10-阿里开发规范"><a href="#6-10-阿里开发规范" class="headerlink" title="6.10 阿里开发规范"></a>6.10 阿里开发规范</h3><p>【<code>强制</code>】不得使用外键与级联，一切外键概念必须在应用层解决。</p>
<p>说明：（概念解释）学生表中的student_id是主键，那么成绩表中的student_id则为外键。如果更新学生表中的student_id,同时触发成绩表中的student_id更新，即为级联更新。外键与级联更新适用于<code>单机低并发</code>，不适合<code>分布式、高并发集群</code>；级联更新是强阻塞，存在数据库<code>更新风暴</code>的风险；外键影响数据库的<code>插入速度</code>。</p>
<h2 id="7-CHECK约束"><a href="#7-CHECK约束" class="headerlink" title="7.CHECK约束"></a>7.CHECK约束</h2><h3 id="7-1-作用"><a href="#7-1-作用" class="headerlink" title="7.1 作用"></a>7.1 作用</h3><p>检查某个字段的值是否符号xx要求，一般指的是值的范围</p>
<h3 id="7-2-关键字"><a href="#7-2-关键字" class="headerlink" title="7.2 关键字"></a>7.2 关键字</h3><p>CHECK</p>
<h3 id="7-3-说明：MySQL5-7不支特"><a href="#7-3-说明：MySQL5-7不支特" class="headerlink" title="7.3 说明：MySQL5.7不支特"></a>7.3 说明：MySQL5.7不支特</h3><p>MySQL5.7可以使用check约束，但check约束对数据验证没有任何作用。添加数据时，没有任何错误或警告</p>
<p>但是<strong>MySQL 8.0中可以使用check约束了</strong>。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">create table employee(</span><br><span class="line">    eid int primary key,</span><br><span class="line">    ename varchar(5),</span><br><span class="line">    gender char check（&#x27;男&#x27; or &#x27;女&#x27;）</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">insert into employee values(1,&#x27;张三&#x27;,&#x27;妖&#x27;);</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"># 8.check约束</span><br><span class="line"># MySQL8.0</span><br><span class="line">CREATE TABLE test10(</span><br><span class="line">id INT,</span><br><span class="line">last_name VARCHAR(15),</span><br><span class="line">salary DECIMAL(10,2) CHECK(salary &gt; 2000)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">INSERT INTO test10</span><br><span class="line">VALUES(1,&#x27;Tom&#x27;,2500);</span><br><span class="line"></span><br><span class="line">#添加失败</span><br><span class="line">INSERT INTO test10</span><br><span class="line">VALUES(2,&#x27;Tom1&#x27;,1500);</span><br><span class="line"></span><br><span class="line">SELECT * FROM test10;</span><br><span class="line"></span><br><span class="line"># MySQL5.7 不支持CHECK约束，MySQL8.0支持CHECK约束</span><br><span class="line">CREATE TABLE test10(</span><br><span class="line">id INT,</span><br><span class="line">last_name VARCHAR(15),</span><br><span class="line">salary DECIMAL(10,2) CHECK(salary &gt; 2000)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">INSERT INTO test10</span><br><span class="line">VALUES(1,&#x27;Tom&#x27;,2500);</span><br><span class="line"></span><br><span class="line">#添加成功</span><br><span class="line">INSERT INTO test10</span><br><span class="line">VALUES(2,&#x27;Tom1&#x27;,1500);</span><br><span class="line"></span><br><span class="line">SELECT * FROM test10;</span><br></pre></td></tr></table></figure>





<h2 id="8-DEFAULT约束"><a href="#8-DEFAULT约束" class="headerlink" title="8.DEFAULT约束"></a>8.DEFAULT约束</h2><h3 id="8-1-作用"><a href="#8-1-作用" class="headerlink" title="8.1 作用"></a>8.1 作用</h3><p>给某个字段&#x2F;某列指定默认值，一旦设置默认值，在插入数据时，如果此字段没有显式赋值，则赋值为默认值。</p>
<h3 id="8-2-关键字"><a href="#8-2-关键字" class="headerlink" title="8.2 关键字"></a>8.2 关键字</h3><p>DEFAULT</p>
<h3 id="8-3-如何给字段加默认值"><a href="#8-3-如何给字段加默认值" class="headerlink" title="8.3 如何给字段加默认值"></a>8.3 如何给字段加默认值</h3><p>（1）建表时</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">create table 表名称(</span><br><span class="line">    字段名  数据类型  primary key,</span><br><span class="line">    字段名  数据类型  unique key not null,</span><br><span class="line">    字段名  数据类型  unique key,</span><br><span class="line">    字段名  数据类型  not null default 默认值,</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">create table 表名称(</span><br><span class="line">    字段名  数据类型  default  默认值,</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#9.DEFAULT约束</span><br><span class="line">#9.1 在CREATE TABLE添加约束</span><br><span class="line">CREATE TABLE test11(</span><br><span class="line">id INT,</span><br><span class="line">last_name VARCHAR(15),</span><br><span class="line">salary DECIMAL(10,2) DEFAULT 2000</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">DESC test11;</span><br><span class="line"></span><br><span class="line">INSERT INTO test11(id,last_name,salary)</span><br><span class="line">VALUES(1,&#x27;Tom&#x27;,3000);</span><br><span class="line"></span><br><span class="line">INSERT INTO test11(id,last_name)</span><br><span class="line">VALUES(2,&#x27;Tom1&#x27;);</span><br><span class="line"></span><br><span class="line">SELECT *</span><br><span class="line">FROM test11;</span><br><span class="line"></span><br><span class="line">#9.2 在ALTER TABLE添加约束</span><br><span class="line">ICREATE TABLE test12(</span><br><span class="line">id INT,</span><br><span class="line">last_name VARCHAR(15),</span><br><span class="line">salary DECIMAL(10,2)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">DESC test12;</span><br><span class="line"></span><br><span class="line">ALTER TABLE test12</span><br><span class="line">MODIFY salary DECIMAL(8,2) DEFAULT 2500;</span><br><span class="line"></span><br><span class="line">#9.3 在ALTER TABLE删除约束</span><br><span class="line">ALTER TABLE testl2</span><br><span class="line">MODIFY salary DECIMAL(8,2);</span><br></pre></td></tr></table></figure>



<h2 id="9-面试"><a href="#9-面试" class="headerlink" title="9.面试"></a>9.面试</h2><p><strong>面试1、为什么建表时，加 not null default “ 或 default 0</strong></p>
<p>答：不想让表中出现null值。</p>
<p><strong>面试2、为什么不想要null的值</strong></p>
<p>答：（1）不好比较。null是一种特殊值，比较时只能用专门的is null 和 is not null来比较。碰到运算符，通常返回null。</p>
<p>​	（2）效率不高。影响提高索引效果。因此，我们往往在建表时 not null default “ 或 default 0</p>
<p><strong>面试3、带AUTO_INCREMENT约束的字段值是从1开始的吗？</strong></p>
<p>在MySQL中，默认AUTO_INCREMENT的初始值是1，每新增一条记录，字段值自动加1。设置自增属性（AUTO_INCREMENT）的时候，还可以指定第一条插入记录的自增字段的值，这样新插入的记录的自增字段值从初始值开始递增，如在表中插入第一条记录，同时指定id值为5，则以后插入的记录的id值就会从6开始往上增加。添加主键约束时，往往需要设置字段自动增加属性。</p>
<p><strong>面试4、并不是每个表都可以任意选择存储引擎？</strong></p>
<p>外键约束（FOREIGN KEY）不能跨引擎使用。</p>
<p>MySQL支持多种存储引擎，每一个表都可以指定一个不同的存储引擎，需要注意的是：外键约束是用来保证数据的参照完整性的，如果表之间需要关联外键，却指定了不同的存储引擎，那么这些表之间是不能创建外键约束的。所以说，存储引擎的选择也不完全是随意的。</p>
<h2 id="第13章-约束-1"><a href="#第13章-约束-1" class="headerlink" title="第13章 约束"></a>第13章 约束</h2><h2 id="基础练习"><a href="#基础练习" class="headerlink" title="基础练习"></a>基础练习</h2><h3 id="练习1-2"><a href="#练习1-2" class="headerlink" title="练习1"></a>练习1</h3><p>已经存在数据库test04_emp,两张表emp2和dept2</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">CREATE DATABASE test04_emp;</span><br><span class="line"></span><br><span class="line">use test04_emp;</span><br><span class="line"></span><br><span class="line">CREATE TABLE emp2(</span><br><span class="line">id INT,</span><br><span class="line">emp_name VARCHAR(15)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">CREATE TABLE dept2(</span><br><span class="line">id INT,</span><br><span class="line">dept_name VARCHAR(15)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>题目：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">#1.向表emp2的id列中添加PRIMARY KEY约束</span><br><span class="line">ALTER TABLE emp2</span><br><span class="line">ADD CONSTRAINT pk_emp2_id PRIMARY KEY(id);</span><br><span class="line"></span><br><span class="line">#2.向表dept2的id列中添加PRIMARY KEY约束</span><br><span class="line">ALTER TABLE dept2</span><br><span class="line">ADD PRIMARY KEY(id);</span><br><span class="line"></span><br><span class="line">#3.向表emp2中冻加列dept_id,并在其中定义FOREIGN KEY约束,与之相关联的列是dept2表中的id列。</span><br><span class="line">ALTER TABLE emp2</span><br><span class="line">ADD dept_id INT;</span><br><span class="line"></span><br><span class="line">DESC emp2;</span><br><span class="line"></span><br><span class="line">ALTER TABLE emp2</span><br><span class="line">ADD CONSTRAINT fk_emp2_deptid FOREIGN KEY(dept_id) REFERENCES dept2(id);</span><br></pre></td></tr></table></figure>



<h3 id="练习2-2"><a href="#练习2-2" class="headerlink" title="练习2"></a>练习2</h3><p>承接《第11章_数据处理之增删改》的综合案例。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"># 1、创建数据库test01_library</span><br><span class="line">CREATE DATABASE IF NOT EXISTS test01_library CHARACTER SET &#x27;utf8&#x27;;</span><br><span class="line"></span><br><span class="line">USE test01_library;</span><br><span class="line"></span><br><span class="line"># 2、创建表books，表结构如下：</span><br><span class="line">CREATE TABLE IF NOT EXISTS books(</span><br><span class="line">id INT,</span><br><span class="line">`name` VARCHAR(50),</span><br><span class="line">`authors` VARCHAR(100),</span><br><span class="line">price FLOAT,</span><br><span class="line">pubdate YEAR,</span><br><span class="line">note VARCHAR(100),</span><br><span class="line">num INT</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">DESC books;</span><br><span class="line">SELECT * FROM books;</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th>字段名</th>
<th>字段说明</th>
<th>数据类型</th>
</tr>
</thead>
<tbody><tr>
<td>id</td>
<td>书编号</td>
<td>INT</td>
</tr>
<tr>
<td>name</td>
<td>书名</td>
<td>VARCHAR(50)</td>
</tr>
<tr>
<td>authors</td>
<td>作者</td>
<td>VARCHAR(100)</td>
</tr>
<tr>
<td>price</td>
<td>价格</td>
<td>FLOAT</td>
</tr>
<tr>
<td>pubdate</td>
<td>出版日期</td>
<td>YEAR</td>
</tr>
<tr>
<td>note</td>
<td>说明</td>
<td>VARCHAR(100)</td>
</tr>
<tr>
<td>num</td>
<td>库存</td>
<td>INT</td>
</tr>
</tbody></table>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"># 3、使用ALTER语句给books按如下要求增加相应的约束</span><br><span class="line"></span><br><span class="line">#方式1：</span><br><span class="line">ALTER TABLE books</span><br><span class="line">ADD PRIMARY KEY (id)</span><br><span class="line"></span><br><span class="line">ALTER TABLE books</span><br><span class="line">MODIFY id INT AUTO_INCREMENT:</span><br><span class="line"></span><br><span class="line">#方式2：</span><br><span class="line">ALTER TABLE books</span><br><span class="line">MODIFY id INT PRIMARY KEY AUTO_INCREMENT;</span><br><span class="line"></span><br><span class="line">#针对于非id字段的操作</span><br><span class="line">ALTER TABLE books</span><br><span class="line">MODIFY `name` VARCHAR(50) NOT NULL;</span><br><span class="line"></span><br><span class="line">ALTER TABLE books</span><br><span class="line">MODIFY `authors` VARCHAR(100) NOT NULL;</span><br><span class="line"></span><br><span class="line">ALTER TABLE books</span><br><span class="line">MODIFY price FLOAT NOT NULL;</span><br><span class="line"></span><br><span class="line">ALTER TABLE books</span><br><span class="line">MODIFY pubdate YEAR NOT NULL;</span><br><span class="line"></span><br><span class="line">ALTER TABLE books</span><br><span class="line">MODIFY num INT NOT NULL;</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th>字段名</th>
<th>字段说明</th>
<th>数据类型</th>
<th>主键</th>
<th>外键</th>
<th>非空</th>
<th>唯一</th>
<th>自增</th>
</tr>
</thead>
<tbody><tr>
<td>id</td>
<td>书编号</td>
<td>INT(11)</td>
<td>是</td>
<td>否</td>
<td>是</td>
<td>是</td>
<td>是</td>
</tr>
<tr>
<td>name</td>
<td>书名</td>
<td>VARCHAR(50)</td>
<td>否</td>
<td>否</td>
<td>是</td>
<td>否</td>
<td>否</td>
</tr>
<tr>
<td>authors</td>
<td>作者</td>
<td>VARCHAR(100)</td>
<td>否</td>
<td>否</td>
<td>是</td>
<td>否</td>
<td>否</td>
</tr>
<tr>
<td>price</td>
<td>价格</td>
<td>FLOAT</td>
<td>否</td>
<td>否</td>
<td>是</td>
<td>否</td>
<td>否</td>
</tr>
<tr>
<td>pubdate</td>
<td>出版日期</td>
<td>YEAR</td>
<td>否</td>
<td>否</td>
<td>是</td>
<td>否</td>
<td>否</td>
</tr>
<tr>
<td>note</td>
<td>说明</td>
<td>VARCHAR(100)</td>
<td>否</td>
<td>否</td>
<td>否</td>
<td>否</td>
<td>否</td>
</tr>
<tr>
<td>num</td>
<td>库存</td>
<td>INT(11)</td>
<td>否</td>
<td>否</td>
<td>是</td>
<td>否</td>
<td>否</td>
</tr>
</tbody></table>
<h3 id="练习3-2"><a href="#练习3-2" class="headerlink" title="练习3"></a>练习3</h3><p>题目：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">#1.创建数据库tcst04_company</span><br><span class="line">CREATE DATABASE IF NOT EXISTS test04_company CHARACTER SET &#x27;utf8&#x27;;</span><br><span class="line"></span><br><span class="line">USE test04_company;</span><br><span class="line"></span><br><span class="line">#2.按照下表给出的表结构在test04_company数据库中创建两个数据表offices和employees</span><br><span class="line">ICREATE TABLE IF NOT EXISTS offices(</span><br><span class="line">officeCode INT(10) PRIMARY KEY,</span><br><span class="line">city VARCHAR(50) NOT NULL,</span><br><span class="line">address VARCHAR(50),</span><br><span class="line">country VARCHAR(50) NOT NULL,</span><br><span class="line">postalCode VARCHAR(15)</span><br><span class="line">CONSTRAINT uk_off_poscode UNIQUE(postalCode)</span><br><span class="line">)；</span><br><span class="line"></span><br><span class="line">DESC offices;</span><br><span class="line"></span><br><span class="line">CREATE TABLE employees(</span><br><span class="line">employeeNumber INT PRIMARY KEY AUTO_INCREMENT,</span><br><span class="line">lastName VARCHAR(50) NOT NULL,</span><br><span class="line">firstName VARCHAR(50) NOT NULL,</span><br><span class="line">mobile VARCHAR (25) UNIQUE,</span><br><span class="line">officeCode INT(10) NOT NULL,</span><br><span class="line">jobTitle VARCHAR(50) NOT NULL,</span><br><span class="line">birth DATETIME NOT NULL,</span><br><span class="line">note VARCHAR (255),</span><br><span class="line">sex VARCHAR(5),</span><br><span class="line">CONSTRAINT fk_emp_offcode FOREIGN KEY (officeCode) REFERENCES offices(officeCode)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">DESC employees;</span><br></pre></td></tr></table></figure>

<ul>
<li>offices表：</li>
</ul>
<table>
<thead>
<tr>
<th>字段名</th>
<th>数据类型</th>
<th>主键</th>
<th>外键</th>
<th>非空</th>
<th>唯一</th>
<th>自增</th>
</tr>
</thead>
<tbody><tr>
<td>officeCode</td>
<td>INT(10)</td>
<td>是</td>
<td>否</td>
<td>是</td>
<td>是</td>
<td>否</td>
</tr>
<tr>
<td>city</td>
<td>VARCHAR(50)</td>
<td>否</td>
<td>否</td>
<td>是</td>
<td>否</td>
<td>否</td>
</tr>
<tr>
<td>address</td>
<td>VARCHAR(50)</td>
<td>否</td>
<td>否</td>
<td>否</td>
<td>否</td>
<td>否</td>
</tr>
<tr>
<td>country</td>
<td>VARCHAR(50)</td>
<td>否</td>
<td>否</td>
<td>是</td>
<td>否</td>
<td>否</td>
</tr>
<tr>
<td>postalCode</td>
<td>VARCHAR(15)</td>
<td>否</td>
<td>否</td>
<td>否</td>
<td>是</td>
<td>否</td>
</tr>
</tbody></table>
<ul>
<li>employees表：</li>
</ul>
<table>
<thead>
<tr>
<th>字段名</th>
<th>数据类型</th>
<th>主键</th>
<th>外键</th>
<th>非空</th>
<th>唯一</th>
<th>自增</th>
</tr>
</thead>
<tbody><tr>
<td>employeeNumber</td>
<td>INT(11)</td>
<td>是</td>
<td>否</td>
<td>是</td>
<td>是</td>
<td>是</td>
</tr>
<tr>
<td>lastName</td>
<td>VARCHAR(50)</td>
<td>否</td>
<td>否</td>
<td>是</td>
<td>否</td>
<td>否</td>
</tr>
<tr>
<td>firstName</td>
<td>VARCHAR(50)</td>
<td>否</td>
<td>否</td>
<td>是</td>
<td>否</td>
<td>否</td>
</tr>
<tr>
<td>mobile</td>
<td>VARCHAR(25)</td>
<td>否</td>
<td>否</td>
<td>否</td>
<td>是</td>
<td>否</td>
</tr>
<tr>
<td>officeCode</td>
<td>INT(10)</td>
<td>否</td>
<td>是</td>
<td>是</td>
<td>否</td>
<td>否</td>
</tr>
<tr>
<td>jobTitle</td>
<td>VARCHAR(50)</td>
<td>否</td>
<td>否</td>
<td>是</td>
<td>否</td>
<td>否</td>
</tr>
<tr>
<td>birth</td>
<td>DATETIME</td>
<td>否</td>
<td>否</td>
<td>是</td>
<td>否</td>
<td>否</td>
</tr>
<tr>
<td>note</td>
<td>VARCHAR(255)</td>
<td>否</td>
<td>否</td>
<td>否</td>
<td>否</td>
<td>否</td>
</tr>
<tr>
<td>sex</td>
<td>VARCHAR(5)</td>
<td>否</td>
<td>否</td>
<td>否</td>
<td>否</td>
<td>否</td>
</tr>
</tbody></table>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">#3.将表employees的mobile字段修改到officeCode字段后面</span><br><span class="line">ALTER TABLE employees</span><br><span class="line">MODIFY mobile VARCHAR(25) AFTER officeCode;</span><br><span class="line"></span><br><span class="line">#4.将表employees的birth字段改名为employee_birth</span><br><span class="line">ALTER TABLE employees</span><br><span class="line">CHANGE birth employee_birth DATETIME;</span><br><span class="line"></span><br><span class="line">#5.修改sex字段，数据类型为CHAR(1)，非空约束</span><br><span class="line">ALTER TABLE employees</span><br><span class="line">MODIFY sex CHAR(1) NOT NULL;</span><br><span class="line"></span><br><span class="line">#6.删除字段note</span><br><span class="line">ALTER TABLE employees</span><br><span class="line">DROP COLUMN note;</span><br><span class="line"></span><br><span class="line">#7.增加字段名favoriate_activity,数据类型为VARCHAR(100)</span><br><span class="line">ALTER TABLE employees</span><br><span class="line">ADD favoriate_activity VARCHAR(100);</span><br><span class="line"></span><br><span class="line">#8.将表employees名称修改为employees_info</span><br><span class="line">RENAME TABLE employees</span><br><span class="line">TO employees_info;</span><br><span class="line"></span><br><span class="line">DESC employees_info;</span><br></pre></td></tr></table></figure>



<p>【第2子篇：SQL之SELECT使用篇】<br>p12-p48<br>学习建议：学习SQL的重点，必须重点掌握，建议课后练习多写</p>
<p>【第3子篇：SQL之DDL、DML、DCL使用篇】<br>p49-p73<br>学习建议：学习SQL的重点，难度较SELECT低，练习写写就能掌握</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="https://mo-li001.github.io">壹拾陆</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://mo-li001.github.io/posts/b9535d1f.html">https://mo-li001.github.io/posts/b9535d1f.html</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://mo-li001.github.io" target="_blank">壹拾陆</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Linux/">Linux</a></div><div class="post_share"><div class="social-share" data-image="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/posts/f5c94817.html"><img class="prev-cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">java-tomcat</div></div></a></div><div class="next-post pull-right"><a href="/posts/5ebc1573.html"><img class="next-cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">dba-redis</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/posts/9f353bc9.html" title="Devops"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-08-31</div><div class="title">Devops</div></div></a></div><div><a href="/posts/f5f9fa9b.html" title="Docker"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-08-31</div><div class="title">Docker</div></div></a></div><div><a href="/posts/34d20e28.html" title="ELK"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-08-31</div><div class="title">ELK</div></div></a></div><div><a href="/posts/8005.html" title="ELK快速部署"><img class="cover" src="https://tuchuangs.com/imgs/2022/09/18/074f3836d4f471b8.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-08-31</div><div class="title">ELK快速部署</div></div></a></div><div><a href="/posts/9bdc030a.html" title="HAproxy"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-08-31</div><div class="title">HAproxy</div></div></a></div><div><a href="/posts/a71433d.html" title="Ansible"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-08-31</div><div class="title">Ansible</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://images-1258700836.cos.ap-guangzhou.myqcloud.com/images/202209182232723.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">壹拾陆</div><div class="author-info__description"></div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">68</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">4</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">5</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/mo-li001/"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">个人笔记</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Mysql%E5%85%A5%E9%97%A8%E5%88%B0%E9%AB%98%E7%BA%A7"><span class="toc-text">Mysql入门到高级</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC03%E7%AB%A0%E5%9F%BA%E6%9C%AC%E7%9A%84SELECT%E8%AF%AD%E5%8F%A5"><span class="toc-text">第03章基本的SELECT语句</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-SQL%E7%9A%84%E5%88%86%E7%B1%BB"><span class="toc-text">1. SQL的分类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-SQL%E7%9A%84%E8%A7%84%E5%88%99-%E2%80%94-%E5%BF%85%E9%A1%BB%E8%A6%81%E9%81%B5%E5%AE%88"><span class="toc-text">2.1 SQL的规则 —-必须要遵守</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-SQL%E7%9A%84%E8%A7%84%E8%8C%83-%E2%80%94-%E5%BB%BA%E8%AE%AE%E9%81%B5%E5%AE%88"><span class="toc-text">2.2 SQL的规范 —-建议遵守</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-MySQL%E7%9A%84%E4%B8%89%E7%A7%8D%E6%B3%A8%E9%87%8A%E7%9A%84%E6%96%B9%E5%BC%8F"><span class="toc-text">3. MySQL的三种注释的方式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E5%AF%BC%E5%85%A5%E7%8E%B0%E6%9C%89%E7%9A%84%E6%95%B0%E6%8D%AE%E8%A1%A8%E3%80%81%E8%A1%A8%E7%9A%84%E6%95%B0%E6%8D%AE"><span class="toc-text">4. 导入现有的数据表、表的数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC03%E7%AB%A0-%E5%9F%BA%E6%9C%AC%E7%9A%84SELECT%E8%AF%AD%E5%8F%A5%E7%9A%84%E8%AF%BE%E5%90%8E%E7%BB%83%E4%B9%A0"><span class="toc-text">第03章 基本的SELECT语句的课后练习</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC04%E7%AB%A0-%E8%BF%90%E7%AE%97%E7%AC%A6"><span class="toc-text">第04章 运算符</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC05%E7%AB%A0-%E6%8E%92%E5%BA%8F%E4%B8%8E%E5%88%86%E9%A1%B5"><span class="toc-text">第05章 排序与分页</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%88%86%E9%A1%B5"><span class="toc-text">2.分页</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC05%E7%AB%A0-%E6%8E%92%E5%BA%8F%E4%B8%8E%E5%88%86%E9%A1%B5%E7%9A%84%E8%AF%BE%E5%90%8E%E7%BB%83%E4%B9%A0"><span class="toc-text">第05章 排序与分页的课后练习</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC06%E7%AB%A0-%E5%A4%9A%E8%A1%A8%E6%9F%A5%E8%AF%A2"><span class="toc-text">第06章 多表查询</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#06%E7%AB%A0-%E5%A4%9A%E8%A1%A8%E6%9F%A5%E8%AF%A2%E7%9A%84%E8%AF%BE%E5%90%8E%E7%BB%83%E4%B9%A0"><span class="toc-text">06章 多表查询的课后练习</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC7%E7%AB%A0-%E5%8D%95%E8%A1%8C%E5%87%BD%E6%95%B0"><span class="toc-text">第7章 单行函数</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E6%95%B0%E5%80%BC%E5%87%BD%E6%95%B0"><span class="toc-text">二、数值函数</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1%E3%80%81%E5%9F%BA%E6%9C%AC%E5%87%BD%E6%95%B0"><span class="toc-text">1、基本函数</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E7%9A%84%E6%93%8D%E4%BD%9C"><span class="toc-text">基本的操作</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%8F%96%E9%9A%8F%E6%9C%BA%E6%95%B0"><span class="toc-text">取随机数</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%9B%9B%E8%88%8D%E4%BA%94%E5%85%A5"><span class="toc-text">四舍五入</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%88%AA%E6%96%AD%E6%93%8D%E4%BD%9C"><span class="toc-text">截断操作</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%8D%95%E8%A1%8C%E5%87%BD%E6%95%B0%E5%8F%AF%E4%BB%A5%E5%B5%8C%E5%A5%97"><span class="toc-text">单行函数可以嵌套</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2%E3%80%81%E8%A7%92%E5%BA%A6%E4%B8%8E%E5%BC%A7%E5%BA%A6%E4%BA%92%E6%8D%A2%E5%87%BD%E6%95%B0"><span class="toc-text">2、角度与弧度互换函数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3%E3%80%81%E4%B8%89%E8%A7%92%E5%87%BD%E6%95%B0"><span class="toc-text">3、三角函数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4%E3%80%81%E6%8C%87%E6%95%B0%E4%B8%8E%E5%AF%B9%E6%95%B0"><span class="toc-text">4、指数与对数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5%E3%80%81%E8%BF%9B%E5%88%B6%E9%97%B4%E7%9A%84%E8%BD%AC%E6%8D%A2"><span class="toc-text">5、进制间的转换</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%89%E3%80%81%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%87%BD%E6%95%B0"><span class="toc-text">三、字符串函数</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%9B%9B%E3%80%81%E6%97%A5%E6%9C%9F%E5%92%8C%E6%97%B6%E9%97%B4%E5%87%BD%E6%95%B0"><span class="toc-text">四、日期和时间函数</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1%E3%80%81%E8%8E%B7%E5%8F%96%E6%97%A5%E6%9C%9F%E3%80%81%E6%97%B6%E9%97%B4"><span class="toc-text">1、获取日期、时间</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2%E3%80%81%E6%97%A5%E6%9C%9F%E4%B8%8E%E6%97%B6%E9%97%B4%E6%88%B3%E7%9A%84%E8%BD%AC%E6%8D%A2"><span class="toc-text">2、日期与时间戳的转换</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3%E3%80%81%E8%8E%B7%E5%8F%96%E6%9C%88%E4%BB%BD%E3%80%81%E6%98%9F%E6%9C%9F%E3%80%81%E6%98%9F%E6%9C%9F%E6%95%B0%E3%80%81%E5%A4%A9%E6%95%B0%E7%AD%89%E5%87%BD%E6%95%B0"><span class="toc-text">3、获取月份、星期、星期数、天数等函数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4%E3%80%81%E6%97%A5%E6%9C%9F%E7%9A%84%E6%93%8D%E4%BD%9C%E5%87%BD%E6%95%B0"><span class="toc-text">4、日期的操作函数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5%E3%80%81%E6%97%B6%E9%97%B4%E5%92%8C%E7%A7%92%E9%92%9F%E8%BD%AC%E6%8D%A2%E7%9A%84%E5%87%BD%E6%95%B0"><span class="toc-text">5、时间和秒钟转换的函数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6%E3%80%81%E8%AE%A1%E7%AE%97%E6%97%A5%E6%9C%9F%E5%92%8C%E6%97%B6%E9%97%B4%E7%9A%84%E5%87%BD%E6%95%B0"><span class="toc-text">6、计算日期和时间的函数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7%E3%80%81-%E6%97%A5%E6%9C%9F%E7%9A%84%E6%A0%BC%E5%BC%8F%E5%8C%96%E4%B8%8E%E8%A7%A3%E6%9E%90"><span class="toc-text">7、 日期的格式化与解析</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BA%94%E3%80%81%E6%B5%81%E7%A8%8B%E6%8E%A7%E5%88%B6%E5%87%BD%E6%95%B0"><span class="toc-text">五、流程控制函数</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%85%AD%E3%80%81%E5%8A%A0%E5%AF%86%E4%B8%8E%E8%A7%A3%E5%AF%86%E5%87%BD%E6%95%B0"><span class="toc-text">六、加密与解密函数</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A0%87%E8%AF%86%E5%91%BD%E5%90%8D%E8%A7%84%E5%88%99"><span class="toc-text">标识命名规则</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E5%88%9B%E5%BB%BA%E5%92%8C%E7%AE%A1%E7%90%86%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-text">2.创建和管理数据库</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-%E5%88%9B%E5%BB%BA%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-text">2.1 创建数据库</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-%E4%BD%BF%E7%94%A8%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-text">2.2 使用数据库</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3-%E4%BF%AE%E6%94%B9%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-text">2.3 修改数据库</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-4-%E5%88%A0%E9%99%A4%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-text">2.4 删除数据库</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E5%88%9B%E5%BB%BA%E8%A1%A8"><span class="toc-text">3.创建表</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1%E5%88%9B%E5%BB%BA%E6%96%B9%E5%BC%8F1"><span class="toc-text">3.1创建方式1</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-%E9%87%8D%E5%91%BD%E5%90%8D%E8%A1%A8"><span class="toc-text">5.重命名表</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-%E5%88%A0%E9%99%A4%E8%A1%A8"><span class="toc-text">6.删除表</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-%E6%B8%85%E7%A9%BA%E8%A1%A8"><span class="toc-text">7.清空表</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-%E5%86%85%E5%AE%B9%E6%8B%93%E5%B1%95"><span class="toc-text">8.内容拓展</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8B%93%E5%B1%951%EF%BC%9A%E9%98%BF%E9%87%8C%E5%B7%B4%E5%B7%B4%E3%80%8AJava%E5%BC%80%E5%8F%91%E6%89%8B%E5%86%8C%E3%80%8B%E4%B9%8BMySQL%E5%AD%97%E6%AE%B5%E5%91%BD%E5%90%8D"><span class="toc-text">拓展1：阿里巴巴《Java开发手册》之MySQL字段命名</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8B%93%E5%B1%952%EF%BC%9A%E5%A6%82%E4%BD%95%E7%90%86%E8%A7%A3%E6%B8%85%E7%A9%BA%E8%A1%A8%E3%80%81%E5%88%A0%E9%99%A4%E8%A1%A8%E7%AD%89%E6%93%8D%E4%BD%9C%E9%9C%80%E8%B0%A8%E6%85%8E%EF%BC%9F%EF%BC%81"><span class="toc-text">拓展2：如何理解清空表、删除表等操作需谨慎？！</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8B%93%E5%B1%953%EF%BC%9AMySQL8%E6%96%B0%E7%89%B9%E6%80%A7%E2%80%94DDL%E7%9A%84%E5%8E%9F%E5%AD%90%E5%8C%96"><span class="toc-text">拓展3：MySQL8新特性—DDL的原子化</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC10%E7%AB%A0-%E5%88%9B%E5%BB%BA%E5%92%8C%E7%AE%A1%E7%90%86%E8%A1%A8"><span class="toc-text">第10章 创建和管理表</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%83%E4%B9%A01"><span class="toc-text">练习1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%83%E4%B9%A02"><span class="toc-text">练习2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%83%E4%B9%A03"><span class="toc-text">练习3</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%AC%AC11%E7%AB%A0-%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86%E4%B9%8B%E5%A2%9E%E5%88%A0%E6%94%B9"><span class="toc-text">第11章 数据处理之增删改</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E6%8F%92%E5%85%A5%E6%95%B0%E6%8D%AE"><span class="toc-text">1.插入数据</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1%E5%AE%9E%E9%99%85%E9%97%AE%E9%A2%98"><span class="toc-text">1.1实际问题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2%E6%96%B9%E5%BC%8F1%EF%BC%9AVALUES%E7%9A%84%E6%96%B9%E5%BC%8F%E6%B7%BB%E5%8A%A0"><span class="toc-text">1.2方式1：VALUES的方式添加</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8F%92%E5%85%A5%E6%95%B0%E6%8D%AE"><span class="toc-text">插入数据</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%96%B9%E5%BC%8F1%EF%BC%9AVALUES%E7%9A%84%E6%96%B9%E5%BC%8F%E6%B7%BB%E5%8A%A0"><span class="toc-text">方式1：VALUES的方式添加</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#1-2-%E6%96%B9%E5%BC%8F2%EF%BC%9A%E5%B0%86%E6%9F%A5%E8%AF%A2%E7%BB%93%E6%9E%9C%E6%8F%92%E5%85%A5%E5%88%B0%E8%A1%A8%E4%B8%AD"><span class="toc-text">1.2 方式2：将查询结果插入到表中</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E6%9B%B4%E6%96%B0%E6%95%B0%E6%8D%AE"><span class="toc-text">2. 更新数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E5%88%A0%E9%99%A4%E6%95%B0%E6%8D%AE"><span class="toc-text">3. 删除数据</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-MySQL8%E6%96%B0%E7%89%B9%E6%80%A7%EF%BC%9A%E8%AE%A1%E7%AE%97%E5%88%97"><span class="toc-text">4. MySQL8新特性：计算列</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%BC%E5%90%88%E6%A1%88%E4%BE%8B"><span class="toc-text">综合案例</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%AC%AC11%E7%AB%A0-%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86%E4%B9%8B%E5%A2%9E%E5%88%A0%E6%94%B9-1"><span class="toc-text">第11章 数据处理之增删改</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%83%E4%B9%A01-1"><span class="toc-text">练习1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%83%E4%B9%A02-1"><span class="toc-text">练习2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%83%E4%B9%A03-1"><span class="toc-text">练习3</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%AC%AC12%E7%AB%A0-MySQL%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E7%B2%BE%E8%AE%B2"><span class="toc-text">第12章 MySQL数据类型精讲</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-MySQL%E4%B8%AD%E7%9A%84%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B"><span class="toc-text">1.MySQL中的数据类型</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E6%95%B4%E6%95%B0%E7%B1%BB%E5%9E%8B"><span class="toc-text">2.整数类型</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-%E7%B1%BB%E5%9E%8B%E4%BB%8B%E7%BB%8D"><span class="toc-text">2.1 类型介绍</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-%E5%8F%AF%E9%80%89%E5%B1%9E%E6%80%A7"><span class="toc-text">2.2 可选属性</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-2-1-M"><span class="toc-text">2.2.1 M</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-2-UNSIGNED"><span class="toc-text">2.2.2 UNSIGNED</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-3-ZEROFILL"><span class="toc-text">2.2.3 ZEROFILL</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3-%E9%80%82%E7%94%A8%E5%9C%BA%E6%99%AF"><span class="toc-text">2.3 适用场景</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-4-%E5%A6%82%E4%BD%95%E9%80%89%E6%8B%A9%EF%BC%9F"><span class="toc-text">2.4 如何选择？</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E6%B5%AE%E7%82%B9%E7%B1%BB%E5%9E%8B"><span class="toc-text">3.浮点类型</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-%E7%B1%BB%E5%9E%8B%E4%BB%8B%E7%BB%8D"><span class="toc-text">3.1 类型介绍</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2%E6%95%B0%E6%8D%AE%E7%B2%BE%E5%BA%A6%E8%AF%B4%E6%98%8E"><span class="toc-text">3.2数据精度说明</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-%E5%AE%9A%E7%82%B9%E6%95%B0%E7%B1%BB%E5%9E%8B"><span class="toc-text">4.定点数类型</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1%E7%B1%BB%E5%9E%8B%E4%BB%8B%E7%BB%8D"><span class="toc-text">4.1类型介绍</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-2-%E5%BC%80%E5%8F%91%E4%B8%AD%E7%BB%8F%E9%AA%8C"><span class="toc-text">4.2 开发中经验</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-%E4%BD%8D%E7%B1%BB%E5%9E%8B%EF%BC%9ABIT"><span class="toc-text">5.位类型：BIT</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-%E6%97%A5%E6%9C%9F%E4%B8%8E%E6%97%B6%E9%97%B4%E7%B1%BB%E5%9E%8B"><span class="toc-text">6.日期与时间类型</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-1-YEAR%E7%B1%BB%E5%9E%8B"><span class="toc-text">6.1 YEAR类型</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#6-2-DATE%E7%B1%BB%E5%9E%8B"><span class="toc-text">6.2 DATE类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-3-TIME%E7%B1%BB%E5%9E%8B"><span class="toc-text">6.3 TIME类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-4-DATETIME%E7%B1%BB%E5%9E%8B"><span class="toc-text">6.4 DATETIME类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-5-TIMESTAMP%E7%B1%BB%E5%9E%8B"><span class="toc-text">6.5 TIMESTAMP类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-6-%E5%BC%80%E5%8F%91%E4%B8%AD%E7%BB%8F%E9%AA%8C"><span class="toc-text">6.6 开发中经验</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-%E6%96%87%E6%9C%AC%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%B1%BB%E5%9E%8B"><span class="toc-text">7.文本字符串类型</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#7-1-CHAR%E4%B8%8EVARCHAR%E7%B1%BB%E5%9E%8B"><span class="toc-text">7.1 CHAR与VARCHAR类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-2-TEXT%E7%B1%BB%E5%9E%8B"><span class="toc-text">7.2 TEXT类型</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-ENUM%E7%B1%BB%E5%9E%8B"><span class="toc-text">8.ENUM类型</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-SET%E7%B1%BB%E5%9E%8B"><span class="toc-text">9.SET类型</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#10-%E4%BA%8C%E8%BF%9B%E5%88%B6%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%B1%BB%E5%9E%8B"><span class="toc-text">10.二进制字符串类型</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#BLOB%E7%B1%BB%E5%9E%8B"><span class="toc-text">BLOB类型</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#11-JSON%E7%B1%BB%E5%9E%8B"><span class="toc-text">11. JSON类型</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#12-%E7%A9%BA%E9%97%B4%E7%B1%BB%E5%9E%8B"><span class="toc-text">12.空间类型</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#13-%E5%B0%8F%E7%BB%93%E5%8F%8A%E9%80%89%E6%8B%A9%E5%BB%BA%E8%AE%AE"><span class="toc-text">13.小结及选择建议</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%AC%AC13%E7%AB%A0-%E7%BA%A6%E6%9D%9F"><span class="toc-text">第13章 约束</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E7%BA%A6%E6%9D%9F-constraint-%E6%A6%82%E8%BF%B0"><span class="toc-text">1.约束(constraint)概述</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-%E4%B8%BA%E4%BB%80%E4%B9%88%E9%9C%80%E8%A6%81%E7%BA%A6%E6%9D%9F"><span class="toc-text">1.1 为什么需要约束</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-%E4%BB%80%E4%B9%88%E6%98%AF%E7%BA%A6%E6%9D%9F"><span class="toc-text">1.2 什么是约束</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-3-%E7%BA%A6%E6%9D%9F%E7%9A%84%E5%88%86%E7%B1%BB"><span class="toc-text">1.3 约束的分类</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E9%9D%9E%E7%A9%BA%E7%BA%A6%E6%9D%9F"><span class="toc-text">2.非空约束</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-%E4%BD%9C%E7%94%A8"><span class="toc-text">2.1 作用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-%E5%85%B3%E9%94%AE%E5%AD%97"><span class="toc-text">2.2 关键字</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3-%E7%89%B9%E7%82%B9"><span class="toc-text">2.3 特点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-4%E6%B7%BB%E5%8A%A0%E9%9D%9E%E7%A9%BA%E7%BA%A6%E6%9D%9F"><span class="toc-text">2.4添加非空约束</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E5%94%AF%E4%B8%80%E6%80%A7%E7%BA%A6%E6%9D%9F"><span class="toc-text">3.唯一性约束</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-%E4%BD%9C%E7%94%A8"><span class="toc-text">3.1 作用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-%E5%85%B3%E9%94%AE%E5%AD%97"><span class="toc-text">3.2 关键字</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-3-%E7%89%B9%E7%82%B9"><span class="toc-text">3.3 特点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-4-%E6%B7%BB%E5%8A%A0%E5%94%AF%E4%B8%80%E7%BA%A6%E6%9D%9F"><span class="toc-text">3.4 添加唯一约束</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-5-%E5%88%A0%E9%99%A4%E5%94%AF%E4%B8%80%E7%BA%A6%E6%9D%9F"><span class="toc-text">3.5 删除唯一约束</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-PRIMARY-KEY%E7%BA%A6%E6%9D%9F"><span class="toc-text">4.PRIMARY KEY约束</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-%E4%BD%9C%E7%94%A8"><span class="toc-text">4.1 作用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-2-%E5%85%B3%E9%94%AE%E5%AD%97"><span class="toc-text">4.2 关键字</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-3-%E7%89%B9%E7%82%B9"><span class="toc-text">4.3 特点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-6-%E5%88%A0%E9%99%A4%E4%B8%BB%E9%94%AE%E7%BA%A6%E6%9D%9F"><span class="toc-text">4.6 删除主键约束</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-%E8%87%AA%E5%A2%9E%E5%88%97%EF%BC%9AAUTO-INCREMENT"><span class="toc-text">5.自增列：AUTO_INCREMENT</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#5-1-%E4%BD%9C%E7%94%A8"><span class="toc-text">5.1 作用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-2-%E5%85%B3%E9%94%AE%E5%AD%97"><span class="toc-text">5.2 关键字</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-3-%E7%89%B9%E7%82%B9%E5%92%8C%E8%A6%81%E6%B1%82"><span class="toc-text">5.3 特点和要求</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-6MySQL8-0%E6%96%B0%E7%89%B9%E6%80%A7-%E8%87%AA%E5%A2%9E%E5%8F%98%E9%87%8F%E7%9A%84%E6%8C%81%E4%B9%85%E5%8C%96"><span class="toc-text">5.6MySQL8.0新特性-自增变量的持久化</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-FOREIGN-KEY%E7%BA%A6%E6%9D%9F"><span class="toc-text">6.FOREIGN KEY约束</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#6-1-%E4%BD%9C%E7%94%A8"><span class="toc-text">6.1 作用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-2-%E5%85%B3%E9%94%AE%E5%AD%97"><span class="toc-text">6.2 关键字</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-3-%E4%B8%BB%E8%A1%A8%E5%92%8C%E4%BB%8E%E8%A1%A8-x2F-%E7%88%B6%E8%A1%A8%E5%92%8C%E5%AD%90%E8%A1%A8"><span class="toc-text">6.3 主表和从表&#x2F;父表和子表</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-4%E7%89%B9%E7%82%B9"><span class="toc-text">6.4特点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-7-%E7%BA%A6%E6%9D%9F%E7%AD%89%E7%BA%A7"><span class="toc-text">6.7 约束等级</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-8%E5%88%A0%E9%99%A4%E5%A4%96%E9%94%AE%E7%BA%A6%E6%9D%9F"><span class="toc-text">6.8删除外键约束</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-9-%E5%BC%80%E5%8F%91%E5%9C%BA%E6%99%AF"><span class="toc-text">6.9 开发场景</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-10-%E9%98%BF%E9%87%8C%E5%BC%80%E5%8F%91%E8%A7%84%E8%8C%83"><span class="toc-text">6.10 阿里开发规范</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-CHECK%E7%BA%A6%E6%9D%9F"><span class="toc-text">7.CHECK约束</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#7-1-%E4%BD%9C%E7%94%A8"><span class="toc-text">7.1 作用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-2-%E5%85%B3%E9%94%AE%E5%AD%97"><span class="toc-text">7.2 关键字</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-3-%E8%AF%B4%E6%98%8E%EF%BC%9AMySQL5-7%E4%B8%8D%E6%94%AF%E7%89%B9"><span class="toc-text">7.3 说明：MySQL5.7不支特</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-DEFAULT%E7%BA%A6%E6%9D%9F"><span class="toc-text">8.DEFAULT约束</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#8-1-%E4%BD%9C%E7%94%A8"><span class="toc-text">8.1 作用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-2-%E5%85%B3%E9%94%AE%E5%AD%97"><span class="toc-text">8.2 关键字</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-3-%E5%A6%82%E4%BD%95%E7%BB%99%E5%AD%97%E6%AE%B5%E5%8A%A0%E9%BB%98%E8%AE%A4%E5%80%BC"><span class="toc-text">8.3 如何给字段加默认值</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-%E9%9D%A2%E8%AF%95"><span class="toc-text">9.面试</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC13%E7%AB%A0-%E7%BA%A6%E6%9D%9F-1"><span class="toc-text">第13章 约束</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9F%BA%E7%A1%80%E7%BB%83%E4%B9%A0"><span class="toc-text">基础练习</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%83%E4%B9%A01-2"><span class="toc-text">练习1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%83%E4%B9%A02-2"><span class="toc-text">练习2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%83%E4%B9%A03-2"><span class="toc-text">练习3</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/posts/90f47a19.html" title="自动化装机">自动化装机</a><time datetime="2023-02-02T12:41:14.000Z" title="发表于 2023-02-02 20:41:14">2023-02-02</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/posts/64202.html" title="linux">linux</a><time datetime="2023-02-02T12:41:14.000Z" title="发表于 2023-02-02 20:41:14">2023-02-02</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/posts/8fb4d8df.html" title="zabbix">zabbix</a><time datetime="2023-02-02T01:43:57.000Z" title="发表于 2023-02-02 09:43:57">2023-02-02</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/posts/8d6735b8.html" title="超经典SQL练习题，做完这些你的ＳＱＬ就过关了">超经典SQL练习题，做完这些你的ＳＱＬ就过关了</a><time datetime="2023-02-02T01:43:57.000Z" title="发表于 2023-02-02 09:43:57">2023-02-02</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/posts/39d18a59.html" title="Mermaid绘图">Mermaid绘图</a><time datetime="2023-01-11T12:41:14.000Z" title="发表于 2023-01-11 20:41:14">2023-01-11</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2023 By 壹拾陆</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>